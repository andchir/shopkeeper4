function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"4p3S":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("XNiG"),o=n("1G5W"),r=n("RwQR"),a=n("Y2tp"),l=n("fXoL"),c=n("7AsP"),s=n("1kSV"),b=n("sYmb"),d=["table"],u=function(){var e=function(){function e(t,n,o,a){_classCallCheck(this,e),this.dataService=t,this.activeModal=n,this.modalService=o,this.translateService=a,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new r.a("name","asc",1,10,0,0),this.destroyed$=new i.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.getList(),this.afterInit()}},{key:"afterInit",value:function(){}},{key:"onSearchClear",value:function(){this.getList()}},{key:"onModalClose",value:function(e){}},{key:"onSearchWordUpdate",value:function(e){var t=this;if(void 0!==e)return this.queryOptions.search_word=e,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){t.queryOptions.page=1,t.getList()}),700)}},{key:"getModalElementId",value:function(e){return["modal",e||0].join("-")}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(i?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=n,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=i}},{key:"modalOpen",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){var o=window.document.getElementById(i),r=o.previousElementSibling;return o.classList.add("d-block"),o.classList.remove("modal-minimized"),void r.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(e,n,i),this.modalRef.result.then((function(e){t.destroyed$.isStopped||(t.onModalClose(e),t.getList())}),(function(e){t.destroyed$.isStopped||(t.onModalClose(e),e&&["submit","updated"].indexOf(e)>-1&&t.getList())}))}},{key:"deleteItemConfirm",value:function(e){var t=this;this.modalRef=this.modalService.open(a.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then((function(n){"accept"===n&&t.deleteItem(e)}))}},{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"confirmAction",value:function(e){return this.modalRef=this.modalService.open(a.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}},{key:"blockSelected",value:function(){var e=this;0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe((function(t){e.clearSelected(),e.getList()}),(function(t){return e.showAlert(t.error||e.getLangString("ERROR"))})):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}},{key:"deleteSelected",value:function(){var e=this;0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then((function(t){"accept"===t&&e.dataService.actionBatch(e.selectedIds,"delete").subscribe((function(t){e.clearSelected(),e.getList()}),(function(t){return e.showAlert(t.error||e.getLangString("ERROR"))}))})):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}},{key:"showAlert",value:function(e){this.modalRef=this.modalService.open(a.a),this.modalRef.componentInstance.modalContent=e,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}},{key:"deleteItem",value:function(e){var t=this;this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then((function(n){"accept"===n&&t.dataService.deleteItem(e).subscribe((function(e){t.getList()}),(function(e){e.error&&t.showAlert(e.error)}))}))}},{key:"clearSelected",value:function(){this.table&&this.table.clearSelected()}},{key:"actionRequest",value:function(e){switch(e[0]){case"edit":this.modalOpen(e[1]);break;case"copy":this.modalOpen(e[1],!0);break;case"delete":this.deleteItem(e[1]);break;case"changeQuery":this.getList()}}},{key:"getList",value:function(){var e=this;this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe(Object(o.a)(this.destroyed$)).subscribe({next:function(t){e.items=t.items,e.collectionSize=t.total,e.loading=!1},error:function(t){e.items=[],e.collectionSize=0,t.error&&e.showAlert(t.error),e.loading=!1}})}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}}]),e}();return e.title="",e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(s.b),l.Qb(s.h),l.Qb(b.d))},e.\u0275dir=l.Lb({type:e,viewQuery:function(e,t){var n;1&e&&l.Jc(d,!0),2&e&&l.Cc(n=l.jc())&&(t.table=n.first)}}),e}()},"8Eda":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function e(t,n,i,o,r){_classCallCheck(this,e),this.changed=t,this.loading=n,this.values=i,this.defaultOptions=o,this.defaultValues=r}},BWxc:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("JIr8"),o=n("7AsP"),r=n("fXoL"),a=n("tk/3"),l=function(){var e=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("/admin/content_types"),i}return _createClass(n,[{key:"getItemByName",value:function(e){var t=this.getRequestUrl()+"/by_name/"+e;return this.http.get(t).pipe(Object(i.a)(this.handleError()))}}]),n}(o.a);return e.\u0275fac=function(t){return new(t||e)(r.ec(a.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"T+Ph":function(e,t,n){"use strict";n.r(t);var i,o=n("ofXK"),r=n("d2mR"),a=n("e07I"),l=n("b1TM"),c=n("qbpQ"),s=n("tyNb"),b=n("LvDl"),d=n("7zfz"),u=n("4p3S"),p=n("RwQR"),f=n("tk/3"),m=n("JIr8"),g=n("7AsP"),h=n("fXoL"),v=((i=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("import"),i}return _createClass(n,[{key:"getSheetProperties",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/properties");return this.http.post(t,e,{headers:this.headers}).pipe(Object(m.a)(this.handleError()))}},{key:"getFieldsOptions",value:function(e,t){var n=this.getRequestUrl()+"/".concat(e,"/fields_options"),i=this.createHttpParams(t);return this.http.get(n,{params:i,headers:this.headers}).pipe(Object(m.a)(this.handleError()))}},{key:"splitFileAction",value:function(e){var t=this.getRequestUrl()+"/".concat(e,"/split_file");return this.http.post(t,{},{headers:this.headers}).pipe(Object(m.a)(this.handleError()))}},{key:"testData",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/do_import_test");return this.http.post(t,e,{headers:this.headers}).pipe(Object(m.a)(this.handleError()))}},{key:"importData",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/do_import");return this.http.post(t,e,{headers:this.headers}).pipe(Object(m.a)(this.handleError()))}},{key:"importDataProgress",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/do_import");return this.http.request(new f.g("POST",t,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}},{key:"getPercent",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/percent");return this.http.get(t,{headers:this.headers}).pipe(Object(m.a)(this.handleError()))}}]),n}(g.a)).\u0275fac=function(e){return new(e||i)(h.ec(f.a))},i.\u0275prov=h.Mb({token:i,factory:i.\u0275fac}),i),y=n("3Pt+"),D=n("lJxs"),V=n("bbPC"),O=function(){function e(t,n,i,o,r,a,l,c,s,b){_classCallCheck(this,e),this.id=t,this.title=n,this.fileData=i,this.type=o,this.fileSize=r,this.rowsQuantity=a,this.sheetsQuantity=l,this.sheetsNames=c,this.options=s,this.fieldsOptions=b,void 0===this.options&&e.setOptiontDefaults(this)}return _createClass(e,null,[{key:"setOptiontDefaults",value:function(e){e.options||(e.options={}),e.options=Object.assign({parentId:0,rowNumberHeaders:1,rowNumberFirst:2,rowNumberLast:0,stepsNumber:1,step:1,categoriesSeparator:"",sheetName:"",contentType:"",articulFieldName:"",aliasAdditionalFieldName:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"',skipFound:!1,filesDownload:!1},e.options)}}]),e}(),W=n("wgQU"),k=n("lRln"),C=n("BWxc"),E=n("Y2tp"),M=n("1kSV"),S=n("sYmb"),T=n("c863"),R=n("Cp0g");function I(e,t){if(1&e&&(h.Wb(0,"div",47),h.Oc(1),h.Vb()),2&e){var n=h.kc();h.Db(1),h.Qc(" ",n.formErrors.title," ")}}function w(e,t){if(1&e&&(h.Wb(0,"div",48),h.Oc(1),h.Vb()),2&e){var n=h.kc();h.Db(1),h.Qc(" ",n.formErrors.fileData," ")}}function _(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",16),h.Wb(2,"div",17),h.Wb(3,"div",16),h.Wb(4,"div",27),h.Wb(5,"div",22),h.Wb(6,"label",49),h.Wb(7,"span",29),h.lc(8,"translate"),h.Oc(9),h.lc(10,"translate"),h.Vb(),h.Vb(),h.Wb(11,"input",50),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvSeparator=e})),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"div",27),h.Wb(13,"div",22),h.Wb(14,"label",51),h.Wb(15,"span",29),h.lc(16,"translate"),h.Oc(17),h.lc(18,"translate"),h.Vb(),h.Vb(),h.Wb(19,"input",52),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvEnclosure=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(20,"div",17),h.Wb(21,"div",22),h.Wb(22,"label",53),h.Oc(23),h.lc(24,"translate"),h.Vb(),h.Wb(25,"input",54),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvEncoding=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc();h.Db(7),h.rc("title",h.mc(8,8,"CSV_SEPARATOR")),h.Db(2),h.Pc(h.mc(10,10,"CSV_SEPARATOR")),h.Db(2),h.rc("ngModel",i.model.options.csvSeparator),h.Db(4),h.rc("title",h.mc(16,12,"CSV_ENCLOSURE")),h.Db(2),h.Pc(h.mc(18,14,"CSV_ENCLOSURE")),h.Db(2),h.rc("ngModel",i.model.options.csvEnclosure),h.Db(4),h.Pc(h.mc(24,16,"CSV_ENCODING")),h.Db(2),h.rc("ngModel",i.model.options.csvEncoding)}}function P(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n),h.Db(1),h.Pc(n)}}function N(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Pc(n.title)}}function L(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Qc(" ",n.title," ")}}function A(e,t){if(1&e&&(h.Ub(0),h.Mc(1,L,2,2,"option",58),h.Tb()),2&e){var n=h.kc(2);h.Db(1),h.rc("ngForOf",n.contentType.fields)}}function F(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Qc(" ",n.title," ")}}function x(e,t){if(1&e&&(h.Ub(0),h.Mc(1,F,2,2,"option",58),h.Tb()),2&e){var n=h.kc(2);h.Db(1),h.rc("ngForOf",n.contentType.fields)}}function Q(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n),h.Db(1),h.Pc(n)}}var U=function(){return{standalone:!0}};function q(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",84),h.Wb(1,"div",85),h.Wb(2,"div",86),h.Wb(3,"span",87),h.Oc(4),h.lc(5,"translate"),h.Vb(),h.Vb(),h.Wb(6,"select",88),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc(3).model.options.step=e})),h.Mc(7,Q,2,2,"option",58),h.Vb(),h.Vb(),h.Vb()}if(2&e){var i=h.kc(3);h.Db(4),h.Qc(" ",h.mc(5,4,"STEP")," "),h.Db(2),h.rc("ngModel",i.model.options.step)("ngModelOptions",h.vc(6,U)),h.Db(1),h.rc("ngForOf",i.steps)}}function $(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",99),h.Wb(2,"input",100),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().$implicit.targetName=e})),h.lc(3,"translate"),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc().$implicit;h.Db(2),h.rc("ngbTooltip",h.mc(3,2,"SYSTEM_NAME"))("ngModel",i.targetName)}}function j(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Qc(" ",n.title," ")}}function B(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"select",61),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc(2).$implicit.targetName=e})),h.Mc(2,j,2,2,"option",58),h.Vb(),h.Tb()}if(2&e){var i=h.kc(2).$implicit,o=h.kc(3);h.Db(1),h.rc("ngModel",i.targetName),h.Db(1),h.rc("ngForOf",o.contentType.fields)}}function X(e,t){if(1&e&&(h.Ub(0),h.Wb(1,"div",99),h.Mc(2,B,3,2,"ng-container",37),h.Vb(),h.Tb()),2&e){var n=h.kc(4);h.Db(2),h.rc("ngIf",n.contentType)}}function z(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",99),h.Wb(2,"input",100),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().$implicit.separator=e})),h.lc(3,"translate"),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc().$implicit;h.Db(2),h.rc("ngbTooltip",h.mc(3,2,"SEPARATOR"))("ngModel",i.separator)}}function G(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",107),h.Wb(2,"input",100),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().$implicit.targetTitle=e})),h.lc(3,"translate"),h.Vb(),h.Vb(),h.Wb(4,"div",108),h.Wb(5,"input",100),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().$implicit.targetName=e})),h.lc(6,"translate"),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc().$implicit;h.Db(2),h.rc("ngbTooltip",h.mc(3,4,"FIELD_NAME"))("ngModel",i.targetTitle),h.Db(3),h.rc("ngbTooltip",h.mc(6,6,"SYSTEM_NAME"))("ngModel",i.targetName)}}function H(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",107),h.Wb(1,"input",100),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc(2).$implicit.targetTitle=e})),h.lc(2,"translate"),h.Vb(),h.Vb()}if(2&e){var i=h.kc(2).$implicit;h.Db(1),h.rc("ngbTooltip",h.mc(2,2,"FIELD_NAME"))("ngModel",i.targetTitle)}}function Y(e,t){if(1&e&&(h.Wb(0,"option",71),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Qc(" ",n.title," ")}}function K(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"select",61),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc(2).$implicit.targetName=e})),h.Mc(2,Y,2,2,"option",58),h.Vb(),h.Tb()}if(2&e){var i=h.kc(2).$implicit,o=h.kc(5);h.Db(1),h.rc("ngModel",i.targetName),h.Db(1),h.rc("ngForOf",o.contentType.fields)}}var J=function(e,t){return{"col-4":e,"col-6":t}};function Z(e,t){if(1&e&&(h.Ub(0),h.Mc(1,H,3,4,"div",109),h.Wb(2,"div",110),h.Mc(3,K,3,2,"ng-container",37),h.Vb(),h.Tb()),2&e){var n=h.kc().$implicit,i=h.kc(5);h.Db(1),h.rc("ngIf",i.getIsParametersField(n.targetName)),h.Db(1),h.rc("ngClass",h.xc(3,J,i.getIsParametersField(n.targetName),!i.getIsParametersField(n.targetName))),h.Db(1),h.rc("ngIf",i.contentType)}}function ee(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",105),h.Wb(1,"div",92),h.Wb(2,"select",61),h.ic("ngModelChange",(function(e){return h.Ec(n),t.$implicit.targetAction=e}))("ngModelChange",(function(e){h.Ec(n);var i=t.$implicit,o=h.kc(2).$implicit;return h.kc(3).onChangeFieldAction(i,e,o)})),h.Wb(3,"option",57),h.Oc(4),h.lc(5,"translate"),h.Vb(),h.Wb(6,"option",94),h.Oc(7),h.lc(8,"translate"),h.Vb(),h.Wb(9,"option",95),h.Oc(10),h.lc(11,"translate"),h.Vb(),h.Wb(12,"option",106),h.Oc(13),h.lc(14,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Ub(15,97),h.Mc(16,G,7,8,"ng-container",98),h.Mc(17,Z,4,6,"ng-container",98),h.Tb(),h.Vb()}if(2&e){var i=t.$implicit,o=h.kc(5);h.Db(1),h.rc("ngClass",o.getFieldsColumnClass(i,"field_sub")),h.Db(1),h.rc("ngModel",i.targetAction),h.Db(2),h.Pc(h.mc(5,9,"NO_IMPORT")),h.Db(3),h.Pc(h.mc(8,11,"SELECT_FIELD")),h.Db(3),h.Pc(h.mc(11,13,"CREATE_FIELD")),h.Db(3),h.Qc("\xd7 ",h.mc(14,15,"DELETE"),""),h.Db(2),h.rc("ngSwitch",i.targetAction),h.Db(1),h.rc("ngSwitchCase","new"),h.Db(1),h.rc("ngSwitchCase","field")}}function te(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",16),h.Wb(2,"div",101),h.Rb(3,"hr"),h.Mc(4,ee,18,17,"div",102),h.Wb(5,"div",103),h.Wb(6,"button",104),h.ic("click",(function(e){h.Ec(n);var t=h.kc().$implicit;return h.kc(3).fieldAddOptions(t,e)})),h.Oc(7),h.lc(8,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc().$implicit;h.Db(4),h.rc("ngForOf",i.options),h.Db(3),h.Qc(" ",h.mc(8,2,"ADD")," ")}}function ne(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"tr"),h.Wb(2,"td"),h.Wb(3,"div",16),h.Wb(4,"div",89),h.Oc(5),h.Vb(),h.Wb(6,"div",90),h.Wb(7,"div",91),h.Wb(8,"div",92),h.Wb(9,"select",61),h.ic("ngModelChange",(function(e){return h.Ec(n),t.$implicit.targetAction=e}))("ngModelChange",(function(e){h.Ec(n);var i=t.$implicit;return h.kc(3).onChangeFieldAction(i,"field",e)})),h.Wb(10,"option",57),h.Oc(11),h.lc(12,"translate"),h.Vb(),h.Wb(13,"option",93),h.Oc(14),h.lc(15,"translate"),h.Vb(),h.Wb(16,"option",94),h.Oc(17),h.lc(18,"translate"),h.Vb(),h.Wb(19,"option",95),h.Oc(20),h.lc(21,"translate"),h.Vb(),h.Wb(22,"option",96),h.Oc(23),h.lc(24,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Ub(25,97),h.Mc(26,$,4,4,"ng-container",98),h.Mc(27,X,3,1,"ng-container",98),h.Mc(28,z,4,4,"ng-container",98),h.Tb(),h.Vb(),h.Vb(),h.Vb(),h.Mc(29,te,9,4,"ng-container",37),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=t.$implicit,o=h.kc(3);h.Db(5),h.Qc(" ",i.sourceTitle," "),h.Db(3),h.rc("ngClass",o.getFieldsColumnClass(i,"field")),h.Db(1),h.rc("ngModel",i.targetAction),h.Db(2),h.Pc(h.mc(12,13,"NO_IMPORT")),h.Db(3),h.Pc(h.mc(15,15,"CATEGORY")),h.Db(3),h.Pc(h.mc(18,17,"SELECT_FIELD")),h.Db(3),h.Pc(h.mc(21,19,"CREATE_FIELD")),h.Db(3),h.Pc(h.mc(24,21,"SPLIT")),h.Db(2),h.rc("ngSwitch",i.targetAction),h.Db(1),h.rc("ngSwitchCase","new"),h.Db(1),h.rc("ngSwitchCase","field"),h.Db(1),h.rc("ngSwitchCase","split"),h.Db(1),h.rc("ngIf","split"==i.targetAction)}}function ie(e,t){if(1&e&&(h.Wb(0,"tr"),h.Wb(1,"td"),h.Oc(2),h.Vb(),h.Vb()),2&e){var n=t.$implicit;h.Db(2),h.Qc(" ",n," ")}}function oe(e,t){if(1&e&&(h.Wb(0,"table",124),h.Wb(1,"thead"),h.Wb(2,"tr"),h.Wb(3,"th"),h.Oc(4),h.lc(5,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(6,"tbody"),h.Mc(7,ie,3,1,"tr",83),h.Vb(),h.Vb()),2&e){var n=h.kc(4);h.Db(4),h.Pc(h.mc(5,2,"CATEGORIES")),h.Db(3),h.rc("ngForOf",n.testData.categories)}}function re(e,t){if(1&e&&(h.Wb(0,"tr"),h.Wb(1,"td"),h.Oc(2),h.Vb(),h.Wb(3,"td"),h.Oc(4),h.lc(5,"json"),h.Vb(),h.Vb()),2&e){var n=t.$implicit;h.Db(2),h.Qc(" ",n.key," "),h.Db(2),h.Qc(" ",h.mc(5,2,n.value)," ")}}function ae(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",111),h.Wb(2,"div",112),h.Wb(3,"div",113),h.Wb(4,"button",114),h.ic("click",(function(e){return h.Ec(n),h.kc(3).clearTestData(e)})),h.Oc(5),h.lc(6,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(7,"div",16),h.Wb(8,"div",115),h.Mc(9,oe,8,4,"table",116),h.Wb(10,"table",117),h.Wb(11,"colgroup"),h.Rb(12,"col",118),h.Vb(),h.Wb(13,"tr"),h.Wb(14,"td"),h.Oc(15),h.lc(16,"translate"),h.Vb(),h.Wb(17,"td"),h.Oc(18),h.Vb(),h.Vb(),h.Wb(19,"tr"),h.Wb(20,"td"),h.Oc(21),h.lc(22,"translate"),h.Vb(),h.Wb(23,"td"),h.Oc(24),h.Vb(),h.Vb(),h.Wb(25,"tr"),h.Wb(26,"td"),h.Oc(27),h.lc(28,"translate"),h.Vb(),h.Wb(29,"td"),h.Oc(30),h.lc(31,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(32,"div",119),h.Wb(33,"div",120),h.Wb(34,"table",117),h.Wb(35,"colgroup"),h.Rb(36,"col",121),h.Rb(37,"col",122),h.Vb(),h.Wb(38,"thead"),h.Wb(39,"tr"),h.Wb(40,"th",123),h.Oc(41),h.lc(42,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(43,"tbody"),h.Mc(44,re,6,4,"tr",83),h.lc(45,"keyvalue"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc(3);h.Db(5),h.Qc(" ",h.mc(6,11,"CLOSE")," "),h.Db(4),h.rc("ngIf",i.testData.categories.length),h.Db(6),h.Qc(" ",h.mc(16,13,"ROW_NUMBER")," "),h.Db(3),h.Qc(" ",i.testData.row_number_first," "),h.Db(3),h.Qc(" ",h.mc(22,15,"MEMORY_USED")," "),h.Db(3),h.Qc(" ",i.testData.memory_peak_usage," "),h.Db(3),h.Qc(" ",h.mc(28,17,"TIME_EXECUTION")," "),h.Db(3),h.Rc(" ",i.testData.time_execution," ",h.mc(31,19,"TIME_EXECUTION_SEC")," "),h.Db(11),h.Pc(h.mc(42,21,"PRODUCT_DATA")),h.Db(3),h.rc("ngForOf",h.mc(45,23,i.testData.data))}}function le(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",72),h.Wb(1,"div",73),h.Wb(2,"div",74),h.Mc(3,q,8,7,"div",75),h.Wb(4,"button",76),h.ic("click",(function(e){return h.Ec(n),h.kc(2).startImport(e)})),h.Oc(5),h.lc(6,"translate"),h.Vb(),h.Vb(),h.Wb(7,"button",77),h.ic("click",(function(e){return h.Ec(n),h.kc(2).updateData(e)})),h.lc(8,"translate"),h.Rb(9,"i",78),h.Vb(),h.Wb(10,"button",79),h.ic("click",(function(e){return h.Ec(n),h.kc(2).getTestData(e)})),h.Oc(11),h.lc(12,"translate"),h.Vb(),h.Vb(),h.Wb(13,"div",80),h.Wb(14,"div",81),h.Wb(15,"table",82),h.Mc(16,ne,30,23,"ng-container",83),h.Vb(),h.Vb(),h.Mc(17,ae,46,25,"ng-container",37),h.Vb(),h.Vb()}if(2&e){var i=h.kc(2);h.Db(3),h.rc("ngIf",i.model.options.stepsNumber>1),h.Db(2),h.Qc(" ",h.mc(6,7,"START_IMPORT")," "),h.Db(2),h.rc("ngbTooltip",h.mc(8,9,"REFRESH")),h.Db(3),h.rc("disabled",i.testData),h.Db(1),h.Qc(" ",h.mc(12,11,"TEST")," "),h.Db(5),h.rc("ngForOf",i.model.fieldsOptions),h.Db(1),h.rc("ngIf",i.testData)}}function ce(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div"),h.Rb(2,"hr"),h.Wb(3,"div",16),h.Wb(4,"div",17),h.Wb(5,"div",22),h.Wb(6,"label",55),h.Oc(7),h.lc(8,"translate"),h.Vb(),h.Wb(9,"select",56),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.sheetName=e}))("ngModelChange",(function(){return h.Ec(n),h.kc().getSheetProperties()})),h.Rb(10,"option",57),h.Mc(11,P,2,2,"option",58),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"div",17),h.Wb(13,"div",22),h.Wb(14,"label",59),h.Oc(15),h.lc(16,"translate"),h.Vb(),h.Wb(17,"app-select-parent-dropdown",60),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.parentId=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(18,"div",16),h.Wb(19,"div",17),h.Wb(20,"div",22),h.Wb(21,"label",55),h.Oc(22),h.lc(23,"translate"),h.Vb(),h.Wb(24,"select",61),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.contentType=e}))("ngModelChange",(function(e){return h.Ec(n),h.kc().getContentType(e)})),h.Rb(25,"option",57),h.Mc(26,N,2,2,"option",58),h.lc(27,"async"),h.Vb(),h.Vb(),h.Vb(),h.Wb(28,"div",17),h.Wb(29,"div",22),h.Wb(30,"label",62),h.Oc(31),h.lc(32,"translate"),h.Vb(),h.Wb(33,"select",63),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.articulFieldName=e})),h.Rb(34,"option",57),h.Mc(35,A,2,1,"ng-container",37),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(36,"div",16),h.Wb(37,"div",17),h.Wb(38,"label",64),h.Wb(39,"span",29),h.lc(40,"translate"),h.Oc(41),h.lc(42,"translate"),h.Vb(),h.Vb(),h.Wb(43,"select",65),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.aliasAdditionalFieldName=e})),h.Rb(44,"option",57),h.Mc(45,x,2,1,"ng-container",37),h.Vb(),h.Vb(),h.Wb(46,"div",17),h.Wb(47,"div",66),h.Wb(48,"div",67),h.Wb(49,"input",68),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.filesDownload=e})),h.Vb(),h.Wb(50,"label",69),h.Oc(51),h.lc(52,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(53,"div",22),h.Wb(54,"div",67),h.Wb(55,"input",68),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.skipFound=e})),h.Vb(),h.Wb(56,"label",69),h.Oc(57),h.lc(58,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Mc(59,le,18,13,"div",70),h.Vb(),h.Tb()}if(2&e){var i=h.kc();h.Db(1),h.Ib("loading",i.loadingConfiguration),h.Db(6),h.Pc(h.mc(8,26,"SHEET")),h.Db(2),h.rc("ngModel",i.model.options.sheetName),h.Db(2),h.rc("ngForOf",i.model.sheetsNames),h.Db(4),h.Pc(h.mc(16,28,"PARENT_FOLDER")),h.Db(2),h.rc("ngModel",i.model.options.parentId),h.Db(5),h.Pc(h.mc(23,30,"CONTENT_TYPE")),h.Db(2),h.rc("ngModel",i.model.options.contentType),h.Db(2),h.rc("ngForOf",h.mc(27,32,i.contentTypes$)),h.Db(5),h.Pc(h.mc(32,34,"SEARCH_FIELD")),h.Db(2),h.rc("ngModel",i.model.options.articulFieldName),h.Db(2),h.rc("ngIf",i.contentType),h.Db(4),h.rc("title",h.mc(40,36,"ALIAS_ADDITIONAL_FIELD")),h.Db(2),h.Pc(h.mc(42,38,"ALIAS_ADDITIONAL_FIELD")),h.Db(2),h.rc("ngModel",i.model.options.aliasAdditionalFieldName),h.Db(2),h.rc("ngIf",i.contentType),h.Db(4),h.tc("id","fieldFilesDownload",i.uniqueId,""),h.rc("ngModel",i.model.options.filesDownload),h.Db(1),h.tc("for","fieldFilesDownload",i.uniqueId,""),h.Db(1),h.Pc(h.mc(52,40,"FILES_DOWNLOAD")),h.Db(4),h.tc("id","fieldSkipFound",i.uniqueId,""),h.rc("ngModel",i.model.options.skipFound),h.Db(1),h.tc("for","fieldSkipFound",i.uniqueId,""),h.Db(1),h.Pc(h.mc(58,42,"SKIP_FOUND")),h.Db(2),h.rc("ngIf",i.model.options.sheetName)}}function se(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",125),h.Wb(1,"button",126),h.ic("click",(function(){return h.Ec(n),h.kc().errorMessage=""})),h.Wb(2,"span",127),h.Oc(3,"\xd7"),h.Vb(),h.Vb(),h.Oc(4),h.Vb()}if(2&e){var i=h.kc();h.Db(4),h.Qc(" ",i.errorMessage," ")}}function be(e,t){if(1&e&&(h.Wb(0,"span"),h.Oc(1),h.Vb()),2&e){var n=h.kc(2);h.Db(1),h.Qc("",n.percent,"%")}}function de(e,t){if(1&e&&(h.Ub(0),h.Wb(1,"div",128),h.Wb(2,"ngb-progressbar",129),h.Mc(3,be,2,1,"span",37),h.Vb(),h.Vb(),h.Tb()),2&e){var n=h.kc();h.Db(2),h.rc("value",n.percent)("animated",!0)("striped",!0),h.Db(1),h.rc("ngIf",n.percent>10)}}var ue,pe,fe,me=((ue=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,a,l,c,s,b,d,u,p){var f;return _classCallCheck(this,n),(f=t.call(this,e,i,o,r,a,l,c)).fb=e,f.dataService=i,f.systemNameService=o,f.activeModal=r,f.tooltipConfig=a,f.translateService=l,f.elRef=c,f.modalService=s,f.settingsService=b,f.contentTypeService=d,f.appSettings=u,f.messageService=p,f.model=new O(0,""),f.modalTitle="Import",f.loadingConfiguration=!1,f.isInitialised=!1,f.sheetHeaders=[],f.contentTypes=[],f.percent=0,f.showProgressBar=!1,f.steps=[1],f.formFields={title:{fieldLabel:"TITLE",value:"",validators:[y.w.required],messages:{}},fileData:{fieldLabel:"FILE",value:"",validators:[y.w.required],messages:{}},rowNumberHeaders:{fieldLabel:"ROW_NUMBER_HEADERS",value:1,dataKey:"options",validators:[],messages:{}},rowNumberFirst:{fieldLabel:"ROW_NUMBER_FIRST",value:2,dataKey:"options",validators:[],messages:{}},rowNumberLast:{fieldLabel:"ROW_NUMBER_LAST",value:0,dataKey:"options",validators:[],messages:{}},categoriesSeparator:{fieldLabel:"SEPARATOR_CATEGORIES",value:"",dataKey:"options",validators:[],messages:{}}},f.files={},f}return _createClass(n,[{key:"onBeforeInit",value:function(){this.model&&!this.model.options&&(this.model.options={})}},{key:"onAfterInit",value:function(){this.itemId&&this.getContentTypesList()}},{key:"onAfterGetData",value:function(){var e=this;setTimeout((function(){e.isInitialised=!0}),1),this.model.options.contentType&&this.getContentType(),this.model.fieldsOptions&&0!==this.model.fieldsOptions.length||this.getSheetProperties(),this.updateStepsArr()}},{key:"getFileName",value:function(e){return"string"==typeof e?e:k.a.getFileName(e)}},{key:"onOptionChanged",value:function(){this.isInitialised&&(clearTimeout(this.timerConfiguration),this.timerConfiguration=setTimeout(this.getSheetProperties.bind(this),700))}},{key:"getContentTypesList",value:function(){this.contentTypes$=this.contentTypeService.getListPage().pipe(Object(D.a)((function(e){return e.items})))}},{key:"getContentType",value:function(e){var t=this;e||(e=this.model.options.contentType),e?(this.loadingConfiguration=!0,this.contentTypeService.getItemByName(e).subscribe({next:function(e){t.contentType=e,t.loadingConfiguration=!1},error:function(e){e.error&&(t.errorMessage=e.error),t.contentType=null,t.loadingConfiguration=!1}})):this.contentType=null}},{key:"onChangeFieldAction",value:function(e,t,n){if(e.targetName="",e.targetTitle="",e.separator="",e.options=[],"delete"===t&&n){var i=Object(b.findIndex)(n.options,{targetAction:"delete"});i>-1&&n.options.splice(i,1)}}},{key:"getSheetProperties",value:function(e){var t=this;e&&e.preventDefault(),this.model.options.sheetName?(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.getSheetProperties(this.model).subscribe({next:function(e){t.model.fieldsOptions=e.fieldsOptions,t.model.options.rowNumberLast=e.rowsQuantity,t.loadingConfiguration=!1},error:function(e){t.errorMessage=e.error||t.getLangString("ERROR"),t.loadingConfiguration=!1}})):this.sheetHeaders=[]}},{key:"getTestData",value:function(e){var t=this;e&&e.preventDefault(),this.loading||this.loadingConfiguration||(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.testData(this.model).subscribe({next:function(e){e?t.testData=e:t.errorMessage=t.getLangString("ERROR"),t.loadingConfiguration=!1},error:function(e){t.errorMessage=e.error||t.getLangString("ERROR"),t.loadingConfiguration=!1}}))}},{key:"updateData",value:function(e){e&&e.preventDefault(),this.testData?this.getTestData():this.getSheetProperties()}},{key:"fieldAddOptions",value:function(e,t){t&&t.preventDefault(),e.options.push({targetAction:""})}},{key:"getIsFieldsCount",value:function(e,t){switch(t){case 1:return!e.targetAction||["category"].indexOf(e.targetAction)>-1;case 2:return["field","split"].indexOf(e.targetAction)>-1;case 3:return["new"].indexOf(e.targetAction)>-1}return!0}},{key:"getIsParametersField",value:function(e){return!!this.contentType&&this.contentType.fields.filter((function(e){return"parameters"===e.inputType})).map((function(e){return e.name})).indexOf(e)>-1}},{key:"getFieldsColumnClass",value:function(e,t){var n=[["split","field","new"],[]],i=["col-6 pr-2","col-4 pr-2"],o=this.getIsParametersField(e.targetName);"field_sub"==t&&(n=[["split"],["new"]],o?n[1].push("field"):n[0].push("field"),i=["col-6 pr-2","col-4 pr-2"]);var r="col-12";return n.forEach((function(t,n){t.indexOf(e.targetAction)>-1&&(r=i[n])})),r}},{key:"onStepNumberChange",value:function(){this.updateStepsArr()}},{key:"onImportCompleted",value:function(){this.showProgressBar=!1,this.loading=!1,this.activeModal.close({reason:"import_completed"})}},{key:"updateStepsArr",value:function(){this.steps=Object(b.range)(1,Math.max(1,parseInt(String(this.model.options.stepsNumber))+1)),this.model.options.step=1}},{key:"startImport",value:function(e){var t=this;if(e&&e.preventDefault(),!this.loading&&!this.loadingConfiguration){this.errorMessage="",this.testData=null,this.loading=!0,this.percent=0;var n=0,i="",o={};this.dataService.importDataProgress(this.model).subscribe({next:function(e){if(e instanceof f.h)t.updatePercent(100);else if(e instanceof f.d)200!==e.status&&400!==e.status&&t.onImportCompleted();else if(e.type===f.c.DownloadProgress){var r=(i=e.partialText.substr(n).trim()).split("\n");i=r[r.length-1],n=e.partialText.length,"{"===i.substr(0,1)&&"}"===i.substr(i.length-1,1)&&(o=JSON.parse(i),t.updatePercent((o.currentIndex-o.rowNumberFirst)/(o.rowNumberLast-o.rowNumberFirst)*100))}},error:function(e){e.error&&e.error.indexOf("{")>-1&&(e.error=JSON.parse(e.error),e.error=e.error.error||t.getLangString("ERROR")),t.errorMessage=e.error||t.getLangString("ERROR"),t.showProgressBar=!1,t.loading=!1}})}}},{key:"updatePercent",value:function(e){var t=this;this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout((function(){t.onImportCompleted()}),1e3)}},{key:"confirmAction",value:function(e){return this.modalRef=this.modalService.open(E.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}},{key:"clearTestData",value:function(e){e&&e.preventDefault(),this.testData=null}},{key:"saveRequest",value:function(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}}]),n}(V.a)).\u0275fac=function(e){return new(e||ue)(h.Qb(y.e),h.Qb(v),h.Qb(c.a),h.Qb(M.b),h.Qb(M.v),h.Qb(S.d),h.Qb(h.l),h.Qb(M.h),h.Qb(l.a),h.Qb(C.a),h.Qb(W.a),h.Qb(d.b))},ue.\u0275cmp=h.Kb({type:ue,selectors:[["app-modal-import"]],inputs:{model:"model"},features:[h.Cb([v,d.b]),h.Ab],decls:96,vars:76,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],["formControlName","fileData",3,"allowedExtensions","fieldName","largeFieldMode","files","ngModel","filesChange","ngModelChange"],["class","alert alert-danger d-block px-2 py-0 mt-2",4,"ngIf"],["for","fieldRowNumberHeaders",1,"label-filled"],["type","number","id","fieldRowNumberHeaders","step","1","min","1","name","rowNumberHeaders","formControlName","rowNumberHeaders",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-lg-6"],["for","fieldRowNumberFirst",1,"label-filled","max-width95"],[1,"text-overflow",3,"title"],["type","number","id","fieldRowNumberFirst","step","1","min","1","name","rowNumberFirst","formControlName","rowNumberFirst",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldRowNumberLast",1,"label-filled","max-width95"],["type","number","id","fieldRowNumberLast","step","1","min","1","name","rowNumberLast","formControlName","rowNumberLast",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator","name","categoriesSeparator","formControlName","categoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldStepsNumber",1,"label-filled"],["type","number","id","fieldStepsNumber","step","1","min","1","max","100",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[4,"ngIf"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[1,"alert","alert-danger","d-block","px-2","py-0","mt-2"],["for","fieldCSVSeparator",1,"label-filled","max-width95"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled","max-width95"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldSheetsNames",1,"label-filled"],["id","fieldSheetsNames",1,"custom-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"label-filled"],[3,"ngModel","ngModelChange"],[1,"custom-select",3,"ngModel","ngModelChange"],["for","fieldArticulFieldName",1,"label-filled"],["id","fieldArticulFieldName",1,"custom-select",3,"ngModel","ngModelChange"],["for","fieldAliasAdditionalFieldName",1,"label-filled","max-width95"],["id","fieldAliasAdditionalFieldName",1,"custom-select",3,"ngModel","ngModelChange"],[1,"form-group","mb-2"],[1,"custom-control","custom-checkbox"],["type","checkbox",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"for"],["class","card",4,"ngIf"],[3,"value"],[1,"card"],[1,"card-header"],[1,"float-none","float-lg-right","mb-2","mb-lg-0"],["class","d-inline-block mr-2","style","width: 150px;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-wide",3,"click"],["type","button",1,"btn","btn-secondary","mr-2",3,"ngbTooltip","click"],[1,"icon-repeat"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"d-inline-block","mr-2",2,"width","150px"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["id","fieldStep",1,"custom-select",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],["value","category"],["value","field"],["value","new"],["value","split"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","pl-2"],["type","text",1,"form-control",3,"ngbTooltip","ngModel","ngModelChange"],[1,"col-12","col-lg-8","offset-lg-4"],["class","row no-gutters mb-3",4,"ngFor","ngForOf"],[1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm","btn-wide",3,"click"],[1,"row","no-gutters","mb-3"],["value","delete"],[1,"col-4","px-1"],[1,"col-4","pl-2"],["class","col-4 px-1",4,"ngIf"],[1,"pl-2",3,"ngClass"],[1,"p-2","border-top"],[1,"position-relative"],[1,"position-absolute","pos-absolute-right2",2,"z-index","10"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"col-lg-5"],["class","table table-striped table-bordered bg-light table-sm mt-0",4,"ngIf"],[1,"table","table-striped","table-bordered","bg-light","table-sm","my-0"],["width","50%","span","2"],[1,"col-lg-7"],[1,"table-responsive"],["width","40%"],["width","60%"],["colspan","2"],[1,"table","table-striped","table-bordered","bg-light","table-sm","mt-0"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Wb(1,"div",1),h.Wb(2,"button",2),h.ic("click",(function(e){return t.closeModal(e)})),h.Rb(3,"i",3),h.Wb(4,"span"),h.Oc(5),h.lc(6,"translate"),h.Vb(),h.Vb(),h.Wb(7,"button",2),h.ic("click",(function(e){return t.minimize(e)})),h.Rb(8,"i",4),h.Wb(9,"span"),h.Oc(10),h.lc(11,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"div",5),h.Wb(13,"div",6),h.Wb(14,"div",7),h.Wb(15,"button",8),h.ic("click",(function(e){return t.maximize(e)})),h.lc(16,"translate"),h.Rb(17,"i",9),h.Vb(),h.Wb(18,"button",10),h.ic("click",(function(e){return t.closeModal(e)})),h.lc(19,"translate"),h.Rb(20,"i",11),h.Vb(),h.Vb(),h.Vb(),h.Wb(21,"h4",12),h.Oc(22),h.Vb(),h.Vb(),h.Wb(23,"div",13),h.Wb(24,"form",14,15),h.Wb(26,"div",16),h.Wb(27,"div",17),h.Wb(28,"div",18),h.Wb(29,"label",19),h.Oc(30),h.lc(31,"translate"),h.Vb(),h.Wb(32,"input",20),h.ic("ngModelChange",(function(e){return t.model.title=e})),h.Vb(),h.Mc(33,I,2,1,"div",21),h.Vb(),h.Vb(),h.Wb(34,"div",17),h.Wb(35,"div",22),h.Wb(36,"app-file-widget",23),h.ic("filesChange",(function(e){return t.files=e}))("ngModelChange",(function(e){return t.model.fileData=e})),h.Vb(),h.Mc(37,w,2,1,"div",24),h.Vb(),h.Vb(),h.Vb(),h.Wb(38,"div",16),h.Wb(39,"div",17),h.Wb(40,"div",22),h.Wb(41,"label",25),h.Oc(42),h.lc(43,"translate"),h.Vb(),h.Wb(44,"input",26),h.ic("ngModelChange",(function(e){return t.model.options.rowNumberHeaders=e}))("ngModelChange",(function(){return t.onOptionChanged()})),h.Vb(),h.Vb(),h.Vb(),h.Wb(45,"div",17),h.Wb(46,"div",16),h.Wb(47,"div",27),h.Wb(48,"div",22),h.Wb(49,"label",28),h.Wb(50,"span",29),h.lc(51,"translate"),h.Oc(52),h.lc(53,"translate"),h.Vb(),h.Vb(),h.Wb(54,"input",30),h.ic("ngModelChange",(function(e){return t.model.options.rowNumberFirst=e})),h.Vb(),h.Vb(),h.Vb(),h.Wb(55,"div",27),h.Wb(56,"div",22),h.Wb(57,"label",31),h.Wb(58,"span",29),h.lc(59,"translate"),h.Oc(60),h.lc(61,"translate"),h.Vb(),h.Vb(),h.Wb(62,"input",32),h.ic("ngModelChange",(function(e){return t.model.options.rowNumberLast=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(63,"div",16),h.Wb(64,"div",17),h.Wb(65,"div",22),h.Wb(66,"label",33),h.Oc(67),h.lc(68,"translate"),h.Vb(),h.Wb(69,"input",34),h.ic("ngModelChange",(function(e){return t.model.options.categoriesSeparator=e})),h.Vb(),h.Vb(),h.Vb(),h.Wb(70,"div",17),h.Wb(71,"div",22),h.Wb(72,"label",35),h.Oc(73),h.lc(74,"translate"),h.Vb(),h.Wb(75,"input",36),h.ic("ngModelChange",(function(e){return t.model.options.stepsNumber=e}))("ngModelChange",(function(){return t.onStepNumberChange()})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Mc(76,_,26,18,"ng-container",37),h.Mc(77,ce,60,44,"ng-container",37),h.Mc(78,se,5,1,"div",38),h.Mc(79,de,4,4,"ng-container",37),h.Vb(),h.Wb(80,"div",39),h.Wb(81,"div",40),h.Wb(82,"button",41),h.ic("click",(function(e){return t.save(!0,e)})),h.Wb(83,"span"),h.Oc(84),h.lc(85,"translate"),h.Vb(),h.Vb(),h.Wb(86,"div",42),h.Rb(87,"button",43),h.Wb(88,"div",44),h.Wb(89,"button",45),h.ic("click",(function(e){return t.save(!1,e)})),h.Oc(90),h.lc(91,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(92,"button",46),h.ic("click",(function(e){return t.closeModal(e)})),h.Wb(93,"span"),h.Oc(94),h.lc(95,"translate"),h.Vb(),h.Vb(),h.Vb()),2&e&&(h.Db(2),h.rc("disabled",t.submitted),h.Db(3),h.Pc(h.mc(6,45,"CLOSE")),h.Db(2),h.rc("disabled",t.submitted),h.Db(3),h.Pc(h.mc(11,47,"MINIMIZE")),h.Db(5),h.rc("title",h.mc(16,49,"EXPAND")),h.Db(3),h.rc("title",h.mc(19,51,"CLOSE")),h.Db(3),h.rc("title",t.modalTitle),h.Db(1),h.Pc(t.modalTitle),h.Db(1),h.Ib("loading",t.loading),h.Db(1),h.rc("formGroup",t.form),h.Db(6),h.Pc(h.mc(31,53,"TITLE")),h.Db(2),h.Ib("is-invalid",t.formErrors.title),h.rc("ngModel",t.model.title),h.Db(1),h.rc("ngIf",t.formErrors.title),h.Db(3),h.rc("allowedExtensions",".xls,.xlsx,.csv")("fieldName","fileData")("largeFieldMode",!1)("files",t.files)("ngModel",t.model.fileData),h.Db(1),h.rc("ngIf",t.formErrors.fileData),h.Db(5),h.Pc(h.mc(43,55,"ROW_NUMBER_HEADERS")),h.Db(2),h.rc("ngModel",t.model.options.rowNumberHeaders),h.Db(6),h.rc("title",h.mc(51,57,"ROW_NUMBER_FIRST")),h.Db(2),h.Pc(h.mc(53,59,"ROW_NUMBER_FIRST")),h.Db(2),h.rc("ngModel",t.model.options.rowNumberFirst),h.Db(4),h.rc("title",h.mc(59,61,"ROW_NUMBER_LAST")),h.Db(2),h.Pc(h.mc(61,63,"ROW_NUMBER_LAST")),h.Db(2),h.rc("ngModel",t.model.options.rowNumberLast),h.Db(5),h.Pc(h.mc(68,65,"SEPARATOR_CATEGORIES")),h.Db(2),h.rc("ngModel",t.model.options.categoriesSeparator),h.Db(4),h.Pc(h.mc(74,67,"STEPS_NUMBER")),h.Db(2),h.rc("ngModel",t.model.options.stepsNumber)("ngModelOptions",h.vc(75,U)),h.Db(1),h.rc("ngIf","csv"==t.model.type),h.Db(1),h.rc("ngIf",t.model.id),h.Db(1),h.rc("ngIf",t.errorMessage),h.Db(1),h.rc("ngIf",t.showProgressBar),h.Db(3),h.rc("disabled",t.submitted&&t.form.valid),h.Db(2),h.Pc(h.mc(85,69,"SAVE_AND_CLOSE")),h.Db(3),h.rc("disabled",t.submitted&&t.form.valid),h.Db(3),h.Pc(h.mc(91,71,"SAVE")),h.Db(2),h.rc("disabled",t.submitted||t.loading),h.Db(2),h.Pc(h.mc(95,73,"CLOSE")))},directives:[y.y,y.o,y.h,y.b,y.n,y.g,o.p,T.a,y.s,y.q,M.d,M.g,M.f,M.e,y.v,y.r,y.x,o.o,R.a,y.a,M.u,o.n,o.r,o.s,M.n],pipes:[S.c,o.b,o.j,o.i],encapsulation:2}),ue),ge=n("hecf"),he=n("Gxio"),ve=((pe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,a){var l;return _classCallCheck(this,n),(l=t.call(this,e,i,o,r)).dataService=e,l.activeModal=i,l.modalService=o,l.translateService=r,l.messageService=a,l.queryOptions=new p.a("id","desc",1,10,0,0),l.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}},{name:"sheetsQuantity",sortName:"sheetsQuantity",title:"SHEETS_QUANTITY",outputType:"text",outputProperties:{}},{name:"rowsQuantity",sortName:"rowsQuantity",title:"ROWS_QUANTITY",outputType:"text",outputProperties:{}}],l}return _createClass(n,[{key:"onModalClose",value:function(e){"import_completed"===(e&&e.reason?e.reason:"")&&this.messageService.add({key:"message",severity:"success",summary:this.getLangString("MESSAGE"),detail:this.getLangString("IMPORT_COMPLETED")})}},{key:"getModalContent",value:function(){return me}},{key:"appendFormData",value:function(e){e.append("ownerType","import_export")}},{key:"getModalElementId",value:function(e){return["modal","export-config",e||0].join("-")}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_get(_getPrototypeOf(n.prototype),"setModalInputs",this).call(this,e,t,i),this.modalRef.componentInstance.modalTitle=void 0===e||t?this.getLangString("ADD_IMPORT_CONFIGURATION"):"".concat(this.getLangString("EDIT_IMPORT_CONFIGURATION")," #").concat(e);var o=Object(b.findIndex)(this.items,{id:e});o>-1&&(this.modalRef.componentInstance.model=this.items[o])}}]),n}(u.a)).title="IMPORT_EXPORT",pe.\u0275fac=function(e){return new(e||pe)(h.Qb(v),h.Qb(M.b),h.Qb(M.h),h.Qb(S.d),h.Qb(d.b))},pe.\u0275cmp=h.Kb({type:pe,selectors:[["app-import"]],features:[h.Cb([v,d.b]),h.Ab],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Rb(1,"div",1),h.Wb(2,"div",2),h.Wb(3,"div",3),h.Wb(4,"button",4),h.Wb(5,"span"),h.Oc(6),h.lc(7,"translate"),h.Vb(),h.Vb(),h.Wb(8,"div",5),h.Wb(9,"button",6),h.ic("click",(function(){return t.deleteSelected()})),h.Oc(10),h.lc(11,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"button",7),h.ic("click",(function(){return t.modalOpen()})),h.Rb(13,"i",8),h.Oc(14," \xa0 "),h.Wb(15,"span"),h.Oc(16),h.lc(17,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Rb(18,"div",9),h.Vb(),h.Wb(19,"app-table",10,11),h.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),h.Vb(),h.Rb(21,"p-toast",12)),2&e&&(h.Db(6),h.Pc(h.mc(7,9,"BATCH_ACTIONS")),h.Db(4),h.Pc(h.mc(11,11,"DELETE")),h.Db(6),h.Pc(h.mc(17,13,"ADD")),h.Db(3),h.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[M.d,M.g,M.f,ge.a,he.a],pipes:[S.c],styles:[""]}),pe),ye=function(){function e(t,n,i,o,r,a,l){_classCallCheck(this,e),this.id=t,this.title=n,this.fileData=i,this.type=o,this.fileSize=r,this.options=a,this.fieldsOptions=l,void 0===this.options&&e.setOptiontDefaults(this)}return _createClass(e,null,[{key:"setOptiontDefaults",value:function(e){e.options||(e.options={}),e.options=Object.assign({parentId:0,contentType:"",categoryType:"column",categoriesSeparator:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"'},e.options)}}]),e}(),De=((fe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("export"),i}return _createClass(n,[{key:"exportDataProgress",value:function(e){var t=this.getRequestUrl()+"/".concat(e.id,"/do_export");return this.http.request(new f.g("POST",t,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}}]),n}(g.a)).\u0275fac=function(e){return new(e||fe)(h.ec(f.a))},fe.\u0275prov=h.Mb({token:fe,factory:fe.\u0275fac}),fe);function Ve(e,t){if(1&e&&(h.Wb(0,"div",60),h.Oc(1),h.Vb()),2&e){var n=h.kc();h.Db(1),h.Qc(" ",n.formErrors.title," ")}}function Oe(e,t){if(1&e&&(h.Wb(0,"option",61),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Pc(n.title)}}function We(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"div",16),h.Wb(2,"div",17),h.Wb(3,"div",22),h.Wb(4,"label",62),h.Oc(5),h.lc(6,"translate"),h.Vb(),h.Wb(7,"input",63),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvSeparator=e})),h.Vb(),h.Vb(),h.Vb(),h.Wb(8,"div",17),h.Wb(9,"div",22),h.Wb(10,"label",64),h.Oc(11),h.lc(12,"translate"),h.Vb(),h.Wb(13,"input",65),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvEncoding=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(14,"div",16),h.Wb(15,"div",17),h.Wb(16,"div",22),h.Wb(17,"label",66),h.Oc(18),h.lc(19,"translate"),h.Vb(),h.Wb(20,"input",67),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc().model.options.csvEnclosure=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=h.kc();h.Db(5),h.Pc(h.mc(6,6,"CSV_SEPARATOR")),h.Db(2),h.rc("ngModel",i.model.options.csvSeparator),h.Db(4),h.Pc(h.mc(12,8,"CSV_ENCODING")),h.Db(2),h.rc("ngModel",i.model.options.csvEncoding),h.Db(5),h.Pc(h.mc(19,10,"CSV_ENCLOSURE")),h.Db(2),h.rc("ngModel",i.model.options.csvEnclosure)}}function ke(e,t){if(1&e&&(h.Ub(0),h.Wb(1,"a",68),h.Rb(2,"i",69),h.Oc(3),h.lc(4,"translate"),h.Vb(),h.Tb()),2&e){var n=h.kc();h.Db(1),h.uc("href","",n.baseUrl,"/admin/files/download/",n.model.fileData.fileId,"",h.Gc),h.Db(2),h.Qc(" ",h.mc(4,3,"DOWNLOAD")," ")}}function Ce(e,t){if(1&e&&(h.Wb(0,"option",61),h.Oc(1),h.Vb()),2&e){var n=t.$implicit;h.rc("value",n.name),h.Db(1),h.Qc(" ",n.title," ")}}function Ee(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"select",74),h.ic("ngModelChange",(function(e){return h.Ec(n),h.kc(2).$implicit.targetName=e}))("ngModelChange",(function(e){h.Ec(n);var t=h.kc(2).$implicit;return h.kc().onChangeFieldName(t,e)})),h.Wb(2,"option",82),h.Oc(3),h.lc(4,"translate"),h.Vb(),h.Mc(5,Ce,2,2,"option",33),h.Vb(),h.Tb()}if(2&e){var i=h.kc(2).$implicit,o=h.kc();h.Db(1),h.rc("ngModel",i.targetName),h.Db(2),h.Pc(h.mc(4,3,"ID")),h.Db(2),h.rc("ngForOf",o.contentType.fields)}}function Me(e,t){if(1&e&&(h.Ub(0),h.Wb(1,"div",81),h.Mc(2,Ee,6,5,"ng-container",40),h.Vb(),h.Tb()),2&e){var n=h.kc(2);h.Db(2),h.rc("ngIf",n.contentType)}}function Se(e,t){if(1&e){var n=h.Xb();h.Ub(0),h.Wb(1,"tr"),h.Wb(2,"td"),h.Wb(3,"div",16),h.Wb(4,"div",70),h.Oc(5),h.Vb(),h.Wb(6,"div",71),h.Wb(7,"div",72),h.Wb(8,"div",73),h.Wb(9,"select",74),h.ic("ngModelChange",(function(e){return h.Ec(n),t.$implicit.targetAction=e}))("ngModelChange",(function(e){h.Ec(n);var i=t.$implicit,o=t.index;return h.kc().onChangeFieldAction(i,o,e)})),h.Wb(10,"option",75),h.Oc(11),h.lc(12,"translate"),h.Vb(),h.Wb(13,"option",76),h.Oc(14),h.lc(15,"translate"),h.Vb(),h.Wb(16,"option",77),h.Oc(17),h.lc(18,"translate"),h.Vb(),h.Wb(19,"option",78),h.Oc(20),h.lc(21,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Ub(22,79),h.Mc(23,Me,3,1,"ng-container",80),h.Tb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Tb()}if(2&e){var i=t.$implicit,o=t.index,r=h.kc();h.Db(5),h.Qc(" \u041a\u043e\u043b\u043e\u043d\u043a\u0430 #",o+1," "),h.Db(3),h.rc("ngClass",r.getFieldsColumnClass(i)),h.Db(1),h.rc("ngModel",i.targetAction),h.Db(2),h.Pc(h.mc(12,9,"CATEGORY")),h.Db(3),h.Pc(h.mc(15,11,"CATEGORIES_WITH_SEPARATOR")),h.Db(3),h.Pc(h.mc(18,13,"SELECT_FIELD")),h.Db(3),h.Qc("\xd7 ",h.mc(21,15,"DELETE"),""),h.Db(2),h.rc("ngSwitch",i.targetAction),h.Db(1),h.rc("ngSwitchCase","field")}}function Te(e,t){if(1&e){var n=h.Xb();h.Wb(0,"div",83),h.Wb(1,"button",84),h.ic("click",(function(){return h.Ec(n),h.kc().errorMessage=""})),h.Wb(2,"span",85),h.Oc(3,"\xd7"),h.Vb(),h.Vb(),h.Oc(4),h.Vb()}if(2&e){var i=h.kc();h.Db(4),h.Qc(" ",i.errorMessage," ")}}function Re(e,t){if(1&e&&(h.Wb(0,"span"),h.Oc(1),h.Vb()),2&e){var n=h.kc(2);h.Db(1),h.Qc("",n.percent,"%")}}function Ie(e,t){if(1&e&&(h.Ub(0),h.Wb(1,"div",86),h.Wb(2,"ngb-progressbar",87),h.Mc(3,Re,2,1,"span",40),h.Vb(),h.Vb(),h.Tb()),2&e){var n=h.kc();h.Db(2),h.rc("value",n.percent)("animated",!0)("striped",!0),h.Db(1),h.rc("ngIf",n.percent>10)}}var we,_e,Pe,Ne,Le=((_e=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,a,l,c,s,b,d,u){var p;return _classCallCheck(this,n),(p=t.call(this,e,i,o,r,a,l,c)).fb=e,p.dataService=i,p.systemNameService=o,p.activeModal=r,p.tooltipConfig=a,p.translateService=l,p.elRef=c,p.modalService=s,p.settingsService=b,p.contentTypeService=d,p.appSettings=u,p.model=new ye(0,""),p.modalTitle="Export",p.loadingConfiguration=!1,p.isInitialised=!1,p.sheetHeaders=[],p.contentTypes=[],p.percent=0,p.showProgressBar=!1,p.baseUrl="",p.formFields={title:{fieldLabel:"TITLE",value:"",validators:[y.w.required],messages:{}},parentId:{fieldLabel:"PARENT_FOLDER",value:"",dataKey:"options",validators:[],messages:{}},type:{fieldLabel:"FORMAT",value:"xls",validators:[],messages:{}},contentType:{fieldLabel:"CONTENT_TYPE",value:"",dataKey:"options",validators:[],messages:{}}},p}return _createClass(n,[{key:"onBeforeInit",value:function(){this.model&&!this.model.options&&(this.model.options={}),this.model&&!this.model.fieldsOptions&&(this.model.fieldsOptions=[]),this.baseUrl=this.appSettings.settings.webApiUrl}},{key:"onAfterInit",value:function(){this.getContentTypesList()}},{key:"getContentTypesList",value:function(){this.contentTypes$=this.contentTypeService.getListPage().pipe(Object(D.a)((function(e){return e.items})))}},{key:"getContentType",value:function(e){var t=this;e||(e=this.model.options.contentType),e?(this.loading=!0,this.contentTypeService.getItemByName(e).subscribe((function(e){t.contentType=e,t.loading=!1}),(function(e){e.error&&(t.errorMessage=e.error),t.contentType=null,t.loading=!1}))):this.contentType=null}},{key:"updateFieldOptions",value:function(){var e=this;if(this.contentType){var t=Object(b.cloneDeep)(this.model.fieldsOptions);this.model.fieldsOptions=[],this.contentType.fields.forEach((function(n){var i=Object(b.findIndex)(t,{sourceName:n.name}),o=i>-1?t[i]:{};e.model.fieldsOptions.push({sourceTitle:o.sourceTitle||n.title,sourceName:o.sourceName||n.name,targetName:o.targetName||"",targetTitle:o.targetTitle||"",targetAction:o.targetAction||""})}))}}},{key:"getFieldsColumnClass",value:function(e){var t=["col-6 pr-2","col-4 pr-2"],n="col-12";return[["field"],[]].forEach((function(i,o){i.indexOf(e.targetAction)>-1&&(n=t[o])})),n}},{key:"onChangeFieldAction",value:function(e,t,n){switch(e.targetName="",e.targetTitle="",e.separator="",e.options=[],n){case"delete":this.model.fieldsOptions.splice(t,1);break;case"category":e.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f";break;case"categories_splitted":e.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}}},{key:"onChangeFieldName",value:function(e,t){if("_id"===t)e.targetTitle="ID";else{var n=Object(b.findIndex)(this.contentType.fields,{name:t});e.targetTitle=this.contentType.fields[n].title}}},{key:"fieldOptionsAdd",value:function(e){e&&e.preventDefault(),this.model.fieldsOptions.push({targetAction:"category",targetTitle:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"})}},{key:"startExport",value:function(e){var t=this;if(e&&e.preventDefault(),!this.loading){this.errorMessage="",this.loading=!0,this.percent=0;var n=0,i="",o={};this.dataService.exportDataProgress(this.model).subscribe({next:function(e){if(e instanceof f.h)t.updatePercent(100);else if(e instanceof f.d);else if(e.type===f.c.DownloadProgress){var r=(i=e.partialText.substr(n).trim()).split("\n");i=r[r.length-1],n=e.partialText.length,"{"===i.substr(0,1)&&"}"===i.substr(i.length-1,1)&&(o=JSON.parse(i),t.updatePercent((o.currentIndex-o.rowNumberFirst)/(o.rowNumberLast-o.rowNumberFirst)*100))}},error:function(e){e.error&&e.error.indexOf("{")>-1&&(e.error=JSON.parse(e.error),e.error=e.error.error||t.getLangString("ERROR")),e.error&&(t.errorMessage=e.error),t.loading=!1,t.showProgressBar=!1}})}}},{key:"updatePercent",value:function(e){var t=this;this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout((function(){t.showProgressBar=!1,t.loading=!1,t.getModelData()}),1e3)}}]),n}(V.a)).\u0275fac=function(e){return new(e||_e)(h.Qb(y.e),h.Qb(De),h.Qb(c.a),h.Qb(M.b),h.Qb(M.v),h.Qb(S.d),h.Qb(h.l),h.Qb(M.h),h.Qb(l.a),h.Qb(C.a),h.Qb(W.a))},_e.\u0275cmp=h.Kb({type:_e,selectors:[["app-modal-export"]],inputs:{model:"model"},features:[h.Cb([De]),h.Ab],decls:116,vars:79,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],[1,"label-filled"],["name","parentId","formControlName","parentId",3,"ngModel","ngModelChange"],["for","fieldType",1,"label-filled"],["id","fieldType","name","type","formControlName","type",1,"custom-select",3,"ngModel","ngModelChange"],["value","xls"],["value","xlsx"],["value","csv"],["for","fieldContentType",1,"label-filled"],["id","fieldContentType","name","contentType","formControlName","contentType",1,"custom-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","fieldCategoryType",1,"label-filled"],["id","fieldCategoryType",1,"custom-select",3,"ngModel","ngModelChange"],["value","column"],["value","row"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"float-right"],["type","button",1,"btn","btn-primary","btn-wide",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"text-center"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[3,"value"],["for","fieldCSVSeparator",1,"label-filled"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["target","_blank",1,"btn","btn-success",3,"href"],[1,"icon-download"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],[1,"custom-select",3,"ngModel","ngModelChange"],["value","category"],["value","categories_splitted"],["value","field"],["value","delete"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","pl-2"],["value","_id"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Wb(1,"div",1),h.Wb(2,"button",2),h.ic("click",(function(e){return t.closeModal(e)})),h.Rb(3,"i",3),h.Wb(4,"span"),h.Oc(5),h.lc(6,"translate"),h.Vb(),h.Vb(),h.Wb(7,"button",2),h.ic("click",(function(e){return t.minimize(e)})),h.Rb(8,"i",4),h.Wb(9,"span"),h.Oc(10),h.lc(11,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"div",5),h.Wb(13,"div",6),h.Wb(14,"div",7),h.Wb(15,"button",8),h.ic("click",(function(e){return t.maximize(e)})),h.lc(16,"translate"),h.Rb(17,"i",9),h.Vb(),h.Wb(18,"button",10),h.ic("click",(function(e){return t.closeModal(e)})),h.lc(19,"translate"),h.Rb(20,"i",11),h.Vb(),h.Vb(),h.Vb(),h.Wb(21,"h4",12),h.Oc(22),h.Vb(),h.Vb(),h.Wb(23,"div",13),h.Wb(24,"form",14,15),h.Wb(26,"div",16),h.Wb(27,"div",17),h.Wb(28,"div",18),h.Wb(29,"label",19),h.Oc(30),h.lc(31,"translate"),h.Vb(),h.Wb(32,"input",20),h.ic("ngModelChange",(function(e){return t.model.title=e})),h.Vb(),h.Mc(33,Ve,2,1,"div",21),h.Vb(),h.Vb(),h.Wb(34,"div",17),h.Wb(35,"div",22),h.Wb(36,"label",23),h.Oc(37),h.lc(38,"translate"),h.Vb(),h.Wb(39,"app-select-parent-dropdown",24),h.ic("ngModelChange",(function(e){return t.model.options.parentId=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(40,"div",16),h.Wb(41,"div",17),h.Wb(42,"div",22),h.Wb(43,"label",25),h.Oc(44),h.lc(45,"translate"),h.Vb(),h.Wb(46,"select",26),h.ic("ngModelChange",(function(e){return t.model.type=e})),h.Wb(47,"option",27),h.Oc(48,"XLS"),h.Vb(),h.Wb(49,"option",28),h.Oc(50,"XLSX"),h.Vb(),h.Wb(51,"option",29),h.Oc(52,"CSV"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(53,"div",17),h.Wb(54,"div",22),h.Wb(55,"label",30),h.Oc(56),h.lc(57,"translate"),h.Vb(),h.Wb(58,"select",31),h.ic("ngModelChange",(function(e){return t.model.options.contentType=e}))("ngModelChange",(function(e){return t.getContentType(e)})),h.Rb(59,"option",32),h.Mc(60,Oe,2,2,"option",33),h.lc(61,"async"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(62,"div",16),h.Wb(63,"div",17),h.Wb(64,"div",22),h.Wb(65,"label",34),h.Oc(66),h.lc(67,"translate"),h.Vb(),h.Wb(68,"select",35),h.ic("ngModelChange",(function(e){return t.model.options.categoryType=e})),h.Wb(69,"option",36),h.Oc(70),h.lc(71,"translate"),h.Vb(),h.Wb(72,"option",37),h.Oc(73),h.lc(74,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(75,"div",17),h.Wb(76,"div",22),h.Wb(77,"label",38),h.Oc(78),h.lc(79,"translate"),h.Vb(),h.Wb(80,"input",39),h.ic("ngModelChange",(function(e){return t.model.options.categoriesSeparator=e})),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Mc(81,We,21,12,"ng-container",40),h.Wb(82,"div",41),h.Wb(83,"div",42),h.Wb(84,"div",43),h.Wb(85,"button",44),h.ic("click",(function(e){return t.startExport(e)})),h.Oc(86),h.lc(87,"translate"),h.Vb(),h.Vb(),h.Mc(88,ke,5,5,"ng-container",40),h.Vb(),h.Wb(89,"div",45),h.Wb(90,"div",46),h.Wb(91,"table",47),h.Mc(92,Se,24,17,"ng-container",48),h.Wb(93,"tr"),h.Wb(94,"td",49),h.Wb(95,"button",50),h.ic("click",(function(e){return t.fieldOptionsAdd(e)})),h.Oc(96),h.lc(97,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Mc(98,Te,5,1,"div",51),h.Mc(99,Ie,4,4,"ng-container",40),h.Vb(),h.Wb(100,"div",52),h.Wb(101,"div",53),h.Wb(102,"button",54),h.ic("click",(function(e){return t.save(!0,e)})),h.Wb(103,"span"),h.Oc(104),h.lc(105,"translate"),h.Vb(),h.Vb(),h.Wb(106,"div",55),h.Rb(107,"button",56),h.Wb(108,"div",57),h.Wb(109,"button",58),h.ic("click",(function(e){return t.save(!1,e)})),h.Oc(110),h.lc(111,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(112,"button",59),h.ic("click",(function(e){return t.closeModal(e)})),h.Wb(113,"span"),h.Oc(114),h.lc(115,"translate"),h.Vb(),h.Vb(),h.Vb()),2&e&&(h.Db(2),h.rc("disabled",t.submitted),h.Db(3),h.Pc(h.mc(6,43,"CLOSE")),h.Db(2),h.rc("disabled",t.submitted),h.Db(3),h.Pc(h.mc(11,45,"MINIMIZE")),h.Db(5),h.rc("title",h.mc(16,47,"EXPAND")),h.Db(3),h.rc("title",h.mc(19,49,"CLOSE")),h.Db(3),h.rc("title",t.modalTitle),h.Db(1),h.Pc(t.modalTitle),h.Db(1),h.Ib("loading",t.loading),h.Db(1),h.rc("formGroup",t.form),h.Db(6),h.Pc(h.mc(31,51,"TITLE")),h.Db(2),h.Ib("is-invalid",t.formErrors.title),h.rc("ngModel",t.model.title),h.Db(1),h.rc("ngIf",t.formErrors.title),h.Db(4),h.Pc(h.mc(38,53,"PARENT_FOLDER")),h.Db(2),h.rc("ngModel",t.model.options.parentId),h.Db(5),h.Pc(h.mc(45,55,"FORMAT")),h.Db(2),h.rc("ngModel",t.model.type),h.Db(10),h.Pc(h.mc(57,57,"CONTENT_TYPE")),h.Db(2),h.rc("ngModel",t.model.options.contentType),h.Db(2),h.rc("ngForOf",h.mc(61,59,t.contentTypes$)),h.Db(6),h.Pc(h.mc(67,61,"SAVE_CATEGORIES_TYPE")),h.Db(2),h.rc("ngModel",t.model.options.categoryType),h.Db(2),h.Pc(h.mc(71,63,"COLUMNS")),h.Db(3),h.Pc(h.mc(74,65,"ROWS")),h.Db(5),h.Pc(h.mc(79,67,"SEPARATOR_CATEGORIES")),h.Db(2),h.rc("ngModel",t.model.options.categoriesSeparator),h.Db(1),h.rc("ngIf","csv"==t.model.type),h.Db(4),h.rc("disabled",0==t.model.fieldsOptions.length),h.Db(1),h.Qc(" ",h.mc(87,69,"EXPORT")," "),h.Db(2),h.rc("ngIf",t.model.fileData),h.Db(4),h.rc("ngForOf",t.model.fieldsOptions),h.Db(4),h.Qc(" ",h.mc(97,71,"ADD")," "),h.Db(2),h.rc("ngIf",t.errorMessage),h.Db(1),h.rc("ngIf",t.showProgressBar),h.Db(3),h.rc("disabled",t.submitted&&t.form.valid),h.Db(2),h.Pc(h.mc(105,73,"SAVE_AND_CLOSE")),h.Db(3),h.rc("disabled",t.submitted&&t.form.valid),h.Db(3),h.Pc(h.mc(111,75,"SAVE")),h.Db(2),h.rc("disabled",t.submitted||t.loading),h.Db(2),h.Pc(h.mc(115,77,"CLOSE")))},directives:[y.y,y.o,y.h,y.b,y.n,y.g,o.p,R.a,y.v,y.r,y.x,o.o,y.q,M.d,M.g,M.f,M.e,o.n,o.r,o.s,M.n],pipes:[S.c,o.b],encapsulation:2}),_e),Ae=((we=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,a){var l;return _classCallCheck(this,n),(l=t.call(this,e,i,o,r)).dataService=e,l.activeModal=i,l.modalService=o,l.translateService=r,l.messageService=a,l.queryOptions=new p.a("id","desc",1,10,0,0),l.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}}],l}return _createClass(n,[{key:"getModalContent",value:function(){return Le}},{key:"getModalElementId",value:function(e){return["modal","import-config",e||0].join("-")}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_get(_getPrototypeOf(n.prototype),"setModalInputs",this).call(this,e,t,i),this.modalRef.componentInstance.modalTitle=void 0===e||t?this.getLangString("ADD_EXPORT_CONFIGURATION"):"".concat(this.getLangString("EDIT_EXPORT_CONFIGURATION")," #").concat(e)}}]),n}(u.a)).title="IMPORT_EXPORT",we.\u0275fac=function(e){return new(e||we)(h.Qb(De),h.Qb(M.b),h.Qb(M.h),h.Qb(S.d),h.Qb(d.b))},we.\u0275cmp=h.Kb({type:we,selectors:[["app-export"]],features:[h.Cb([De,d.b]),h.Ab],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Rb(1,"div",1),h.Wb(2,"div",2),h.Wb(3,"div",3),h.Wb(4,"button",4),h.Wb(5,"span"),h.Oc(6),h.lc(7,"translate"),h.Vb(),h.Vb(),h.Wb(8,"div",5),h.Wb(9,"button",6),h.ic("click",(function(){return t.deleteSelected()})),h.Oc(10),h.lc(11,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(12,"button",7),h.ic("click",(function(){return t.modalOpen()})),h.Rb(13,"i",8),h.Oc(14," \xa0 "),h.Wb(15,"span"),h.Oc(16),h.lc(17,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Rb(18,"div",9),h.Vb(),h.Wb(19,"app-table",10,11),h.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),h.Vb(),h.Rb(21,"p-toast",12)),2&e&&(h.Db(6),h.Pc(h.mc(7,9,"BATCH_ACTIONS")),h.Db(4),h.Pc(h.mc(11,11,"DELETE")),h.Db(6),h.Pc(h.mc(17,13,"ADD")),h.Db(3),h.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[M.d,M.g,M.f,ge.a,he.a],pipes:[S.c],styles:[""]}),we),Fe=function(){return["/import-export/export"]},xe=function(){return["/import-export/import"]},Qe=[{path:"",component:(Pe=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),Pe.title="IMPORT_EXPORT",Pe.\u0275fac=function(e){return new(e||Pe)},Pe.\u0275cmp=h.Kb({type:Pe,selectors:[["app-import-export"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ml-md-2",3,"routerLink"],[1,"icon-outbox"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-inbox"],[1,"card"],[1,"card-body"],[1,"float-md-left","mt-4","mt-md-0"],[1,"clearfix"],[1,"min-height400"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Wb(1,"div",1),h.Wb(2,"a",2),h.Rb(3,"i",3),h.Oc(4," \xa0 "),h.Wb(5,"span"),h.Oc(6),h.lc(7,"translate"),h.Vb(),h.Vb(),h.Wb(8,"a",4),h.Rb(9,"i",5),h.Oc(10," \xa0 "),h.Wb(11,"span"),h.Oc(12),h.lc(13,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Vb(),h.Wb(14,"div",6),h.Wb(15,"div",7),h.Wb(16,"div",8),h.Wb(17,"h3"),h.Rb(18,"i",3),h.Oc(19," \xa0 "),h.Wb(20,"span"),h.Oc(21),h.lc(22,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Rb(23,"div",9),h.Rb(24,"hr"),h.Wb(25,"div",10),h.Rb(26,"router-outlet"),h.Vb(),h.Vb(),h.Vb()),2&e&&(h.Db(2),h.rc("routerLink",h.vc(11,Fe)),h.Db(4),h.Pc(h.mc(7,5,"EXPORT")),h.Db(2),h.rc("routerLink",h.vc(12,xe)),h.Db(4),h.Pc(h.mc(13,7,"IMPORT")),h.Db(9),h.Pc(h.mc(22,9,"IMPORT_EXPORT")))},directives:[s.e,s.d,s.g],pipes:[S.c],encapsulation:2}),Pe),children:[{path:"",redirectTo:"import"},{path:"import",component:ve},{path:"export",component:Ae}]}],Ue=((Ne=function e(){_classCallCheck(this,e)}).\u0275mod=h.Ob({type:Ne}),Ne.\u0275inj=h.Nb({factory:function(e){return new(e||Ne)},imports:[[s.f.forChild(Qe)],s.f]}),Ne);n.d(t,"ImportExportModule",(function(){return $e}));var qe,$e=((qe=function e(){_classCallCheck(this,e)}).\u0275mod=h.Ob({type:qe}),qe.\u0275inj=h.Nb({factory:function(e){return new(e||qe)},providers:[l.a,c.a,v,De,a.a],imports:[[o.c,r.a,Ue]]}),qe)},b1TM:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("tk/3"),o=n("LRne"),r=n("JIr8"),a=(n("8Eda"),n("fXoL")),l=function(){var e=function(){function e(t){_classCallCheck(this,e),this.http=t,this.headers=new i.e({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="",this.requestUrl="/admin/settings"}return _createClass(e,[{key:"setRequestUrl",value:function(e){this.requestUrl=e}},{key:"getRequestUrl",value:function(){return this.requestUrl}},{key:"getList",value:function(){return this.http.get(this.getRequestUrl()).pipe(Object(r.a)(this.handleError()))}},{key:"clearSystemCache",value:function(){var e=this.getRequestUrl()+"/clear_system_cache";return this.http.post(e,{},{headers:this.headers}).pipe(Object(r.a)(this.handleError()))}},{key:"runActionPost",value:function(e){var t=this.getRequestUrl()+"/"+e;return this.http.post(t,{},{headers:this.headers}).pipe(Object(r.a)(this.handleError()))}},{key:"updateGroup",value:function(e,t){var n=this.getRequestUrl()+"/"+e;return this.http.put(n,t,{headers:this.headers}).pipe(Object(r.a)(this.handleError()))}},{key:"getComposerPackagesList",value:function(){return this.http.get(this.getRequestUrl()+"_composer_installed_packages").pipe(Object(r.a)(this.handleError()))}},{key:"composerRequirePackage",value:function(e,t){var n=this.getRequestUrl()+"_composer_require_package";return this.http.post(n,{packageName:e,packageVersion:t},{headers:this.headers}).pipe(Object(r.a)(this.handleError()))}},{key:"handleError",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1?arguments[1]:void 0;return function(t){if(t.error)throw t.error;return Object(o.a)(e)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.ec(i.a))},e.\u0275prov=a.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},bbPC:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("3Pt+"),o=n("XNiG"),r=n("1G5W"),a=n("pvw1"),l=n("fXoL"),c=n("7AsP"),s=n("qbpQ"),b=n("1kSV"),d=n("sYmb"),u=function(){var e=function(){function e(t,n,i,r,a,l,c){_classCallCheck(this,e),this.fb=t,this.dataService=n,this.systemNameService=i,this.activeModal=r,this.tooltipConfig=a,this.translateService=l,this.elRef=c,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new o.a,a.placement="bottom",a.container="body",a.triggers="hover click"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then((function(){e.onAfterGetData()})):this.onAfterGetData(),this.onAfterInit()}},{key:"onBeforeInit",value:function(){}},{key:"onAfterInit",value:function(){}},{key:"onAfterGetData",value:function(){}},{key:"getSystemFieldName",value:function(){return"name"}},{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"getModelData",value:function(){var e=this;return this.loading=!0,new Promise((function(t,n){e.dataService.getItem(e.itemId).pipe(Object(r.a)(e.destroyed$)).subscribe({next:function(n){e.isItemCopy&&(n.id=null,n[e.getSystemFieldName()]=""),e.model=n,e.loading=!1,t(n)},error:function(t){e.errorMessage=t.error||e.getLangString("ERROR"),e.loading=!1,n(t)}})}))}},{key:"buildForm",value:function(){var e=this,t=this.buildControls(this.formFields,"model");this.form=this.fb.group(t),this.form.valueChanges.pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(t){return e.onValueChanged("form","",t)}})}},{key:"buildControls",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o={};for(var r in e)if(e.hasOwnProperty(r)){var a=e[r],l=a.dataKey?this[t][a.dataKey]:this[t];l[r]||(l[r]=a.value),o[r]=new i.f({value:l[r]||"",disabled:a.disabled||!1},a.validators),this.formErrors[n+r]="",this.translateValidationMessages(n,r,a)}return o}},{key:"translateValidationMessages",value:function(e,t,n){var o=this,r={};n.fieldLabel&&(Object.keys(n.messages).forEach((function(e){"required"!==e&&o.translateService.get(String(n.messages[e])).subscribe((function(t){r[e]=t}))})),n.validators.indexOf(i.w.required)>-1&&this.translateService.get(n.fieldLabel).subscribe((function(e){o.translateService.get("FIELD_REQUIRED",{name:e}).subscribe((function(e){r.required=e}))})),this.validationMessages[e+t]=r)}},{key:"getControl",value:function(e){return this.form.controls.name}},{key:"onValueChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";arguments.length>2&&arguments[2];if(this[e]){var n=this[e].value;for(var i in n)if(n.hasOwnProperty(i)){this.formErrors[t+i]="";var o=this[e].get(i);if(o&&(o.dirty||this[t+"submitted"])&&!o.valid)for(var r in o.errors)this.formErrors[t+i]+=this.validationMessages[t+i][r]?this.validationMessages[t+i][r]+" ":this.getLangString("ERROR")+" "}}}},{key:"displayToggle",value:function(e,t){e.style.display=(t=t||"none"===e.style.display)?"block":"none"}},{key:"toggleAccordion",value:function(e,t,n){e.activeIds.indexOf(t)>-1&&n||e.toggle(t)}},{key:"generateName",value:function(e){e.name=this.systemNameService.generateName(e.title||"")}},{key:"closeModal",value:function(e){e&&e.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}},{key:"close",value:function(e){e&&e.preventDefault(),this.activeModal.dismiss(this.closeReason)}},{key:"minimize",value:function(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),n.classList.add("d-none")}},{key:"maximize",value:function(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),n.classList.remove("d-none")}},{key:"getFormData",value:function(){var e=this,t={};return Object.keys(this.model).forEach((function(n){t[n]=e.files[n]?Array.isArray(e.model[n])?[a.a.getFileData(e.files[n])]:a.a.getFileData(e.files[n]):e.model[n]})),t}},{key:"fileChange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.target.files;i.length>0&&(this.model[t]=n?[a.a.getFileData(i[0])]:a.a.getFileData(i[0]),this.files[t]=i[0],this.form.controls[t].setValue(this.files[t].name))}},{key:"fileClear",value:function(e,t){this.model[e]=null,this.form.controls[e].reset(null),t.files=null,t.value="",delete this.files[e]}},{key:"onLocaleSwitch",value:function(){var e=this;if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach((function(t){e.model[t]=e.localePreviousValues[t]})),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach((function(t){e.localePreviousValues[t]=e.model[t]||"",e.model[t]=e.model.translations[t]&&e.model.translations[t][e.localeCurrent]||""}))}},{key:"saveTranslations",value:function(e){var t=this;e&&e.preventDefault(),this.localeFieldsAllowed.forEach((function(e){t.model[e]?(t.model.translations[e]||(t.model.translations[e]={}),t.model.translations[e][t.localeCurrent]=t.model[e]):t.model.translations[e]&&(t.model.translations[e][t.localeCurrent]&&delete t.model.translations[e][t.localeCurrent],0===Object.keys(t.model.translations[e]).length&&delete t.model.translations[e])})),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}},{key:"saveRequest",value:function(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}},{key:"onSubmit",value:function(){this.submitted=!0,this.closeModal()}},{key:"appendFormData",value:function(e){}},{key:"saveFiles",value:function(e){var t=this;if(0!==Object.keys(this.files).length){var n=new FormData;for(var i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&n.append(i,this.files[i],this.files[i].name);n.append("itemId",String(e)),this.appendFormData(n),this.dataService.postFormData(n).pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(){t.closeModal()},error:function(e){t.errorMessage=e.error||t.getLangString("ERROR"),t.submitted=!1,t.loading=!1}})}else this.closeModal()}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(n&&n.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(n){Object.keys(e.files).length>0?e.saveFiles(n._id||n.id):(t?e.closeModal():n&&n.id&&(e.model=n,e.onAfterGetData(),e.isEditMode=!0),e.closeReason="updated",e.loading=!1,e.submitted=!1)},error:function(t){e.errorMessage=t.error||e.getLangString("ERROR"),e.loading=!1,e.submitted=!1}})}},{key:"emailValidator",value:function(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}},{key:"getRootElement",value:function(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}},{key:"createUniqueId",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l.Qb(i.e),l.Qb(c.a),l.Qb(s.a),l.Qb(b.b),l.Qb(b.v),l.Qb(d.d),l.Qb(l.l))},e.\u0275dir=l.Lb({type:e,inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"}}),e}()}}]);