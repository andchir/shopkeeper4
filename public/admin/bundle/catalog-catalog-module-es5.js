function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=_superPropBase(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"4p3S":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("XNiG"),o=n("1G5W"),r=n("RwQR"),l=n("Y2tp"),a=n("fXoL"),c=n("7AsP"),s=n("1kSV"),d=n("sYmb"),b=["table"],u=function(){var e=function(){function e(t,n,o,l){_classCallCheck(this,e),this.dataService=t,this.activeModal=n,this.modalService=o,this.translateService=l,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new r.a("name","asc",1,10,0,0),this.destroyed$=new i.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.getList(),this.afterInit()}},{key:"afterInit",value:function(){}},{key:"onSearchClear",value:function(){this.getList()}},{key:"onModalClose",value:function(e){}},{key:"onSearchWordUpdate",value:function(e){var t=this;if(void 0!==e)return this.queryOptions.search_word=e,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){t.queryOptions.page=1,t.getList()}),700)}},{key:"getModalElementId",value:function(e){return["modal",e||0].join("-")}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(i?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=n,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=i}},{key:"modalOpen",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){var o=window.document.getElementById(i),r=o.previousElementSibling;return o.classList.add("d-block"),o.classList.remove("modal-minimized"),void r.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(e,n,i),this.modalRef.result.then((function(e){t.destroyed$.isStopped||(t.onModalClose(e),t.getList())}),(function(e){t.destroyed$.isStopped||(t.onModalClose(e),e&&["submit","updated"].indexOf(e)>-1&&t.getList())}))}},{key:"deleteItemConfirm",value:function(e){var t=this;this.modalRef=this.modalService.open(l.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then((function(n){"accept"===n&&t.deleteItem(e)}))}},{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"confirmAction",value:function(e){return this.modalRef=this.modalService.open(l.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}},{key:"blockSelected",value:function(){var e=this;0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe((function(t){e.clearSelected(),e.getList()}),(function(t){return e.showAlert(t.error||e.getLangString("ERROR"))})):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}},{key:"deleteSelected",value:function(){var e=this;0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then((function(t){"accept"===t&&e.dataService.actionBatch(e.selectedIds,"delete").subscribe((function(t){e.clearSelected(),e.getList()}),(function(t){return e.showAlert(t.error||e.getLangString("ERROR"))}))})):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}},{key:"showAlert",value:function(e){this.modalRef=this.modalService.open(l.a),this.modalRef.componentInstance.modalContent=e,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}},{key:"deleteItem",value:function(e){var t=this;this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then((function(n){"accept"===n&&t.dataService.deleteItem(e).subscribe((function(e){t.getList()}),(function(e){e.error&&t.showAlert(e.error)}))}))}},{key:"clearSelected",value:function(){this.table&&this.table.clearSelected()}},{key:"actionRequest",value:function(e){switch(e[0]){case"edit":this.modalOpen(e[1]);break;case"copy":this.modalOpen(e[1],!0);break;case"delete":this.deleteItem(e[1]);break;case"changeQuery":this.getList()}}},{key:"getList",value:function(){var e=this;this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe(Object(o.a)(this.destroyed$)).subscribe({next:function(t){e.items=t.items,e.collectionSize=t.total,e.loading=!1},error:function(t){e.items=[],e.collectionSize=0,t.error&&e.showAlert(t.error),e.loading=!1}})}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}}]),e}();return e.title="",e.\u0275fac=function(t){return new(t||e)(a.Qb(c.a),a.Qb(s.b),a.Qb(s.h),a.Qb(d.d))},e.\u0275dir=a.Lb({type:e,viewQuery:function(e,t){var n;1&e&&a.Jc(b,!0),2&e&&a.Cc(n=a.jc())&&(t.table=n.first)}}),e}()},"6J3s":function(e,t,n){"use strict";n.r(t);var i,o,r,l=n("ofXK"),a=n("d2mR"),c=n("tyNb"),s=n("fXoL"),d=n("sYmb"),b=function(){return["field_types"]},u=function(){return["content_types"]},m=((i=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).title="CATALOG",i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Kb({type:i,selectors:[["app-catalog"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ml-md-2",3,"routerLink"],[1,"icon-toggle"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-box"],[1,"card"],[1,"card-body"],[1,"float-md-left","mt-4","mt-md-0"],[1,"icon-layers"],[1,"clearfix"],[1,"min-height400"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"a",2),s.Rb(3,"i",3),s.Oc(4," \xa0 "),s.Wb(5,"span"),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Vb(),s.Wb(8,"a",4),s.Rb(9,"i",5),s.Oc(10," \xa0 "),s.Wb(11,"span"),s.Oc(12),s.lc(13,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(14,"div",6),s.Wb(15,"div",7),s.Wb(16,"div",8),s.Wb(17,"h3"),s.Rb(18,"i",9),s.Oc(19," \xa0 "),s.Wb(20,"span"),s.Oc(21),s.lc(22,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Rb(23,"div",10),s.Rb(24,"hr"),s.Wb(25,"div",11),s.Rb(26,"router-outlet"),s.Vb(),s.Vb(),s.Vb()),2&e&&(s.Db(2),s.rc("routerLink",s.vc(11,b)),s.Db(4),s.Pc(s.mc(7,5,"FIELD_TYPES")),s.Db(2),s.rc("routerLink",s.vc(12,u)),s.Db(4),s.Pc(s.mc(13,7,"CONTENT_TYPES")),s.Db(9),s.Pc(s.mc(22,9,"CATALOG")))},directives:[c.e,c.d,c.g],pipes:[d.c],encapsulation:2}),i),f=n("LvDl"),p=function(){function e(t,n,i,o,r,l,a,c,s,d,b,u){_classCallCheck(this,e),this.id=t,this.isFolder=n,this.parentId=i,this.name=o,this.title=r,this.description=l,this.contentTypeName=a,this.isActive=c,this.clearCache=s,this.menuIndex=d,this.translations=b,this.image=u,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}return _createClass(e,null,[{key:"createTree",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length)return null;if(!n){var o=Object(f.findIndex)(t,{name:"root"});n=o>-1?e.toTreeNode(t[o],i):{id:0,parentId:0,label:"",expanded:!0,children:[]}}n.children=[];var r=t.filter((function(e){return 0!==e.id&&e.parentId===n.id}));return r.length>0&&(r.forEach((function(t){n.children.push(e.toTreeNode(t,i))})),n.children.forEach((function(n){e.createTree(t,n,i)}))),0===n.children.length&&(n.children=null),n}},{key:"getCurrentNode",value:function(t,n){if(!n)return null;if(n.id===t)return n;if(n.children){for(var i=null,o=0;null==i&&o<n.children.length;o++)i=e.getCurrentNode(t,n.children[o]);return i}return null}},{key:"toTreeNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id,label:e.title,parentId:e.parentId||0,expanded:t}}}]),e}(),h=n("4p3S"),g=n("3Pt+"),v=function(){function e(t,n,i,o,r,l,a,c){_classCallCheck(this,e),this.id=t,this.name=n,this.title=i,this.description=o,this.collection=r,this.fields=l,this.groups=a,this.isActive=c}return _createClass(e,null,[{key:"getSystemFieldName",value:function(e){var t=Object(f.findIndex)(e.fields,{inputType:"system_name"});return t>-1?e.fields[t].name:"name"}},{key:"getFieldByName",value:function(e,t){var n=Object(f.findIndex)(e.fields,{name:t});return n>-1?e.fields[n]:null}}]),e}(),y=n("bbPC"),D=n("qbpQ"),C=n("e07I"),k=n("BWxc"),V=n("7AsP"),I=n("tk/3"),W=((r=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("/admin/products"),i}return n}(V.a)).\u0275fac=function(e){return new(e||r)(s.ec(I.a))},r.\u0275prov=s.Mb({token:r,factory:r.\u0275fac}),r),O=((o=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("/admin/files"),i}return n}(V.a)).\u0275fac=function(e){return new(e||o)(s.ec(I.a))},o.\u0275prov=s.Mb({token:o,factory:o.\u0275fac}),o),E=n("3UOJ"),T=n("wgQU"),M=n("1kSV"),S=n("Cp0g"),w=n("keWK");function R(e,t){if(1&e&&(s.Wb(0,"div",44),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.parentId," ")}}function _(e,t){if(1&e&&(s.Wb(0,"label",50),s.Rb(1,"input",51),s.Oc(2),s.Vb()),2&e){var n=t.$implicit;s.Db(1),s.rc("value",n),s.Db(1),s.Qc(" ",n," ")}}var L=function(){return{standalone:!0}};function P(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",45),s.Wb(1,"button",46),s.ic("click",(function(e){return s.Ec(n),s.kc().saveTranslations(e)})),s.lc(2,"translate"),s.Rb(3,"i",47),s.Vb(),s.Wb(4,"div",48),s.ic("ngModelChange",(function(e){return s.Ec(n),s.kc().localeCurrent=e}))("ngModelChange",(function(){return s.Ec(n),s.kc().onLocaleSwitch()})),s.Mc(5,_,3,2,"label",49),s.Vb(),s.Vb()}if(2&e){var i=s.kc();s.Db(1),s.sc("ngbTooltip",s.mc(2,5,"SAVE")),s.rc("hidden",i.localeCurrent==i.localeDefault),s.Db(3),s.rc("ngModel",i.localeCurrent)("ngModelOptions",s.vc(7,L)),s.Db(1),s.rc("ngForOf",i.localeList)}}var F,A=((F=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,l,a,c,s,d,b,u){var m;return _classCallCheck(this,n),(m=t.call(this,e,i,o,r,l,a,c)).fb=e,m.dataService=i,m.systemNameService=o,m.activeModal=r,m.tooltipConfig=l,m.translateService=a,m.elRef=c,m.contentTypesService=s,m.categoriesService=d,m.filesService=b,m.appSettings=u,m.categories=[],m.contentTypes=[],m.currentContentType=new v(0,"","","","",[],[],!0),m.model={},m.formFields={parentId:{value:0,validators:[g.w.required],messages:{required:"Category is required."}},isActive:{value:!0,validators:[],messages:{}},clearCache:{value:!0,validators:[],messages:{}}},m.model.id=0,m.model.parentId=0,m}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),this.model.clearCache=!0,this.model.parentId=this.category.id,this.dataService.setRequestUrl("/admin/products/"+this.category.id),this.buildForm(),this.getCategories(),this.getContentType().then((function(t){return e.itemId?e.getModelData():Promise.reject("")}),(function(t){return e.errorMessage=t.error||"Error.",Promise.reject("")})).then((function(t){e.onAfterGetData(),e.updateForm()}),(function(){e.onAfterGetData()}))}},{key:"onAfterGetData",value:function(){var e=this;this.currentContentType.fields.forEach((function(t){["text","textarea","rich_text"].indexOf(t.inputType)>-1&&e.localeFieldsAllowed.push(t.name)})),this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={})}},{key:"getSystemFieldName",value:function(){return v.getSystemFieldName(this.currentContentType)}},{key:"getCategories",value:function(){var e=this;this.loading=!0,this.categoriesService.getListPage().subscribe((function(t){e.categories=t.items,e.loading=!1}),(function(t){e.errorMessage=t.error||"Error."}))}},{key:"getContentType",value:function(){var e=this;return this.loading=!0,this.category.contentTypeName?new Promise((function(t,n){e.contentTypesService.getItemByName(e.category.contentTypeName).subscribe((function(n){e.currentContentType=n,e.errorMessage="",e.loading=!1,t(n)}),(function(t){e.errorMessage=t.error||"Error.",e.loading=!1,n(t)}))})):Promise.reject({error:"Content type name not found."})}},{key:"updateForm",value:function(e){var t=this;e||(e=Object(f.clone)(this.model));var n=Object(f.map)(this.currentContentType.fields,(function(e){return e.name}));for(var i in n.push("id","parentId","previousParentId","isActive","clearCache","translations"),e.clearCache=!0,Object.keys(this.model).forEach((function(e){if(e.indexOf("__")>-1){var i=E.a.getFieldBaseName(e);if(i===e)return;var o=E.a.getFieldIndexData(t.currentContentType.fields,i);if(-1===o.index)return;var r=Object(f.cloneDeep)(t.currentContentType.fields[o.index]);r.name=e,t.currentContentType.fields.splice(o.index+o.additFieldsCount+1,0,r),n.push(e)}})),this.form.controls)this.form.controls.hasOwnProperty(i)&&-1===n.indexOf(i)&&this.form.removeControl(i);this.model=Object(f.pick)(e,n)}},{key:"onChangeContentType",value:function(){var e=parseInt(String(this.model.parentId),10),t=Object(f.findIndex)(this.categories,{id:e});-1!==t&&(this.currentContentType&&this.currentContentType.name===this.categories[t].contentTypeName||(this.model.previousParentId=this.category.id,this.category=Object(f.cloneDeep)(this.categories[t]),this.getContentType()))}},{key:"saveFiles",value:function(e){var t=this;if(0!==Object.keys(this.files).length){var n=new FormData;for(var i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&n.append(i,this.files[i],this.files[i].name);n.append("itemId",String(e)),n.append("ownerType",this.currentContentType.name),n.append("categoryId",String(this.model.parentId)),n.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(n).subscribe((function(){t.closeModal()}),(function(e){t.errorMessage=e.error||"Error.",t.submitted=!1,t.loading=!1}))}else this.closeModal()}},{key:"getErrorsString",value:function(){var e=this,t=[];return Object.keys(this.form.controls).forEach((function(n){if(e.form.controls[n].invalid&&e.validationMessages[n]){var i,o=E.a.getFieldBaseName(n),r=v.getFieldByName(e.currentContentType,o);if(!r)return;i=e.formErrors[n]?e.formErrors[n]:r.title+" - error.",t.push(i)}})),t.join(" ")}},{key:"getFormData",value:function(){var e=Object(f.cloneDeep)(this.model);for(var t in e)e.hasOwnProperty(t)&&e[t]&&"object"==typeof e[t]&&e[t].dataUrl&&delete e[t].dataUrl;return e.fieldsSort=this.getFieldsSortData(),e}},{key:"getFieldsSortData",value:function(){var e=this,t=this.currentContentType.fields.map((function(e){return e.name}));return t=t.filter((function(t){if(!e.model[t]||-1===t.indexOf("__"))return!1;var n=t.split("__");return!isNaN(n[1])}))}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.submitted=!0,this.errorMessage=null,!this.form.valid)return this.onValueChanged("form"),this.errorMessage=this.getErrorsString(),void(this.submitted=!1);this.loading=!0,this.dataService.setRequestUrl("/admin/products/"+this.category.id),this.saveRequest().subscribe({next:function(n){Object.keys(e.files).length>0?e.saveFiles(n.id||n._id):(t?e.closeModal():n&&(n.id||n._id)&&(e.model=n,e.model.id=n.id||n._id,e.isEditMode=!0),e.closeReason="updated",e.loading=!1,e.submitted=!1)},error:function(t){e.errorMessage=t.error||"Error.",e.submitted=!1,e.loading=!1}})}}]),n}(y.a)).\u0275fac=function(e){return new(e||F)(s.Qb(g.e),s.Qb(W),s.Qb(D.a),s.Qb(M.b),s.Qb(M.v),s.Qb(d.d),s.Qb(s.l),s.Qb(k.a),s.Qb(C.a),s.Qb(O),s.Qb(T.a))},F.\u0275cmp=s.Kb({type:F,selectors:[["app-product-modal-content"]],inputs:{category:"category"},features:[s.Cb([W]),s.Ab],decls:71,vars:58,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],[3,"formGroup"],[1,"modal-body","py-0"],[1,"row","form-group","form-group-message"],[1,"col-md-5"],["for","fieldCategory"],[1,"col-md-7"],["name","parentId","formControlName","parentId",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-indicator"],[1,"custom-control-label",3,"for"],[1,"custom-control","custom-checkbox","mt-2"],["type","checkbox","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"min-height110"],[3,"fields","groups","formErrors","validationMessages","model","form","files","localeFieldsAllowed","isLocalizationActive","fieldsChange","groupsChange","formErrorsChange","validationMessagesChange","modelChange","formChange","filesChange"],[1,"alert","alert-danger","mt-3","mb-0",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"button",2),s.ic("click",(function(e){return t.closeModal(e)})),s.Rb(3,"i",3),s.Wb(4,"span"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Vb(),s.Wb(7,"button",2),s.ic("click",(function(e){return t.minimize(e)})),s.Rb(8,"i",4),s.Wb(9,"span"),s.Oc(10),s.lc(11,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(12,"div",5),s.Wb(13,"div",6),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(e){return t.maximize(e)})),s.lc(16,"translate"),s.Rb(17,"i",9),s.Vb(),s.Wb(18,"button",10),s.ic("click",(function(e){return t.closeModal(e)})),s.lc(19,"translate"),s.Rb(20,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"h4",12),s.Oc(22),s.Vb(),s.Vb(),s.Wb(23,"form",13),s.Wb(24,"div",14),s.Wb(25,"div",15),s.Wb(26,"div",16),s.Wb(27,"label",17),s.Oc(28),s.lc(29,"translate"),s.Vb(),s.Vb(),s.Wb(30,"div",18),s.Wb(31,"app-select-parent-dropdown",19),s.ic("ngModelChange",(function(e){return t.model.parentId=e}))("ngModelChange",(function(){return t.onChangeContentType()})),s.Vb(),s.Mc(32,R,2,1,"div",20),s.Vb(),s.Vb(),s.Wb(33,"div",21),s.Wb(34,"div",22),s.Wb(35,"div",23),s.Wb(36,"div",24),s.Wb(37,"input",25),s.ic("ngModelChange",(function(e){return t.model.isActive=e})),s.Vb(),s.Rb(38,"span",26),s.Wb(39,"label",27),s.Oc(40),s.lc(41,"translate"),s.Vb(),s.Vb(),s.Wb(42,"div",28),s.Wb(43,"input",29),s.ic("ngModelChange",(function(e){return t.model.clearCache=e})),s.Vb(),s.Wb(44,"label",27),s.Oc(45),s.lc(46,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(47,"div",30),s.Wb(48,"app-input-field-renderer",31),s.ic("fieldsChange",(function(e){return t.currentContentType.fields=e}))("groupsChange",(function(e){return t.currentContentType.groups=e}))("formErrorsChange",(function(e){return t.formErrors=e}))("validationMessagesChange",(function(e){return t.validationMessages=e}))("modelChange",(function(e){return t.model=e}))("formChange",(function(e){return t.form=e}))("filesChange",(function(e){return t.files=e})),s.Vb(),s.Vb(),s.Wb(49,"div",32),s.Wb(50,"button",33),s.ic("click",(function(){return t.errorMessage=""})),s.Wb(51,"span",34),s.Oc(52,"\xd7"),s.Vb(),s.Vb(),s.Oc(53),s.Vb(),s.Vb(),s.Wb(54,"div",35),s.Mc(55,P,6,8,"div",36),s.Wb(56,"div",37),s.Wb(57,"button",38),s.ic("click",(function(){return t.save(!0)})),s.Wb(58,"span"),s.Oc(59),s.lc(60,"translate"),s.Vb(),s.Vb(),s.Wb(61,"div",39),s.Rb(62,"button",40),s.Wb(63,"div",41),s.Wb(64,"button",42),s.ic("click",(function(){return t.save()})),s.Oc(65),s.lc(66,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(67,"button",43),s.ic("click",(function(e){return t.closeModal(e)})),s.Wb(68,"span"),s.Oc(69),s.lc(70,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb()),2&e&&(s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(6,38,"CLOSE")),s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(11,40,"MINIMIZE")),s.Db(5),s.rc("title",s.mc(16,42,"EXPAND")),s.Db(3),s.rc("title",s.mc(19,44,"CLOSE")),s.Db(4),s.Pc(t.modalTitle),s.Db(1),s.Ib("loading",t.loading),s.rc("formGroup",t.form),s.Db(5),s.Pc(s.mc(29,46,"PARENT_FOLDER")),s.Db(3),s.rc("ngModel",t.model.parentId),s.Db(1),s.rc("ngIf",t.formErrors.parentId),s.Db(5),s.tc("id","fieldIsActive",t.uniqueId,""),s.rc("ngModel",t.model.isActive),s.Db(2),s.tc("for","fieldIsActive",t.uniqueId,""),s.Db(1),s.Pc(s.mc(41,48,"ACTIVE")),s.Db(3),s.tc("id","fieldClearCache",t.uniqueId,""),s.rc("ngModel",t.model.clearCache),s.Db(1),s.tc("for","fieldClearCache",t.uniqueId,""),s.Db(1),s.Pc(s.mc(46,50,"CLEAR_FILE_CACHE")),s.Db(3),s.rc("fields",t.currentContentType.fields)("groups",t.currentContentType.groups)("formErrors",t.formErrors)("validationMessages",t.validationMessages)("model",t.model)("form",t.form)("files",t.files)("localeFieldsAllowed",t.localeFieldsAllowed)("isLocalizationActive",t.localeCurrent!==t.localeDefault),s.Db(1),s.rc("hidden",!t.errorMessage),s.Db(4),s.Qc(" ",t.errorMessage," "),s.Db(2),s.rc("ngIf",t.localeList.length>1),s.Db(2),s.rc("disabled",t.submitted||t.isSaveButtonDisabled),s.Db(2),s.Pc(s.mc(60,52,"SAVE_AND_CLOSE")),s.Db(3),s.rc("disabled",t.submitted||t.isSaveButtonDisabled),s.Db(3),s.Pc(s.mc(66,54,"SAVE")),s.Db(4),s.Pc(s.mc(70,56,"CLOSE")))},directives:[g.y,g.o,g.h,S.a,g.n,g.g,l.p,g.a,w.a,M.d,M.g,M.f,M.e,M.u,M.p,g.q,l.o,M.c,M.o],pipes:[d.c],encapsulation:2}),F),N=n("RwQR"),x=n("XNiG"),Q=n("1G5W");function q(e,t){if(1&e&&(s.Wb(0,"li"),s.Wb(1,"a",1),s.Oc(2),s.Vb(),s.Rb(3,"app-list-recursive",2),s.Vb()),2&e){var n=t.$implicit,i=s.kc();s.Db(2),s.Qc(" ",n.title," "),s.Db(1),s.rc("inputItems",i.inputItems)("parentId",n.id)("currentId",i.currentId)}}var j,G=((j=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.filterInputItems()}},{key:"ngOnChanges",value:function(e){e.inputItems&&this.filterInputItems(),e.currentId&&this.updateParentsIds()}},{key:"filterInputItems",value:function(){this.items=[];var e=this.items,t=this.parentId;this.inputItems.forEach((function(n){n.id!==n.parentId&&n.parentId===t&&e.push(n)})),this.updateParentsIds()}},{key:"updateParentsIds",value:function(){var e=this,t=this.inputItems.findIndex((function(t){return t.id===e.currentId}));this.currentParentsIds=[],-1!==t&&(this.currentParentsIds=this.getParentIds(this.inputItems[t].parentId))}},{key:"getParentIds",value:function(e,t){if(t=t||[],e>0){t.push(e);var n=Object(f.findIndex)(this.inputItems,{id:e});return-1===n?t:this.getParentIds(this.inputItems[n].parentId,t)}return t}},{key:"getIsActiveParent",value:function(e){return this.currentParentsIds.indexOf(e)>-1}}]),e}()).\u0275fac=function(e){return new(e||j)},j.\u0275cmp=s.Kb({type:j,selectors:[["app-list-recursive"]],inputs:{inputItems:"inputItems",items:"items",parentId:"parentId",currentId:"currentId"},features:[s.Bb],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"dropdown-item"],[3,"inputItems","parentId","currentId"]],template:function(e,t){1&e&&(s.Wb(0,"ul"),s.Mc(1,q,4,4,"li",0),s.Vb()),2&e&&(s.Db(1),s.rc("ngForOf",t.items))},directives:[l.o,j],encapsulation:2}),j),U=n("ot8b"),B=n("Y2tp"),z=n("c863"),Y=n("g9iH");function $(e,t){if(1&e&&(s.Wb(0,"div",57),s.Oc(1),s.Vb()),2&e){var n=s.kc(2);s.Db(1),s.Qc(" ",n.formErrors.parentId," ")}}function X(e,t){if(1&e&&(s.Wb(0,"div",23),s.Wb(1,"div",18),s.Wb(2,"label",35),s.Oc(3),s.lc(4,"translate"),s.Vb(),s.Vb(),s.Wb(5,"div",20),s.Rb(6,"app-select-parent-dropdown",56),s.Mc(7,$,2,1,"div",22),s.Vb(),s.Vb()),2&e){var n=s.kc();s.Db(3),s.Pc(s.mc(4,5,"PARENT_FOLDER")),s.Db(3),s.Ib("is-invalid",n.formErrors.parentId),s.rc("filterId",n.model.id),s.Db(1),s.rc("ngIf",n.formErrors.parentId)}}function K(e,t){if(1&e&&(s.Wb(0,"div",57),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.title," ")}}function H(e,t){if(1&e&&(s.Wb(0,"div",57),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.name," ")}}function J(e,t){if(1&e&&(s.Wb(0,"option",58),s.Oc(1),s.Vb()),2&e){var n=t.$implicit;s.rc("value",n.name),s.Db(1),s.Pc(n.title)}}function Z(e,t){if(1&e&&(s.Wb(0,"div",57),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.contentTypeName," ")}}function ee(e,t){if(1&e&&(s.Wb(0,"div",57),s.Oc(1),s.Vb()),2&e){var n=s.kc(2);s.Db(1),s.Qc(" ",n.formErrors.menuIndex," ")}}function te(e,t){if(1&e&&(s.Wb(0,"div",23),s.Wb(1,"div",18),s.Wb(2,"label",59),s.Oc(3),s.lc(4,"translate"),s.Vb(),s.Vb(),s.Wb(5,"div",20),s.Rb(6,"input",60),s.Mc(7,ee,2,1,"div",22),s.Vb(),s.Vb()),2&e){var n=s.kc();s.Db(3),s.Qc(" ",s.mc(4,4,"MENU_INDEX")," "),s.Db(3),s.Ib("is-invalid",n.formErrors.menuIndex),s.Db(1),s.rc("ngIf",n.formErrors.menuIndex)}}function ne(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",61),s.Wb(1,"button",62),s.ic("click",(function(){return s.Ec(n),s.kc().errorMessage=""})),s.Wb(2,"span",63),s.Oc(3,"\xd7"),s.Vb(),s.Vb(),s.Oc(4),s.Vb()}if(2&e){var i=s.kc();s.Db(4),s.Qc(" ",i.errorMessage," ")}}function ie(e,t){if(1&e&&(s.Wb(0,"label",69),s.Rb(1,"input",70),s.Oc(2),s.Vb()),2&e){var n=t.$implicit;s.Db(1),s.rc("value",n),s.Db(1),s.Qc(" ",n," ")}}var oe=function(){return{standalone:!0}};function re(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",64),s.Wb(1,"button",65),s.ic("click",(function(e){return s.Ec(n),s.kc().saveTranslations(e)})),s.lc(2,"translate"),s.Rb(3,"i",66),s.Vb(),s.Wb(4,"div",67),s.ic("ngModelChange",(function(e){return s.Ec(n),s.kc().localeCurrent=e}))("ngModelChange",(function(){return s.Ec(n),s.kc().onLocaleSwitch()})),s.Mc(5,ie,3,2,"label",68),s.Vb(),s.Vb()}if(2&e){var i=s.kc();s.Db(1),s.sc("ngbTooltip",s.mc(2,5,"SAVE")),s.rc("hidden",i.localeCurrent==i.localeDefault),s.Db(3),s.rc("ngModel",i.localeCurrent)("ngModelOptions",s.vc(7,oe)),s.Db(1),s.rc("ngForOf",i.localeList)}}var le=function(e){return{"no-events":e}},ae=function(e,t){return{"is-invalid":e,"border-success":t}},ce=function(e){return{"is-invalid":e}},se=function(e){return{"border-success":e}};function de(e,t){1&e&&(s.Wb(0,"div",2),s.Rb(1,"i",3),s.Vb())}var be=function(e){return["/catalog/category/",e]};function ue(e,t){if(1&e&&(s.Wb(0,"li",6),s.Wb(1,"a",7),s.Oc(2),s.Vb(),s.Rb(3,"app-categories-list",8),s.Vb()),2&e){var n=t.$implicit,i=s.kc(2);s.Ib("active",n.id==i.currentId)("current-level",i.getIsActiveParent(n.id)),s.Db(1),s.Ib("item-inactive",!n.isActive),s.rc("routerLink",s.wc(11,be,n.id)),s.Db(1),s.Qc(" ",n.title," "),s.Db(1),s.rc("inputItems",i.inputItems)("parentId",n.id)("currentId",i.currentId)}}function me(e,t){if(1&e&&(s.Wb(0,"ul",4),s.Mc(1,ue,4,13,"li",5),s.Vb()),2&e){var n=s.kc();s.Ib("shadow",0!=n.parentId),s.Db(1),s.rc("ngForOf",n.items)}}var fe=["categoriesDropdown"];function pe(e,t){if(1&e){var n=s.Xb();s.Wb(0,"button",7),s.ic("click",(function(){return s.Ec(n),s.kc().goToRootCategory()})),s.lc(1,"translate"),s.Rb(2,"i",17),s.Vb()}2&e&&s.sc("ngbTooltip",s.mc(1,1,"OPEN_ROOT_CATEGORY"))}function he(e,t){if(1&e){var n=s.Xb();s.Ub(0),s.Wb(1,"div",18),s.Wb(2,"button",19),s.ic("click",(function(e){return s.Ec(n),s.kc().expandAll(e)})),s.Oc(3),s.lc(4,"translate"),s.Vb(),s.Wb(5,"button",20),s.ic("click",(function(e){return s.Ec(n),s.kc().collapseAll(e)})),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Vb(),s.Tb()}2&e&&(s.Db(3),s.Qc(" ",s.mc(4,2,"EXPAND_ALL")," "),s.Db(3),s.Qc(" ",s.mc(7,4,"COLLAPSE_ALL")," "))}var ge,ve,ye,De,Ce,ke,Ve=((ve=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,l,a,c,s,d){var b;return _classCallCheck(this,n),(b=t.call(this,e,i,o,r,l)).fb=e,b.activeModal=i,b.translateService=o,b.dataService=r,b.elRef=l,b.filesService=a,b.contentTypesService=c,b.appSettings=s,b.systemNameService=d,b.isRoot=!1,b.model=new p(null,!1,0,"","","","",!0),b.contentTypes=[],b.loadingCategories=!1,b.categories=[],b.isCollapsed=!1,b.localeFieldsAllowed=["title","description"],b.files={},b.formFields=[{name:"title",validators:[g.w.required]},{name:"name",validators:[g.w.required]},{name:"description",validators:[]},{name:"parentId",validators:[]},{name:"image",validators:[]},{name:"contentTypeName",validators:[]},{name:"menuIndex",validators:[]},{name:"isActive",validators:[]},{name:"clearCache",validators:[]}],b}return _createClass(n,[{key:"ngOnInit",value:function(){this.uniqueId=this.createUniqueId(),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),void 0!==this.itemId&&(this.model.id=this.itemId),this.model.parentId=this.isEditMode?this.currentCategory.parentId:this.currentCategory.id,this.model.contentTypeName=this.currentCategory.contentTypeName,this.isRoot&&(this.model.id=0,this.model.title=this.getLangString("ROOT_FOLDER"),this.model.name="root"),this.getContentTypes(),_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this)}},{key:"ngAfterViewInit",value:function(){this.elRef.nativeElement.querySelector("#fieldTitle")&&this.elRef.nativeElement.querySelector("#fieldTitle").focus()}},{key:"onAfterGetData",value:function(){this.model.clearCache=!0,this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={}),_get(_getPrototypeOf(n.prototype),"onAfterGetData",this).call(this)}},{key:"getContentTypes",value:function(){var e=this;this.contentTypesService.getListPage().subscribe((function(t){e.contentTypes=t.items}),(function(t){return e.errorMessage=t}))}},{key:"onCategorySelect",value:function(e){this.form.controls.parentId.setValue(e.node.id),this.model.parentId=e.node.id}},{key:"saveFiles",value:function(e){var t=this;if(0!==Object.keys(this.files).length){var n=new FormData;for(var i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&n.append(i,this.files[i],this.files[i].name);n.append("itemId",String(e)),n.append("ownerType","category"),this.filesService.postFormData(n).subscribe((function(){t.closeModal()}),(function(e){t.errorMessage=e.error||"Error.",t.submitted=!1,t.loading=!1}))}else this.closeModal()}},{key:"generateName",value:function(e,t){t&&t.preventDefault();var n=this.getControl(this.form,null,"title").value||"";e.name=this.systemNameService.generateName(n),this.getControl(this.form,null,"name").setValue(e.name)}}]),n}(U.a)).\u0275fac=function(e){return new(e||ve)(s.Qb(g.e),s.Qb(M.b),s.Qb(d.d),s.Qb(C.a),s.Qb(s.l),s.Qb(O),s.Qb(k.a),s.Qb(T.a),s.Qb(D.a))},ve.\u0275cmp=s.Kb({type:ve,selectors:[["app-category-modal-content"]],inputs:{currentCategory:"currentCategory",isRoot:"isRoot"},features:[s.Ab],decls:103,vars:84,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],["class","row form-group form-group-message",4,"ngIf"],[1,"row","form-group","show-on-hover-parent","form-group-message"],[1,"col-md-5"],["for","fieldTitle"],[1,"col-md-7"],["type","text","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group","form-group-message"],["for","fieldName"],[1,"input-group",3,"ngClass"],["type","text","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","disabled","click"],[1,"icon-reload"],[1,"row","form-group","show-on-hover-parent"],["for","fieldDescription"],["type","text","id","fieldDescription","rows","4","name","description","formControlName","description",1,"form-control",3,"ngClass"],[1,"row","form-group"],["formControlName","image",3,"hasPreviewImage","allowedExtensions","files","filesChange"],["for","fieldContentType"],["id","fieldContentType","name","contentTypeName","formControlName","contentTypeName",1,"custom-select"],["value","1",3,"value",4,"ngFor","ngForOf"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","mb-2"],["type","checkbox","id","fieldIsActive","value","1","name","isActive","formControlName","isActive",1,"custom-control-input"],["for","fieldIsActive",1,"custom-control-label"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","id","fieldClearCache","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input"],["for","fieldClearCache",1,"custom-control-label"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"disabled","click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["formControlName","parentId",3,"filterId"],[1,"alert","alert-danger"],["value","1",3,"value"],["for","fieldMenuIndex"],["type","number","id","fieldMenuIndex","name","menuIndex","formControlName","menuIndex",1,"form-control"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"button",2),s.ic("click",(function(e){return t.closeModal(e)})),s.Rb(3,"i",3),s.Wb(4,"span"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Vb(),s.Wb(7,"button",2),s.ic("click",(function(e){return t.minimize(e)})),s.Rb(8,"i",4),s.Wb(9,"span"),s.Oc(10),s.lc(11,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(12,"div",5),s.Wb(13,"div",6),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(e){return t.maximize(e)})),s.lc(16,"translate"),s.Rb(17,"i",9),s.Vb(),s.Wb(18,"button",10),s.ic("click",(function(e){return t.closeModal(e)})),s.lc(19,"translate"),s.Rb(20,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"h4",12),s.Oc(22),s.Vb(),s.Vb(),s.Wb(23,"form",13,14),s.ic("ngSubmit",(function(){return t.onSubmit()})),s.Wb(25,"div",15),s.Mc(26,X,8,7,"div",16),s.Wb(27,"div",17),s.Wb(28,"div",18),s.Wb(29,"label",19),s.Oc(30),s.lc(31,"translate"),s.Vb(),s.Vb(),s.Wb(32,"div",20),s.Rb(33,"input",21),s.Mc(34,K,2,1,"div",22),s.Vb(),s.Vb(),s.Wb(35,"div",23),s.Wb(36,"div",18),s.Wb(37,"label",24),s.Oc(38),s.lc(39,"translate"),s.Vb(),s.Vb(),s.Wb(40,"div",20),s.Wb(41,"div",25),s.Rb(42,"input",26),s.Wb(43,"div",27),s.Wb(44,"button",28),s.ic("click",(function(){return t.generateName(t.model)})),s.lc(45,"translate"),s.Rb(46,"i",29),s.Vb(),s.Vb(),s.Vb(),s.Mc(47,H,2,1,"div",22),s.Vb(),s.Vb(),s.Wb(48,"div",30),s.Wb(49,"div",18),s.Wb(50,"label",31),s.Oc(51),s.lc(52,"translate"),s.Vb(),s.Vb(),s.Wb(53,"div",20),s.Rb(54,"textarea",32),s.Vb(),s.Vb(),s.Wb(55,"div",33),s.Wb(56,"div",18),s.Wb(57,"label"),s.Oc(58),s.lc(59,"translate"),s.Vb(),s.Vb(),s.Wb(60,"div",20),s.Wb(61,"app-file-widget",34),s.ic("filesChange",(function(e){return t.files=e})),s.Vb(),s.Vb(),s.Vb(),s.Wb(62,"div",23),s.Wb(63,"div",18),s.Wb(64,"label",35),s.Oc(65),s.lc(66,"translate"),s.Vb(),s.Vb(),s.Wb(67,"div",20),s.Wb(68,"select",36),s.Mc(69,J,2,2,"option",37),s.Vb(),s.Mc(70,Z,2,1,"div",22),s.Vb(),s.Vb(),s.Mc(71,te,8,6,"div",16),s.Wb(72,"div",33),s.Wb(73,"div",38),s.Wb(74,"div",39),s.Wb(75,"div",40),s.Rb(76,"input",41),s.Wb(77,"label",42),s.Oc(78),s.lc(79,"translate"),s.Vb(),s.Vb(),s.Wb(80,"div",43),s.Rb(81,"input",44),s.Wb(82,"label",45),s.Oc(83),s.lc(84,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Mc(85,ne,5,1,"div",46),s.Vb(),s.Wb(86,"div",47),s.Mc(87,re,6,8,"div",48),s.Wb(88,"div",49),s.Wb(89,"button",50),s.ic("click",(function(e){return t.save(!0,e)})),s.Wb(90,"span"),s.Oc(91),s.lc(92,"translate"),s.Vb(),s.Vb(),s.Wb(93,"div",51),s.Rb(94,"button",52),s.Wb(95,"div",53),s.Wb(96,"button",54),s.ic("click",(function(e){return t.save(!1,e)})),s.Oc(97),s.lc(98,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(99,"button",55),s.ic("click",(function(e){return t.closeModal(e)})),s.Wb(100,"span"),s.Oc(101),s.lc(102,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb()),2&e&&(s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(6,43,"CLOSE")),s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(11,45,"MINIMIZE")),s.Db(5),s.rc("title",s.mc(16,47,"EXPAND")),s.Db(3),s.rc("title",s.mc(19,49,"CLOSE")),s.Db(4),s.Pc(t.modalTitle),s.Db(1),s.rc("formGroup",t.form)("ngClass",s.wc(73,le,t.submitted)),s.Db(2),s.Ib("loading",t.loading),s.Db(1),s.rc("ngIf",!t.isRoot),s.Db(4),s.Qc(" ",s.mc(31,51,"TITLE")," "),s.Db(3),s.rc("ngClass",s.xc(75,ae,t.form.controls.title.touched&&!t.form.controls.title.valid,t.localeCurrent!=t.localeDefault)),s.Db(1),s.rc("ngIf",t.formErrors.title),s.Db(4),s.Qc(" ",s.mc(39,53,"SYSTEM_NAME")," "),s.Db(3),s.rc("ngClass",s.wc(78,ce,t.form.controls.name.touched&&!t.form.controls.name.valid)),s.Db(1),s.rc("ngClass",s.wc(80,ce,t.form.controls.name.touched&&!t.form.controls.name.valid)),s.Db(2),s.sc("ngbTooltip",s.mc(45,55,"GENERATE")),s.rc("disabled",t.form.controls.name.disabled),s.Db(3),s.rc("ngIf",t.formErrors.name),s.Db(4),s.Qc(" ",s.mc(52,57,"DESCRIPTION")," "),s.Db(3),s.rc("ngClass",s.wc(82,se,t.localeCurrent!=t.localeDefault)),s.Db(4),s.Qc(" ",s.mc(59,59,"IMAGE")," "),s.Db(3),s.rc("hasPreviewImage",!0)("allowedExtensions","image/*")("files",t.files),s.Db(4),s.Qc(" ",s.mc(66,61,"CONTENT_TYPE")," "),s.Db(3),s.Ib("is-invalid",t.formErrors.contentTypeName),s.Db(1),s.rc("ngForOf",t.contentTypes),s.Db(1),s.rc("ngIf",t.formErrors.contentTypeName),s.Db(1),s.rc("ngIf",!t.isRoot),s.Db(7),s.Pc(s.mc(79,63,"ACTIVE")),s.Db(5),s.Pc(s.mc(84,65,"CLEAR_FILE_CACHE")),s.Db(2),s.rc("ngIf",t.errorMessage),s.Db(2),s.rc("ngIf",t.localeList.length>1),s.Db(2),s.rc("disabled",t.submitted||t.isSaveButtonDisabled),s.Db(2),s.Pc(s.mc(92,67,"SAVE_AND_CLOSE")),s.Db(3),s.rc("disabled",t.submitted||t.isSaveButtonDisabled),s.Db(2),s.rc("disabled",t.submitted||t.isSaveButtonDisabled),s.Db(1),s.Qc(" ",s.mc(98,69,"SAVE")," "),s.Db(4),s.Pc(s.mc(102,71,"CLOSE")))},directives:[g.y,g.o,g.h,l.n,l.p,g.b,g.n,g.g,M.u,z.a,g.v,l.o,g.a,M.d,M.g,M.f,M.e,S.a,g.r,g.x,g.s,M.p,g.q,M.c,M.o],pipes:[d.c],encapsulation:2}),ve),Ie=((ge=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(G)).\u0275fac=function(e){return We(e||ge)},ge.\u0275cmp=s.Kb({type:ge,selectors:[["app-categories-list"]],features:[s.Ab],decls:2,vars:2,consts:[["class","pos-absolute-right pos-absolute-right2 no-events",4,"ngIf"],["class","dropdown-menu dropdown-menu-second",3,"shadow",4,"ngIf"],[1,"pos-absolute-right","pos-absolute-right2","no-events"],[1,"icon-keyboard_arrow_right"],[1,"dropdown-menu","dropdown-menu-second"],["class","dropdown-item active",3,"active","current-level",4,"ngFor","ngForOf"],[1,"dropdown-item","active"],["href","",3,"routerLink"],[3,"inputItems","parentId","currentId"]],template:function(e,t){1&e&&(s.Mc(0,de,2,0,"div",0),s.Mc(1,me,2,3,"ul",1)),2&e&&(s.rc("ngIf",t.items.length>0&&0!=t.parentId),s.Db(1),s.rc("ngIf",t.items.length>0))},directives:[l.p,l.o,c.e,ge],encapsulation:2}),ge),We=s.Yb(Ie),Oe=((ye=function(){function e(t,n,i,o,r){_classCallCheck(this,e),this.router=t,this.route=n,this.modalService=i,this.categoriesService=o,this.translateService=r,this.rootTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",this.changeRequest=new s.n,this.currentCategory=new p(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode={id:0},this.categoriesTree=[{id:0,parentId:0,label:"",expanded:!0,children:null}],this.categories=[],this.errorMessage="",this.categoryId=0,this.loading=!1,this.destroyed$=new x.a}return _createClass(e,[{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.getCategories().then((function(t){e.loading=!1,e.route.paramMap.pipe(Object(Q.a)(e.destroyed$)).subscribe((function(t){e.categoryId=t.get("categoryId")?parseInt(t.get("categoryId"),10):0,e.selectCurrent()}))}))}},{key:"selectCurrent",value:function(){if(this.currentCategory.id!==this.categoryId){var e=Object(f.findIndex)(this.categories,{id:this.categoryId});e>-1?(this.currentCategory=Object(f.cloneDeep)(this.categories[e]),this.changeRequest.emit(this.currentCategory)):this.openRootCategory(),this.currentCategoryNode=p.getCurrentNode(this.currentCategory.id,this.categoriesTree[0])}}},{key:"getCategories",value:function(){var e=this;return new Promise((function(t,n){e.categoriesService.getListPage(new N.a("menuIndex,title","asc",1)).subscribe((function(n){n.items&&n.items.length>0&&(e.categories=n.items,e.categoriesTree=[p.createTree(n.items)]),t(n.items)}),(function(t){e.errorMessage=t,n()}))}))}},{key:"openModalCategory",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.categoriesDropdown.nativeElement.previousSibling.classList.remove("dropdown-toggle-hover"),setTimeout((function(){t.categoriesDropdown.nativeElement.previousSibling.classList.add("dropdown-toggle-hover")}),1);var i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){var o=window.document.getElementById(i),r=o.previousElementSibling;return o.classList.add("d-block"),o.classList.remove("modal-minimized"),void r.classList.remove("d-none")}var l=0===e||null===e,a=void 0!==e&&!n;this.modalRef=this.modalService.open(Ve,{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.modalRef.componentInstance.modalTitle=a?this.getLangString("CATEGORY")+(e?" #"+e:""):this.getLangString("ADD_NEW_CATEGORY"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=n||!1,this.modalRef.componentInstance.currentCategory=this.currentCategory,this.modalRef.componentInstance.isRoot=l,this.modalRef.componentInstance.isEditMode=a,this.modalRef.result.then((function(e){t.destroyed$.isStopped||(t.currentCategory.id=null,t.loading=!0,t.getCategories().then((function(){t.selectCurrent(),t.loading=!1})))}),(function(e){t.destroyed$.isStopped||(e&&["submit","updated"].indexOf(e)>-1&&(t.currentCategory.id=null,t.loading=!0,t.getCategories().then((function(){t.selectCurrent(),t.loading=!1}))),t.loading=!1)}))}},{key:"getModalElementId",value:function(e){return["modal","category",e||0].join("-")}},{key:"deleteCategoryItemConfirm",value:function(e){var t=this,n=Object(f.findIndex)(this.categories,{id:e});-1!==n&&(this.modalRef=this.modalService.open(B.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE_CATEGORY")+' "'.concat(this.categories[n].title,'"?'),this.modalRef.result.then((function(n){"accept"===n&&t.deleteCategoryItem(e)}),(function(e){})))}},{key:"deleteCategoryItem",value:function(e){var t=this;this.loading=!0,this.categoriesService.deleteItem(e).subscribe((function(e){t.categoryId=0,t.getCategories().then((function(){t.goToRootCategory(),t.loading=!1}))}),(function(e){e.error&&(t.errorMessage=e.error),t.loading=!1}))}},{key:"openCategory",value:function(e){this.router.navigate(["/catalog/category",e.node.id])}},{key:"goToRootCategory",value:function(){this.router.navigate(["/catalog/category",""])}},{key:"openRootCategory",value:function(){this.currentCategory=new p(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode=this.categoriesTree[0],this.changeRequest.emit(this.currentCategory)}},{key:"copyCategory",value:function(){this.openModalCategory(this.currentCategory.id,!0)}},{key:"expandAll",value:function(e){var t=this;e&&e.preventDefault(),this.categoriesTree.forEach((function(e){t.expandRecursive(e,!0)}))}},{key:"collapseAll",value:function(e){var t=this;e&&e.preventDefault(),this.categoriesTree.forEach((function(e){t.expandRecursive(e,!1)}))}},{key:"expandRecursive",value:function(e,t){var n=this;e.expanded=t,e.children&&e.children.forEach((function(e){n.expandRecursive(e,t)}))}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}}]),e}()).\u0275fac=function(e){return new(e||ye)(s.Qb(c.c),s.Qb(c.a),s.Qb(M.h),s.Qb(C.a),s.Qb(d.d))},ye.\u0275cmp=s.Kb({type:ye,selectors:[["app-categories-menu"]],viewQuery:function(e,t){var n;1&e&&s.Jc(fe,!0),2&e&&s.Cc(n=s.jc())&&(t.categoriesDropdown=n.first)},inputs:{rootTitle:"rootTitle"},outputs:{changeRequest:"changeRequest"},decls:26,vars:26,consts:[[1,"d-block","d-md-inline-block","dropdown"],[1,"btn","btn-secondary","dropdown-toggle","dropdown-toggle-hover","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],[1,"icon-folder","mr-1"],[1,"dropdown-menu","shadow"],["categoriesDropdown",""],[1,"dropdown-header"],["type","button","class","btn btn-sm btn-secondary mr-2",3,"ngbTooltip","click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","click"],[1,"icon-plus"],[1,"icon-pencil"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-stack"],[1,"icon-cross"],[1,"dropdown-divider"],[4,"ngIf"],[1,"px-1"],[3,"value","emptyMessage","selectionMode","selection","filter","onNodeSelect"],[1,"icon-home"],[1,"dropdown-footer","px-4","pt-1"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"button",1),s.Rb(2,"i",2),s.Oc(3),s.Vb(),s.Wb(4,"div",3,4),s.Wb(6,"div"),s.Wb(7,"div",5),s.Mc(8,pe,3,3,"button",6),s.Wb(9,"button",7),s.ic("click",(function(){return t.openModalCategory()})),s.lc(10,"translate"),s.Rb(11,"i",8),s.Vb(),s.Wb(12,"button",7),s.ic("click",(function(){return t.openModalCategory(t.currentCategory.id)})),s.lc(13,"translate"),s.Rb(14,"i",9),s.Vb(),s.Wb(15,"button",10),s.ic("click",(function(){return t.copyCategory()})),s.lc(16,"translate"),s.Rb(17,"i",11),s.Vb(),s.Wb(18,"button",10),s.ic("click",(function(){return t.deleteCategoryItemConfirm(t.currentCategory.id)})),s.lc(19,"translate"),s.Rb(20,"i",12),s.Vb(),s.Vb(),s.Rb(21,"div",13),s.Mc(22,he,8,6,"ng-container",14),s.Wb(23,"div",15),s.Wb(24,"p-tree",16),s.ic("onNodeSelect",(function(e){return t.openCategory(e)})),s.lc(25,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb()),2&e&&(s.Db(3),s.Qc(" ",t.currentCategory.title," "),s.Db(3),s.Ib("loading",t.loading),s.Db(2),s.rc("ngIf",t.currentCategory.id>0),s.Db(1),s.sc("ngbTooltip",s.mc(10,16,"ADD_NEW_CATEGORY")),s.Db(3),s.sc("ngbTooltip",s.mc(13,18,"EDIT_CATEGORY")),s.Db(3),s.sc("ngbTooltip",s.mc(16,20,"COPY_CATEGORY")),s.rc("hidden",!t.currentCategory.id),s.Db(3),s.sc("ngbTooltip",s.mc(19,22,"DELETE_CATEGORY")),s.rc("hidden",!t.currentCategory.id),s.Db(4),s.rc("ngIf",t.categoriesTree[0].children),s.Db(2),s.rc("value",t.categoriesTree[0].children)("emptyMessage",s.mc(25,24,"NO_CATEGORIES"))("selectionMode","single")("selection",t.currentCategoryNode)("filter",!!t.categoriesTree[0].children))},directives:[l.p,M.u,Y.a],pipes:[d.c],encapsulation:2}),ye),Ee=n("hecf"),Te=((De=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,l){var a;return _classCallCheck(this,n),(a=t.call(this,e,i,o,r)).dataService=e,a.activeModal=i,a.modalService=o,a.translateService=r,a.contentTypesService=l,a.queryOptions=new N.a("id","desc",1,10,0,0),a.tableFields=[],a}return _createClass(n,[{key:"ngOnInit",value:function(){}},{key:"updateTableConfig",value:function(){var e=this;this.currentContentType&&(this.tableFields=[],this.currentContentType.fields.forEach((function(t){t.showInTable&&e.tableFields.push({name:t.name,sortName:t.name,title:t.title,outputType:t.outputType,outputProperties:t.outputProperties})})),this.tableFields.unshift({name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}}),this.tableFields.push({name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}))}},{key:"getModalContent",value:function(){return A}},{key:"getContentType",value:function(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}},{key:"openCategory",value:function(e){var t=this;if(this.currentCategory=Object(f.clone)(e),!this.currentCategory.contentTypeName)return this.items=[],this.tableFields=[],void(this.currentCategory.id=0);this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.loading=!0,this.queryOptions.page=1,this.getContentType().subscribe((function(e){t.currentContentType=e,t.loading=!1,t.updateTableConfig(),t.getList()}),(function(){t.items=[],t.tableFields=[],t.currentCategory.id=0}))}},{key:"openRootCategory",value:function(){this.currentCategory=new p(0,!1,0,"root","","","",!0),this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.getList()}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=i?"".concat(this.getLangString("PAGE")," #").concat(e):this.getLangString("ADD"),this.modalRef.componentInstance.modalId=n,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=i,this.modalRef.componentInstance.category=Object.assign({},this.currentCategory)}},{key:"getModalElementId",value:function(e){return["modal","product",e||0].join("-")}}]),n}(h.a)).title="CATEGORY",De.\u0275fac=function(e){return new(e||De)(s.Qb(W),s.Qb(M.b),s.Qb(M.h),s.Qb(d.d),s.Qb(k.a))},De.\u0275cmp=s.Kb({type:De,selectors:[["app-catalog-category"]],features:[s.Cb([W]),s.Ab],decls:26,vars:18,consts:[[1,"mb-3"],[1,"float-md-left"],[3,"changeRequest"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div"),s.Wb(2,"div",1),s.Wb(3,"app-categories-menu",2),s.ic("changeRequest",(function(e){return t.openCategory(e)})),s.Vb(),s.Vb(),s.Wb(4,"div",3),s.Wb(5,"div",4),s.Wb(6,"button",5),s.Wb(7,"span"),s.Oc(8),s.lc(9,"translate"),s.Vb(),s.Vb(),s.Wb(10,"div",6),s.Wb(11,"button",7),s.ic("click",(function(){return t.blockSelected()})),s.Oc(12),s.lc(13,"translate"),s.Vb(),s.Wb(14,"button",7),s.ic("click",(function(){return t.deleteSelected()})),s.Oc(15),s.lc(16,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(17,"button",8),s.ic("click",(function(){return t.modalOpen()})),s.Rb(18,"i",9),s.Oc(19," \xa0 "),s.Wb(20,"span"),s.Oc(21),s.lc(22,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Rb(23,"div",10),s.Vb(),s.Vb(),s.Wb(24,"app-table",11,12),s.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),s.Vb()),2&e&&(s.Db(8),s.Pc(s.mc(9,10,"BATCH_ACTIONS")),s.Db(4),s.Pc(s.mc(13,12,"DISABLE_ENABLE")),s.Db(3),s.Pc(s.mc(16,14,"DELETE")),s.Db(6),s.Pc(s.mc(22,16,"ADD")),s.Db(3),s.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[Oe,M.d,M.g,M.f,Ee.a],pipes:[d.c],encapsulation:2}),De),Me=n("LRne"),Se=n("JIr8"),we=((ke=function(){function e(t){_classCallCheck(this,e),this.http=t,this.headers=new I.e({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}return _createClass(e,[{key:"setRequestUrl",value:function(e){this.requestUrl=e}},{key:"getRequestUrl",value:function(){return this.requestUrl}},{key:"getList",value:function(){return this.http.get(this.getRequestUrl()).pipe(Object(Se.a)(this.handleError()))}},{key:"deleteItemByName",value:function(e){var t="".concat(this.getRequestUrl(),"/").concat(e);return this.http.delete(t,{headers:this.headers}).pipe(Object(Se.a)(this.handleError()))}},{key:"handleError",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1?arguments[1]:void 0;return function(t){if(t.error)throw t.error;return Object(Me.a)(e)}}}]),e}()).\u0275fac=function(e){return new(e||ke)(s.ec(I.a))},ke.\u0275prov=s.Mb({token:ke,factory:ke.\u0275fac}),ke),Re=((Ce=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("/admin/field_types"),i}return n}(V.a)).\u0275fac=function(e){return new(e||Ce)(s.ec(I.a))},Ce.\u0275prov=s.Mb({token:Ce,factory:Ce.\u0275fac}),Ce),_e=n("XWOk"),Le=n("fMdm"),Pe=["addCollectionBlock"],Fe=["addGroupBlock"],Ae=["accordion"],Ne=["blockFieldList"];function xe(e,t){if(1&e&&(s.Wb(0,"div",105),s.Oc(1),s.Vb()),2&e){var n=s.kc().message;s.Db(1),s.Pc(n)}}function Qe(e,t){if(1&e&&(s.Wb(0,"p",102),s.Oc(1),s.lc(2,"translate"),s.Vb(),s.Mc(3,xe,2,1,"div",103),s.Wb(4,"div",102),s.Wb(5,"button",104),s.ic("click",(function(){return(0,t.confirm)()})),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Oc(8," \xa0 "),s.Wb(9,"button",44),s.ic("click",(function(){return t.p.close()})),s.Oc(10),s.lc(11,"translate"),s.Vb(),s.Vb()),2&e){var n=t.message;s.Db(1),s.Pc(s.mc(2,4,"YOU_SURE_YOU_WANT_DELETE")),s.Db(2),s.rc("ngIf",n),s.Db(3),s.Pc(s.mc(7,6,"YES")),s.Db(4),s.Pc(s.mc(11,8,"NO"))}}function qe(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.title," ")}}function je(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.name," ")}}function Ge(e,t){if(1&e&&(s.Wb(0,"option",107),s.Oc(1),s.Vb()),2&e){var n=t.$implicit;s.sc("value",n),s.Db(1),s.Pc(n)}}function Ue(e,t){if(1&e&&(s.Wb(0,"div",108),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.newCollection," ")}}function Be(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_title," ")}}function ze(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_name," ")}}function Ye(e,t){if(1&e&&(s.Wb(0,"option",107),s.Oc(1),s.Vb()),2&e){var n=t.$implicit;s.sc("value",n.name),s.Db(1),s.Pc(n.title)}}function $e(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_inputType," ")}}var Xe=function(){return{standalone:!0}};function Ke(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",109),s.Wb(1,"div",54),s.Oc(2),s.Vb(),s.Wb(3,"div",55),s.Wb(4,"input",110),s.ic("ngModelChange",(function(e){s.Ec(n);var i=t.$implicit;return s.kc().fieldModel.inputProperties[i.name]=e})),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit,o=s.kc();s.Db(2),s.Qc(" ",i.title," "),s.Db(2),s.rc("ngModel",o.fieldModel.inputProperties[i.name])("ngModelOptions",s.vc(3,Xe))}}function He(e,t){if(1&e&&(s.Wb(0,"option",107),s.Oc(1),s.Vb()),2&e){var n=t.$implicit;s.sc("value",n.name),s.Db(1),s.Pc(n.title)}}function Je(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_outputType," ")}}function Ze(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",109),s.Wb(1,"div",54),s.Oc(2),s.Vb(),s.Wb(3,"div",55),s.Wb(4,"input",110),s.ic("ngModelChange",(function(e){s.Ec(n);var i=t.$implicit;return s.kc().fieldModel.outputProperties[i.name]=e})),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit,o=s.kc();s.Db(2),s.Qc(" ",i.title," "),s.Db(2),s.rc("ngModel",o.fieldModel.outputProperties[i.name])("ngModelOptions",s.vc(3,Xe))}}function et(e,t){if(1&e&&(s.Wb(0,"option",107),s.Oc(1),s.Vb()),2&e){var n=t.$implicit;s.rc("value",n),s.Db(1),s.Pc(n)}}function tt(e,t){if(1&e&&(s.Wb(0,"div",106),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_group," ")}}function nt(e,t){if(1&e&&(s.Wb(0,"div",108),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.fld_newGroup," ")}}function it(e,t){if(1&e){var n=s.Xb();s.Wb(0,"tr",121),s.Wb(1,"td"),s.Oc(2),s.Wb(3,"span",122),s.Oc(4),s.Vb(),s.Vb(),s.Wb(5,"td"),s.Oc(6),s.Vb(),s.Wb(7,"td"),s.Oc(8),s.Vb(),s.Wb(9,"td"),s.Rb(10,"app-output-field",123),s.Vb(),s.Wb(11,"td"),s.Wb(12,"div",124),s.Wb(13,"div",125),s.Wb(14,"button",126),s.ic("click",(function(){s.Ec(n);var e=t.$implicit;return s.kc(2).editField(e)})),s.lc(15,"translate"),s.Rb(16,"i",127),s.Vb(),s.Wb(17,"button",128),s.ic("click",(function(){s.Ec(n);var e=t.$implicit;return s.kc(2).copyField(e)})),s.lc(18,"translate"),s.Rb(19,"i",129),s.Vb(),s.Wb(20,"button",126),s.ic("click",(function(){s.Ec(n);var e=t.$implicit;return s.kc(2).deleteField(e)})),s.lc(21,"translate"),s.Rb(22,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Rb(23,"app-output-field",123),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit,o=s.kc(2);s.Db(2),s.Qc(" ",i.title," "),s.Db(2),s.Qc("(",i.name,")"),s.Db(2),s.Qc(" ",i.inputType," "),s.Db(2),s.Qc(" ",i.group," "),s.Db(2),s.rc("value",i.required),s.Db(4),s.sc("ngbTooltip",s.mc(15,11,"EDIT")),s.rc("hidden",i.name==o.currentFieldName),s.Db(3),s.sc("ngbTooltip",s.mc(18,13,"COPY")),s.Db(3),s.sc("ngbTooltip",s.mc(21,15,"DELETE")),s.rc("hidden",i.name==o.currentFieldName),s.Db(3),s.rc("value",i.showInTable)}}function ot(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",null,111),s.Wb(2,"div"),s.Wb(3,"div",112),s.Wb(4,"button",113),s.ic("click",(function(e){return s.Ec(n),s.kc().sortingInit("","",e)})),s.Rb(5,"i",114),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Oc(8," \xa0 "),s.Wb(9,"button",113),s.ic("click",(function(e){return s.Ec(n),s.kc().sortingInit("listOrder","showInList",e)})),s.Rb(10,"i",114),s.Oc(11),s.lc(12,"translate"),s.Vb(),s.Oc(13," \xa0 "),s.Wb(14,"button",113),s.ic("click",(function(e){return s.Ec(n),s.kc().sortingInit("filterOrder","isFilter",e)})),s.Rb(15,"i",114),s.Oc(16),s.lc(17,"translate"),s.Vb(),s.Vb(),s.Wb(18,"div",115),s.Wb(19,"table",116),s.Wb(20,"thead"),s.Wb(21,"tr"),s.Wb(22,"th"),s.Oc(23),s.lc(24,"translate"),s.Vb(),s.Wb(25,"th"),s.Oc(26),s.lc(27,"translate"),s.Vb(),s.Wb(28,"th"),s.Oc(29),s.lc(30,"translate"),s.Vb(),s.Wb(31,"th"),s.Oc(32),s.lc(33,"translate"),s.Vb(),s.Wb(34,"th"),s.Oc(35),s.lc(36,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(37,"tbody"),s.Mc(38,it,24,17,"tr",117),s.Wb(39,"tr",118),s.Wb(40,"td",119),s.Oc(41),s.lc(42,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(43,"app-sorting-dnd",120),s.ic("itemsChange",(function(e){return s.Ec(n),s.kc().sortData=e}))("save",(function(e){return s.Ec(n),s.kc().sortingApply(e)}))("cancel",(function(){return s.Ec(n),s.kc().sortingReset()})),s.Vb()}if(2&e){var i=s.kc();s.Db(3),s.rc("hidden",i.model.fields.length<2),s.Db(3),s.Qc(" ",s.mc(7,13,"SORT_FIELDS")," "),s.Db(5),s.Qc(" ",s.mc(12,15,"SORT_FIELDS_LIST")," "),s.Db(5),s.Qc(" ",s.mc(17,17,"SORT_FILTERS")," "),s.Db(7),s.Pc(s.mc(24,19,"TITLE")),s.Db(3),s.Pc(s.mc(27,21,"INPUT_TYPE")),s.Db(3),s.Pc(s.mc(30,23,"GROUP")),s.Db(3),s.Qc("",s.mc(33,25,"REQUIRED"),"?"),s.Db(3),s.Qc("",s.mc(36,27,"SHOW_IN_TABLE"),"?"),s.Db(3),s.rc("ngForOf",i.model.fields),s.Db(1),s.rc("hidden",i.model.fields.length>0),s.Db(2),s.Qc(" ",s.mc(42,29,"EMPTY")," "),s.Db(2),s.rc("items",i.sortData)}}var rt,lt,at=function(){return["/catalog"]},ct=((lt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,l,a,c,s,d,b){var u;return _classCallCheck(this,n),(u=t.call(this,e,i,o,r,l,a,c)).fb=e,u.dataService=i,u.systemNameService=o,u.activeModal=r,u.tooltipConfig=l,u.translateService=a,u.elRef=c,u.fieldTypesService=s,u.collectionsService=d,u.modalService=b,u.model=new v(0,"","","","products",[],["General","Service"],!0),u.fieldModel=new E.a(0,"","","","",{},"",{},"",!1,!1,!1),u.sortData=[],u.sortingfieldName="",u.fld_submitted=!1,u.action="add_field",u.currentFieldName="",u.collections=["products"],u.fieldTypeProperties={input:[],output:[]},u.formFields={name:{fieldLabel:"SYSTEM_NAME",value:"",validators:[g.w.required,g.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters and numbers."}},title:{fieldLabel:"TITLE",value:"",validators:[g.w.required],messages:{}},description:{fieldLabel:"DESCRIPTION",value:"",validators:[],messages:{}},collection:{fieldLabel:"COLLECTION",value:"",validators:[g.w.required],messages:{}},newCollection:{fieldLabel:"COLLECTION",value:"",validators:[g.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters and numbers.",exists:"Collection with the same name already exists."}},isActive:{fieldLabel:"ACTIVE",value:"",validators:[],messages:{}}},u.fieldsFormOptions={title:{fieldLabel:"TITLE",value:"",validators:[g.w.required],messages:{}},name:{fieldLabel:"SYSTEM_NAME",value:"",validators:[g.w.required,g.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters."}},description:{fieldLabel:"DESCRIPTION",value:"",validators:[],messages:{}},inputType:{fieldLabel:"INPUT_TYPE",value:"",validators:[g.w.required],messages:{}},outputType:{fieldLabel:"OUTPUT_TYPE",value:"",validators:[g.w.required],messages:{}},group:{fieldLabel:"GROUP",value:"",validators:[g.w.required],messages:{}},newGroup:{fieldLabel:"GROUP",value:"",validators:[],messages:{}},required:{value:"",validators:[],messages:{}},showInTable:{value:"",validators:[],messages:{}},showInList:{value:"",validators:[],messages:{}},isFilter:{value:"",validators:[],messages:{}}},u}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.getFieldTypes(),this.getCollectionsList()}},{key:"buildForm",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"buildForm",this).call(this);var t=this.buildControls(this.fieldsFormOptions,"fieldModel","fld_");this.fieldForm=this.fb.group(t),this.fieldForm.valueChanges.subscribe((function(){return e.onValueChanged("fieldForm","fld_")}))}},{key:"getFieldTypes",value:function(){var e=this,t=new N.a("title","asc",0,0,1);this.fieldTypesService.getListPage(t).subscribe((function(t){e.fieldTypes=t.items}),(function(t){return e.errorMessage=t}))}},{key:"getCollectionsList",value:function(){var e=this;this.collectionsService.getList().subscribe((function(t){t.length>0&&(e.collections=t)}))}},{key:"selectFieldTypeProperties",value:function(e,t){var n=this;t&&(this.fieldModel[e+"Type"]=t);var i=Object(f.find)(this.fieldTypes,{name:this.fieldModel[e+"Type"]});if(i){var o=e+"Properties",r=Object(f.map)(i[e+"Properties"],"name");for(var l in this.fieldTypeProperties[e].splice(0),i[e+"Properties"].forEach((function(t,i){n.fieldTypeProperties[e].push(t)})),this.fieldModel[o])this.fieldModel[o].hasOwnProperty(l)&&-1===r.indexOf(l)&&delete this.fieldModel[o][l];for(var a in this.fieldTypeProperties[e])if(this.fieldTypeProperties[e].hasOwnProperty(a)){var c=this.fieldTypeProperties[e][a].name;void 0===this.fieldModel[o][c]&&(this.fieldModel[o][c]=this.fieldTypeProperties[e][a].default_value)}"input"!==e||this.fieldModel.outputType||this.selectFieldTypeProperties("output",this.fieldModel.inputType)}else this.fieldTypeProperties[e]=[]}},{key:"addCollection",value:function(){var e=this.form.get("newCollection");if(!e.valid||!e.value)return!1;this.formErrors.newCollection="";var t=e.value;return this.collections.indexOf(t)>-1?(this.formErrors.newCollection+=this.validationMessages.newCollection.exists,!1):(this.collections.push(t),this.model.collection=t,this.elementAddCollectionBlock.nativeElement.style.display="none",!0)}},{key:"deleteCollection",value:function(e){var t;this.model.collection&&(e.isOpen()?e.close():(e.placement="top",e.popoverTitle=this.getLangString("CONFIRM"),t={p:e,confirm:(function(){var t=this;this.loading=!0,this.collectionsService.deleteItemByName(this.model.collection).subscribe((function(n){var i=t.collections.indexOf(t.model.collection);i>-1&&(t.collections.splice(i,1),t.model.collection=t.collections[0]),e.close(),t.loading=!1}),(function(e){t.errorMessage=e.error||"Error.",t.loading=!1}))}).bind(this),message:""},e.open(t)))}},{key:"addGroup",value:function(){var e=this.fieldForm.get("newGroup");if(!e||!e.valid||!e.value)return!1;this.formErrors.fld_newGroup="";var t=e.value;return this.model.groups.indexOf(t)>-1?(this.formErrors.fld_newGroup+=this.validationMessages.fld_newGroup.exists,!1):(this.model.groups.push(t),this.fieldModel.group=t,this.elementAddGroupBlock.nativeElement.style.display="none",!0)}},{key:"deleteGroup",value:function(){var e=this.fieldForm.get("group").value,t=Object(f.findIndex)(this.model.fields,{group:e});this.errorFieldMessage="",t>-1?this.errorFieldMessage="You can't delete a group because it is not empty.":(t=this.model.groups.indexOf(e))>-1&&this.model.groups.splice(t,1)}},{key:"editField",value:function(e){this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="edit_field",this.fieldModel=Object(f.cloneDeep)(e);var t={};for(var n in this.fieldsFormOptions)this.fieldsFormOptions.hasOwnProperty(n)&&(t[n]=e[n]||"");this.fieldForm.setValue(t),this.currentFieldName=this.fieldModel.name,this.fld_submitted=!1}},{key:"copyField",value:function(e){this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="add_field",this.fieldModel=Object(f.cloneDeep)(e),this.fieldModel.name="",this.fieldForm.setValue(this.fieldModel),this.currentFieldName="",this.fld_submitted=!1}},{key:"deleteField",value:function(e){var t=Object(f.findIndex)(this.model.fields,{name:e.name});-1!==t?this.model.fields.splice(t,1):this.errorMessage="Field not found."}},{key:"resetFieldForm",value:function(){this.action="add_field",this.errorMessage="",this.errorFieldMessage="",this.fld_submitted=!1,this.currentFieldName="",this.fieldForm.reset(),this.fieldModel=new E.a(0,"","","","",{},"",{},"",!1,!1,!1)}},{key:"editFieldCancel",value:function(){this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.resetFieldForm(),this.onValueChanged("fieldForm","fld_")}},{key:"fieldMove",value:function(e,t){if(!("up"===t&&0===e||"down"===t&&e===this.model.fields.length-1)){var n="up"===t?e-1:e+1,i=this.model.fields[e];this.model.fields.splice(e,1),this.model.fields.splice(n,0,i)}}},{key:"submitField",value:function(){if(this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.fld_submitted=!0,!this.fieldForm.valid)return this.onValueChanged("fieldForm","fld_"),void(this.fld_submitted=!1);var e=Object(f.cloneDeep)(this.fieldModel);e.inputProperties=Object(f.extend)({},this.fieldModel.inputProperties),e.outputProperties=Object(f.extend)({},this.fieldModel.outputProperties);var t=Object(f.findIndex)(this.model.fields,{name:e.name});t>-1&&this.currentFieldName!==e.name?this.errorMessage='A field named "'+e.name+'" already exists.':("add_field"===this.action?this.model.fields.push(e):"edit_field"===this.action&&(t=Object(f.findIndex)(this.model.fields,{name:this.currentFieldName}))>-1&&(this.model.fields[t]=e),this.resetFieldForm())}},{key:"getFieldTypeProperty",value:function(e,t){if(!e)return null;var n=null,i=Object(f.findIndex)(this.fieldTypes,{name:e});return i>-1&&void 0!==this.fieldTypes[i][t]&&(n=this.fieldTypes[i][t]),n}},{key:"sortingInit",value:function(e,t,n){var i,o=this;n&&n.preventDefault(),this.sortingfieldName=e,i=t?this.model.fields.filter((function(e){return e[t]})):this.model.fields,e&&i.sort((function(t,n){return t[e]-n[e]})),this.sortData=[],i.forEach((function(e){o.sortData.push({name:e.name,title:e.title})})),this.blockFieldList.nativeElement.style.display="none"}},{key:"sortingApply",value:function(){var e=this;if(this.sortingfieldName)this.sortData.forEach((function(t,n){var i=e.model.fields.findIndex((function(e){return e.name===t.name}));i>-1&&(e.model.fields[i][e.sortingfieldName]=n)}));else{var t=this.sortData.map((function(e){return e.name}));this.model.fields.sort((function(e,n){return t.indexOf(e.name)-t.indexOf(n.name)}))}this.sortingReset()}},{key:"sortingReset",value:function(){var e=Object(f.findIndex)(this.model.fields,{name:this.currentFieldName});this.action=e>-1?"edit_field":"add_field",this.sortData.splice(0,this.sortData.length),this.sortingfieldName="",this.blockFieldList.nativeElement.style.display="block"}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;n&&n.preventDefault(),this.submitted=!0,this.sortData.length>0&&this.sortingApply(),setTimeout((function(){if(!e.form.valid)return e.onValueChanged("form"),void(e.submitted=!1);e.loading=!0,e.saveRequest().subscribe({next:function(n){t?e.closeModal():n&&n.id&&(e.model.id=n.id,e.onAfterGetData(),e.isEditMode=!0),e.closeReason="updated",e.loading=!1,e.submitted=!1},error:function(t){e.errorMessage=t.error||"Error.",e.submitted=!1,e.loading=!1}})}),1)}}]),n}(y.a)).\u0275fac=function(e){return new(e||lt)(s.Qb(g.e),s.Qb(k.a),s.Qb(D.a),s.Qb(M.b),s.Qb(M.v),s.Qb(d.d),s.Qb(s.l),s.Qb(Re),s.Qb(we),s.Qb(M.h))},lt.\u0275cmp=s.Kb({type:lt,selectors:[["app-content-type-modal-content"]],viewQuery:function(e,t){var n;1&e&&(s.Jc(Pe,!0),s.Jc(Fe,!0),s.Jc(Ae,!0),s.Sc(Ne,!0)),2&e&&(s.Cc(n=s.jc())&&(t.elementAddCollectionBlock=n.first),s.Cc(n=s.jc())&&(t.elementAddGroupBlock=n.first),s.Cc(n=s.jc())&&(t.accordion=n.first),s.Cc(n=s.jc())&&(t.blockFieldList=n.first))},features:[s.Ab],decls:281,vars:223,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["confirmPopover",""],[1,"modal-body","py-0"],[1,"row","mb-3"],[1,"col-lg-4",3,"formGroup"],[1,"form-group","form-group-message"],[1,"label-filled"],["type","text","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],["for","fieldName",1,"label-filled"],[1,"input-group"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group"],["type","text","rows","3","name","description","formControlName","description",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row","form-group-message"],[1,"col-12"],[1,"form-group","mb-0"],["name","collection","formControlName","collection",1,"custom-select","custom-select-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"icon-plus"],["triggers","manual",1,"input-group-append",3,"ngbPopover"],["buttonDeleteCollection","ngbPopover"],[1,"card","p-1","mt-2","form-group-message",2,"display","none"],["addCollectionBlock",""],["type","text","formControlName","newCollection",1,"form-control","form-control-sm"],["addCollectionField",""],["class","alert alert-danger mb-1",4,"ngIf"],[1,"text-right","mt-1"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"form-group","row"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"for"],[1,"col-lg-8",3,"formGroup"],[1,"label-filled",3,"hidden"],[1,"card"],[1,"card-body"],[1,"col-md-5"],[1,"col-md-7"],["type","text","name","field_title","formControlName","title",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","text","name","field_name","formControlName","name",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","text","rows","3","name","field_description","formControlName","description",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","field_inputType","formControlName","inputType","placement","left",1,"custom-select","custom-select-sm",3,"ngModel","ngbTooltip","ngModelChange"],["value",""],[1,"icon-cog"],[1,"card","card-body","bg-light","mb-3",2,"display","none",3,"hidden"],["inputTypeOptionsBlock",""],[1,"alert","alert-secondary","small",3,"hidden"],["class","row form-group",4,"ngFor","ngForOf"],["name","field_outputType","formControlName","outputType","placement","left",1,"custom-select","custom-select-sm",3,"ngModel","ngbTooltip","ngModelChange"],["outputTypeOptionsBlock",""],[1,"form-group-message"],[1,"input-group","input-group-sm"],["name","field_group","formControlName","group",1,"custom-select",3,"ngModel","ngModelChange"],["addGroupBlock",""],["type","text","formControlName","newGroup",1,"form-control","form-control-sm"],["addGroupField",""],[1,"form-group","row","mb-0"],[1,"col-md-7","offset-md-5"],[1,"custom-control","custom-checkbox"],["type","checkbox","value","1","name","required","formControlName","required",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","showInTable","formControlName","showInTable",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","showInList","formControlName","showInList",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","isFilter","formControlName","isFilter",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"alert","alert-danger","mt-3","mb-3",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"mt-3"],["type","button",1,"btn","btn-sm","btn-info","btn-wide",3,"hidden","click"],["type","button",1,"btn","btn-sm","btn-success","btn-wide",3,"hidden","click"],[1,"icon-check"],["type","button",1,"btn","btn-sm","btn-secondary","btn-wide",3,"click"],["activeIds","accordion-content-type-fields",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-content-type-fields",3,"title"],["ngbPanelContent",""],[1,"alert","alert-danger","mt-3","mb-0",3,"hidden"],[1,"modal-footer","d-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"text-center"],["class","alert alert-danger p-2",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"alert","alert-danger","p-2"],[1,"alert","alert-danger"],[3,"value"],[1,"alert","alert-danger","mb-1"],[1,"row","form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","ngModelChange"],["blockFieldList",""],[1,"text-right","mb-2",3,"hidden"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"icon-shuffle"],[1,"table-responsive"],[1,"table","table-striped","table-divided","mb-0"],["class","show-on-hover-parent",4,"ngFor","ngForOf"],[1,"table-active",3,"hidden"],["colspan","5",1,"text-center","p-3"],[3,"items","itemsChange","save","cancel"],[1,"show-on-hover-parent"],[1,"text-muted"],["outputType","boolean",3,"value"],[1,"relative"],[1,"show-on-hover-right"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"hidden","ngbTooltip","click"],[1,"icon-pencil"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"ngbTooltip","click"],[1,"icon-stack"]],template:function(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"button",2),s.ic("click",(function(e){return t.closeModal(e)})),s.Rb(3,"i",3),s.Wb(4,"span"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Vb(),s.Wb(7,"button",2),s.ic("click",(function(e){return t.minimize(e)})),s.Rb(8,"i",4),s.Wb(9,"span"),s.Oc(10),s.lc(11,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(12,"div",5),s.Wb(13,"div",6),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(e){return t.maximize(e)})),s.lc(16,"translate"),s.Rb(17,"i",9),s.Vb(),s.Wb(18,"button",10),s.ic("click",(function(e){return t.closeModal(e)})),s.lc(19,"translate"),s.Rb(20,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"h4",12),s.Oc(22),s.Vb(),s.Vb(),s.Mc(23,Qe,12,10,"ng-template",null,13,s.Nc),s.Wb(25,"form"),s.Wb(26,"div",14),s.Wb(27,"div",15),s.Wb(28,"div",16),s.Wb(29,"div",17),s.Wb(30,"label",18),s.Oc(31),s.lc(32,"translate"),s.Vb(),s.Wb(33,"input",19),s.ic("ngModelChange",(function(e){return t.model.title=e})),s.Vb(),s.Mc(34,qe,2,1,"div",20),s.Vb(),s.Wb(35,"div",17),s.Wb(36,"label",21),s.Oc(37),s.lc(38,"translate"),s.Vb(),s.Wb(39,"div",22),s.Wb(40,"input",23),s.ic("ngModelChange",(function(e){return t.model.name=e})),s.Vb(),s.Wb(41,"div",24),s.Wb(42,"button",25),s.ic("click",(function(){return t.generateName(t.model)})),s.lc(43,"translate"),s.Rb(44,"i",26),s.Vb(),s.Vb(),s.Vb(),s.Mc(45,je,2,1,"div",20),s.Vb(),s.Wb(46,"div",27),s.Wb(47,"label",18),s.Oc(48),s.lc(49,"translate"),s.Vb(),s.Wb(50,"textarea",28),s.ic("ngModelChange",(function(e){return t.model.description=e})),s.Vb(),s.Vb(),s.Wb(51,"div",29),s.Wb(52,"div",30),s.Wb(53,"div",31),s.Wb(54,"label",18),s.Oc(55),s.lc(56,"translate"),s.Vb(),s.Wb(57,"div",22),s.Wb(58,"select",32),s.ic("ngModelChange",(function(e){return t.model.collection=e})),s.Mc(59,Ge,2,2,"option",33),s.Vb(),s.Wb(60,"div",24),s.Wb(61,"button",34),s.ic("click",(function(){s.Ec(n);var e=s.Dc(70),i=s.Dc(72);return t.displayToggle(e),i.value="",t.onValueChanged(),i.focus()})),s.lc(62,"translate"),s.Rb(63,"i",35),s.Vb(),s.Vb(),s.Wb(64,"div",36,37),s.Wb(66,"button",34),s.ic("click",(function(){s.Ec(n);var e=s.Dc(65);return t.deleteCollection(e)})),s.lc(67,"translate"),s.Rb(68,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Wb(69,"div",38,39),s.Rb(71,"input",40,41),s.Mc(73,Ue,2,1,"div",42),s.Wb(74,"div",43),s.Wb(75,"button",44),s.ic("click",(function(){return t.addCollection()})),s.Oc(76),s.lc(77,"translate"),s.Vb(),s.Oc(78," \xa0 "),s.Wb(79,"button",44),s.ic("click",(function(){return s.Ec(n),s.Dc(70).style.display="none",t.formErrors.newCollection=""})),s.Oc(80),s.lc(81,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(82,"div",45),s.Wb(83,"div",30),s.Wb(84,"div",46),s.Wb(85,"div",47),s.Wb(86,"input",48),s.ic("ngModelChange",(function(e){return t.model.isActive=e})),s.Vb(),s.Wb(87,"label",49),s.Oc(88),s.lc(89,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(90,"div",50),s.Wb(91,"label",51),s.Oc(92),s.lc(93,"translate"),s.Vb(),s.Wb(94,"label",51),s.Oc(95),s.lc(96,"translate"),s.Vb(),s.Wb(97,"div",52),s.Wb(98,"div",53),s.Wb(99,"div",29),s.Wb(100,"div",54),s.Wb(101,"label"),s.Oc(102),s.lc(103,"translate"),s.Vb(),s.Vb(),s.Wb(104,"div",55),s.Wb(105,"input",56),s.ic("ngModelChange",(function(e){return t.fieldModel.title=e})),s.Vb(),s.Mc(106,Be,2,1,"div",20),s.Vb(),s.Vb(),s.Wb(107,"div",29),s.Wb(108,"div",54),s.Wb(109,"label"),s.Oc(110),s.lc(111,"translate"),s.Vb(),s.Vb(),s.Wb(112,"div",55),s.Wb(113,"div",22),s.Wb(114,"input",57),s.ic("ngModelChange",(function(e){return t.fieldModel.name=e})),s.Vb(),s.Wb(115,"div",24),s.Wb(116,"button",34),s.ic("click",(function(){return t.generateName(t.fieldModel)})),s.lc(117,"translate"),s.Rb(118,"i",26),s.Vb(),s.Vb(),s.Vb(),s.Mc(119,ze,2,1,"div",20),s.Vb(),s.Vb(),s.Wb(120,"div",45),s.Wb(121,"div",54),s.Wb(122,"label"),s.Oc(123),s.lc(124,"translate"),s.Vb(),s.Vb(),s.Wb(125,"div",55),s.Wb(126,"textarea",58),s.ic("ngModelChange",(function(e){return t.fieldModel.description=e})),s.Vb(),s.Vb(),s.Vb(),s.Wb(127,"div",29),s.Wb(128,"div",54),s.Wb(129,"label"),s.Oc(130),s.lc(131,"translate"),s.Vb(),s.Vb(),s.Wb(132,"div",55),s.Wb(133,"div",22),s.Wb(134,"select",59),s.ic("ngModelChange",(function(e){return t.fieldModel.inputType=e}))("ngModelChange",(function(){return t.selectFieldTypeProperties("input")})),s.Rb(135,"option",60),s.Mc(136,Ye,2,2,"option",33),s.Vb(),s.Wb(137,"div",24),s.Wb(138,"button",34),s.ic("click",(function(){s.Ec(n);var e=s.Dc(143);return t.displayToggle(e)})),s.lc(139,"translate"),s.Rb(140,"i",61),s.Vb(),s.Vb(),s.Vb(),s.Mc(141,$e,2,1,"div",20),s.Vb(),s.Vb(),s.Wb(142,"div",62,63),s.Wb(144,"div"),s.Wb(145,"div",64),s.Oc(146," There are no parameters. "),s.Vb(),s.Mc(147,Ke,5,4,"div",65),s.Vb(),s.Wb(148,"div",43),s.Wb(149,"button",44),s.ic("click",(function(){return s.Ec(n),s.Dc(143).style.display="none"})),s.Oc(150),s.lc(151,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(152,"div",29),s.Wb(153,"div",54),s.Wb(154,"label"),s.Oc(155),s.lc(156,"translate"),s.Vb(),s.Vb(),s.Wb(157,"div",55),s.Wb(158,"div",22),s.Wb(159,"select",66),s.ic("ngModelChange",(function(e){return t.fieldModel.outputType=e}))("ngModelChange",(function(){return t.selectFieldTypeProperties("output")})),s.Rb(160,"option",60),s.Mc(161,He,2,2,"option",33),s.Vb(),s.Wb(162,"div",24),s.Wb(163,"button",34),s.ic("click",(function(){s.Ec(n);var e=s.Dc(168);return t.displayToggle(e)})),s.lc(164,"translate"),s.Rb(165,"i",61),s.Vb(),s.Vb(),s.Vb(),s.Mc(166,Je,2,1,"div",20),s.Vb(),s.Vb(),s.Wb(167,"div",62,67),s.Wb(169,"div",64),s.Oc(170," There are no parameters. "),s.Vb(),s.Mc(171,Ze,5,4,"div",65),s.Wb(172,"div",43),s.Wb(173,"button",44),s.ic("click",(function(){return s.Ec(n),s.Dc(168).style.display="none"})),s.Oc(174),s.lc(175,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(176,"div",45),s.Wb(177,"div",54),s.Wb(178,"label"),s.Oc(179),s.lc(180,"translate"),s.Vb(),s.Vb(),s.Wb(181,"div",55),s.Wb(182,"div",68),s.Wb(183,"div",69),s.Wb(184,"select",70),s.ic("ngModelChange",(function(e){return t.fieldModel.group=e})),s.Rb(185,"option",60),s.Mc(186,et,2,2,"option",33),s.Vb(),s.Wb(187,"div",24),s.Wb(188,"button",34),s.ic("click",(function(){s.Ec(n);var e=s.Dc(197),i=s.Dc(199);return t.displayToggle(e),i.value="",i.focus()})),s.lc(189,"translate"),s.Rb(190,"i",35),s.Vb(),s.Vb(),s.Wb(191,"div",24),s.Wb(192,"button",34),s.ic("click",(function(){return t.deleteGroup()})),s.lc(193,"translate"),s.Rb(194,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Mc(195,tt,2,1,"div",20),s.Wb(196,"div",38,71),s.Rb(198,"input",72,73),s.Mc(200,nt,2,1,"div",42),s.Wb(201,"div",43),s.Wb(202,"button",44),s.ic("click",(function(){return t.addGroup()})),s.Oc(203),s.lc(204,"translate"),s.Vb(),s.Oc(205," \xa0 "),s.Wb(206,"button",44),s.ic("click",(function(){return s.Ec(n),s.Dc(197).style.display="none",t.formErrors.fld_newGroup=""})),s.Oc(207),s.lc(208,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(209,"div",74),s.Wb(210,"div",75),s.Wb(211,"div",76),s.Wb(212,"input",77),s.ic("ngModelChange",(function(e){return t.fieldModel.required=e})),s.Vb(),s.Wb(213,"label",49),s.Oc(214),s.lc(215,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(216,"div",74),s.Wb(217,"div",75),s.Wb(218,"div",76),s.Wb(219,"input",78),s.ic("ngModelChange",(function(e){return t.fieldModel.showInTable=e})),s.Vb(),s.Wb(220,"label",49),s.Oc(221),s.lc(222,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(223,"div",74),s.Wb(224,"div",75),s.Wb(225,"div",76),s.Wb(226,"input",79),s.ic("ngModelChange",(function(e){return t.fieldModel.showInList=e})),s.Vb(),s.Wb(227,"label",49),s.Oc(228),s.lc(229,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(230,"div",74),s.Wb(231,"div",75),s.Wb(232,"div",76),s.Wb(233,"input",80),s.ic("ngModelChange",(function(e){return t.fieldModel.isFilter=e})),s.Vb(),s.Wb(234,"label",49),s.Oc(235),s.lc(236,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(237,"div",81),s.Wb(238,"button",82),s.ic("click",(function(){return t.errorFieldMessage=""})),s.Wb(239,"span",83),s.Oc(240,"\xd7"),s.Vb(),s.Vb(),s.Oc(241),s.Vb(),s.Wb(242,"div",84),s.Wb(243,"button",85),s.ic("click",(function(){return t.submitField()})),s.Rb(244,"i",35),s.Oc(245),s.lc(246,"translate"),s.Vb(),s.Wb(247,"button",86),s.ic("click",(function(){return t.submitField()})),s.Rb(248,"i",87),s.Oc(249),s.lc(250,"translate"),s.Vb(),s.Oc(251," \xa0 "),s.Wb(252,"button",88),s.ic("click",(function(){return t.editFieldCancel()})),s.Oc(253),s.lc(254,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(255,"ngb-accordion",89,90),s.Wb(257,"ngb-panel",91),s.lc(258,"translate"),s.Mc(259,ot,44,31,"ng-template",92),s.Vb(),s.Vb(),s.Wb(260,"div",93),s.Wb(261,"button",82),s.ic("click",(function(){return t.errorMessage=""})),s.Wb(262,"span",83),s.Oc(263,"\xd7"),s.Vb(),s.Vb(),s.Oc(264),s.Vb(),s.Vb(),s.Wb(265,"div",94),s.Wb(266,"div",95),s.Wb(267,"button",96),s.ic("click",(function(e){return t.save(!0,e)})),s.Wb(268,"span"),s.Oc(269),s.lc(270,"translate"),s.Vb(),s.Vb(),s.Wb(271,"div",97),s.Rb(272,"button",98),s.Wb(273,"div",99),s.Wb(274,"button",100),s.ic("click",(function(e){return t.save(!1,e)})),s.Oc(275),s.lc(276,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(277,"button",101),s.ic("click",(function(e){return t.closeModal(e)})),s.Wb(278,"span"),s.Oc(279),s.lc(280,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=s.Dc(24);s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(6,139,"CLOSE")),s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(11,141,"MINIMIZE")),s.Db(5),s.rc("title",s.mc(16,143,"EXPAND")),s.Db(3),s.rc("title",s.mc(19,145,"CLOSE")),s.Db(4),s.Pc(t.modalTitle),s.Db(3),s.Ib("loading",t.loading),s.Db(3),s.rc("formGroup",t.form),s.Db(3),s.Qc(" ",s.mc(32,147,"TITLE")," "),s.Db(2),s.Ib("is-invalid",t.formErrors.title),s.rc("ngModel",t.model.title),s.Db(1),s.rc("ngIf",t.formErrors.title),s.Db(3),s.Qc(" ",s.mc(38,149,"SYSTEM_NAME")," "),s.Db(2),s.Ib("is-invalid",t.formErrors.name),s.Db(1),s.Ib("is-invalid",t.formErrors.name),s.rc("ngModel",t.model.name),s.Db(2),s.sc("ngbTooltip",s.mc(43,151,"GENERATE")),s.Db(3),s.rc("ngIf",t.formErrors.name),s.Db(3),s.Qc(" ",s.mc(49,153,"DESCRIPTION")," "),s.Db(2),s.rc("ngModel",t.model.description),s.Db(5),s.Pc(s.mc(56,155,"COLLECTION")),s.Db(2),s.Ib("is-invalid",t.formErrors.collection),s.Db(1),s.Ib("is-invalid",t.formErrors.collection),s.rc("ngModel",t.model.collection),s.Db(1),s.rc("ngForOf",t.collections),s.Db(2),s.sc("ngbTooltip",s.mc(62,157,"ADD_COLLECTION")),s.Db(3),s.rc("ngbPopover",i),s.Db(2),s.sc("ngbTooltip",s.mc(67,159,"DELETE")),s.Db(5),s.Ib("is-invalid",t.formErrors.newCollection),s.Db(2),s.rc("ngIf",t.formErrors.newCollection),s.Db(3),s.Qc(" ",s.mc(77,161,"ADD")," "),s.Db(4),s.Qc(" ",s.mc(81,163,"CANCEL")," "),s.Db(6),s.tc("id","fieldIsActive",t.uniqueId,""),s.rc("ngModel",t.model.isActive),s.Db(1),s.tc("for","fieldIsActive",t.uniqueId,""),s.Db(1),s.Pc(s.mc(89,165,"ACTIVE")),s.Db(2),s.rc("formGroup",t.fieldForm),s.Db(1),s.rc("hidden","add_field"!=t.action),s.Db(1),s.Qc(" ",s.mc(93,167,"ADD_FIELD")," "),s.Db(2),s.rc("hidden","edit_field"!=t.action),s.Db(1),s.Qc(" ",s.mc(96,169,"EDIT_FIELD")," "),s.Db(7),s.Pc(s.mc(103,171,"TITLE")),s.Db(3),s.Ib("is-invalid",t.formErrors.fld_title),s.rc("ngModel",t.fieldModel.title),s.Db(1),s.rc("ngIf",t.formErrors.fld_title),s.Db(4),s.Pc(s.mc(111,173,"SYSTEM_NAME")),s.Db(3),s.Ib("is-invalid",t.formErrors.fld_name),s.Db(1),s.Ib("is-invalid",t.formErrors.fld_name),s.rc("ngModel",t.fieldModel.name),s.Db(2),s.sc("ngbTooltip",s.mc(117,175,"GENERATE")),s.Db(3),s.rc("ngIf",t.formErrors.fld_name),s.Db(4),s.Pc(s.mc(124,177,"DESCRIPTION")),s.Db(3),s.rc("ngModel",t.fieldModel.description),s.Db(4),s.Pc(s.mc(131,179,"INPUT_TYPE")),s.Db(3),s.Ib("is-invalid",t.formErrors.fld_inputType),s.Db(1),s.Ib("is-invalid",t.formErrors.fld_inputType),s.rc("ngModel",t.fieldModel.inputType)("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.inputType,"description")),s.Db(2),s.rc("ngForOf",t.fieldTypes),s.Db(2),s.sc("ngbTooltip",s.mc(139,181,"OPTIONS")),s.Db(3),s.rc("ngIf",t.formErrors.fld_inputType),s.Db(1),s.rc("hidden",!t.fieldModel.inputType),s.Db(3),s.rc("hidden",t.fieldTypeProperties.input.length>0),s.Db(2),s.rc("ngForOf",t.fieldTypeProperties.input),s.Db(3),s.Qc(" ",s.mc(151,183,"CLOSE")," "),s.Db(5),s.Pc(s.mc(156,185,"OUTPUT_TYPE")),s.Db(3),s.Ib("is-invalid",t.formErrors.fld_outputType),s.Db(1),s.Ib("is-invalid",t.formErrors.fld_outputType),s.rc("ngModel",t.fieldModel.outputType)("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.outputType,"description")),s.Db(2),s.rc("ngForOf",t.fieldTypes),s.Db(2),s.sc("ngbTooltip",s.mc(164,187,"OPTIONS")),s.Db(3),s.rc("ngIf",t.formErrors.fld_outputType),s.Db(1),s.rc("hidden",!t.fieldModel.outputType),s.Db(2),s.rc("hidden",t.fieldTypeProperties.output.length>0),s.Db(2),s.rc("ngForOf",t.fieldTypeProperties.output),s.Db(3),s.Qc(" ",s.mc(175,189,"CLOSE")," "),s.Db(5),s.Pc(s.mc(180,191,"GROUP")),s.Db(4),s.Ib("is-invalid",t.formErrors.fld_group),s.Db(1),s.Ib("is-invalid",t.formErrors.fld_group),s.rc("ngModel",t.fieldModel.group),s.Db(2),s.rc("ngForOf",t.model.groups),s.Db(2),s.sc("ngbTooltip",s.mc(189,193,"ADD_GROUP")),s.Db(4),s.sc("ngbTooltip",s.mc(193,195,"DELETE_GROUP")),s.Db(3),s.rc("ngIf",t.formErrors.fld_group),s.Db(3),s.Ib("is-invalid",t.formErrors.fld_newGroup),s.Db(2),s.rc("ngIf",t.formErrors.fld_newGroup),s.Db(3),s.Qc(" ",s.mc(204,197,"ADD")," "),s.Db(4),s.Qc(" ",s.mc(208,199,"CANCEL")," "),s.Db(5),s.tc("id","fieldRequired",t.uniqueId,""),s.rc("ngModel",t.fieldModel.required),s.Db(1),s.tc("for","fieldRequired",t.uniqueId,""),s.Db(1),s.Pc(s.mc(215,201,"REQUIRED")),s.Db(5),s.tc("id","fieldShowInTable",t.uniqueId,""),s.rc("ngModel",t.fieldModel.showInTable),s.Db(1),s.tc("for","fieldShowInTable",t.uniqueId,""),s.Db(1),s.Pc(s.mc(222,203,"SHOW_IN_TABLE")),s.Db(5),s.tc("id","fieldShowInList",t.uniqueId,""),s.rc("ngModel",t.fieldModel.showInList),s.Db(1),s.tc("for","fieldShowInList",t.uniqueId,""),s.Db(1),s.Pc(s.mc(229,205,"SHOW_IN_LIST")),s.Db(5),s.tc("id","fieldIsFilter",t.uniqueId,""),s.rc("ngModel",t.fieldModel.isFilter),s.Db(1),s.tc("for","fieldIsFilter",t.uniqueId,""),s.Db(1),s.Pc(s.mc(236,207,"SHOW_IN_FILTER")),s.Db(2),s.rc("hidden",!t.errorFieldMessage),s.Db(4),s.Qc(" ",t.errorFieldMessage," "),s.Db(2),s.rc("hidden","add_field"!=t.action),s.Db(2),s.Qc(" ",s.mc(246,209,"ADD_FIELD")," "),s.Db(2),s.rc("hidden","edit_field"!=t.action),s.Db(2),s.Qc(" ",s.mc(250,211,"SAVE_FIELD")," "),s.Db(4),s.Qc(" ",s.mc(254,213,"CANCEL")," "),s.Db(2),s.rc("closeOthers",!0),s.Db(2),s.rc("title",s.mc(258,215,"FIELDS")),s.Db(3),s.rc("hidden",!t.errorMessage),s.Db(4),s.Qc(" ",t.errorMessage," "),s.Db(3),s.rc("disabled",t.submitted),s.Db(2),s.Pc(s.mc(270,217,"SAVE_AND_CLOSE")),s.Db(3),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(276,219,"SAVE")),s.Db(4),s.Pc(s.mc(280,221,"CLOSE"))}},directives:[g.y,g.o,g.p,g.h,g.b,g.n,g.g,l.p,M.u,g.v,l.o,M.m,g.a,g.r,g.x,M.a,M.k,M.l,M.d,M.g,M.f,M.e,g.q,_e.a,Le.a],pipes:[d.c],encapsulation:2}),lt),st=((rt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r){var l;return _classCallCheck(this,n),(l=t.call(this,e,i,o,r)).dataService=e,l.activeModal=i,l.modalService=o,l.translateService=r,l.title="\u0422\u0438\u043f\u044b \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430",l.queryOptions=new N.a("name","asc",1,10,0,0),l.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"collection",sortName:"collection",title:"COLLECTION",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}],l}return _createClass(n,[{key:"getModalContent",value:function(){return ct}},{key:"getModalElementId",value:function(e){return["modal","content_type",e||0].join("-")}},{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_get(_getPrototypeOf(n.prototype),"setModalInputs",this).call(this,e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?"".concat(this.getLangString("CONTENT_TYPE")," #").concat(e):this.getLangString("ADD_CONTENT_TYPE")}}]),n}(h.a)).\u0275fac=function(e){return new(e||rt)(s.Qb(k.a),s.Qb(M.b),s.Qb(M.h),s.Qb(d.d))},rt.\u0275cmp=s.Kb({type:rt,selectors:[["app-shk-content-types"]],features:[s.Ab],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"a",2),s.Rb(3,"i",3),s.Oc(4," \xa0 "),s.Wb(5,"span"),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(8,"div",4),s.Wb(9,"div",5),s.Wb(10,"button",6),s.Wb(11,"span"),s.Oc(12),s.lc(13,"translate"),s.Vb(),s.Vb(),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(){return t.blockSelected()})),s.Oc(16),s.lc(17,"translate"),s.Vb(),s.Wb(18,"button",8),s.ic("click",(function(){return t.deleteSelected()})),s.Oc(19),s.lc(20,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"button",9),s.ic("click",(function(){return t.modalOpen()})),s.Rb(22,"i",10),s.Oc(23," \xa0 "),s.Wb(24,"span"),s.Oc(25),s.lc(26,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Rb(27,"div",11),s.Vb(),s.Wb(28,"app-table",12,13),s.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),s.Vb()),2&e&&(s.Db(2),s.rc("routerLink",s.vc(23,at)),s.Db(4),s.Pc(s.mc(7,13,"CATALOG")),s.Db(6),s.Pc(s.mc(13,15,"BATCH_ACTIONS")),s.Db(4),s.Pc(s.mc(17,17,"DISABLE_ENABLE")),s.Db(3),s.Pc(s.mc(20,19,"DELETE")),s.Db(6),s.Pc(s.mc(26,21,"ADD")),s.Db(3),s.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[c.e,M.d,M.g,M.f,Ee.a],pipes:[d.c],encapsulation:2}),rt),dt=function e(t,n,i,o,r,l,a){_classCallCheck(this,e),this.id=t,this.name=n,this.title=i,this.description=o,this.isActive=r,this.inputProperties=l,this.outputProperties=a};function bt(e,t){if(1&e&&(s.Wb(0,"div",52),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.title," ")}}function ut(e,t){if(1&e&&(s.Wb(0,"div",52),s.Oc(1),s.Vb()),2&e){var n=s.kc();s.Db(1),s.Qc(" ",n.formErrors.name," ")}}var mt=function(e){return{"is-invalid":e}};function ft(e,t){if(1&e){var n=s.Xb();s.Wb(0,"tr",61),s.Wb(1,"td"),s.Rb(2,"input",62),s.Vb(),s.Wb(3,"td",63),s.Rb(4,"input",64),s.Vb(),s.Wb(5,"td",63),s.Rb(6,"input",65),s.Vb(),s.Wb(7,"td",63),s.Wb(8,"button",66),s.ic("click",(function(e){s.Ec(n);var i=t.index;return s.kc(3).arrayFieldDelete("inputProperties",i,e)})),s.lc(9,"translate"),s.Rb(10,"i",11),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit;s.rc("formGroupName",t.index+""),s.Db(2),s.rc("ngClass",s.wc(7,mt,i.controls.name.touched&&!i.controls.name.valid)),s.Db(2),s.rc("ngClass",s.wc(9,mt,i.controls.title.touched&&!i.controls.title.valid)),s.Db(2),s.rc("ngClass",s.wc(11,mt,i.controls.default_value.touched&&!i.controls.default_value.valid)),s.Db(2),s.sc("ngbTooltip",s.mc(9,5,"DELETE"))}}function pt(e,t){if(1&e&&(s.Wb(0,"tbody"),s.Mc(1,ft,11,13,"tr",60),s.Vb()),2&e){var n=s.kc(2);s.Db(1),s.rc("ngForOf",n.arrayFields.inputProperties.controls)}}function ht(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",53),s.Wb(1,"table",54),s.Wb(2,"thead"),s.Wb(3,"tr"),s.Wb(4,"th"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Wb(7,"th"),s.Oc(8),s.lc(9,"translate"),s.Vb(),s.Wb(10,"th"),s.Oc(11),s.lc(12,"translate"),s.Vb(),s.Rb(13,"th"),s.Vb(),s.Vb(),s.Mc(14,pt,2,1,"tbody",55),s.Wb(15,"tfoot"),s.Wb(16,"tr",56),s.Wb(17,"td",57),s.Wb(18,"button",58),s.ic("click",(function(e){return s.Ec(n),s.kc().arrayFieldAdd("inputProperties",e)})),s.Rb(19,"i",59),s.Oc(20," \xa0 "),s.Wb(21,"span"),s.Oc(22),s.lc(23,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=s.kc();s.Db(5),s.Qc(" ",s.mc(6,5,"SYSTEM_NAME")," "),s.Db(3),s.Qc(" ",s.mc(9,7,"TITLE")," "),s.Db(3),s.Qc(" ",s.mc(12,9,"DEFAULT_VALUE")," "),s.Db(3),s.rc("ngIf",i.arrayFields.inputProperties),s.Db(8),s.Pc(s.mc(23,11,"ADD"))}}function gt(e,t){if(1&e){var n=s.Xb();s.Wb(0,"tr",61),s.Wb(1,"td"),s.Rb(2,"input",62),s.Vb(),s.Wb(3,"td",63),s.Rb(4,"input",64),s.Vb(),s.Wb(5,"td",63),s.Rb(6,"input",65),s.Vb(),s.Wb(7,"td",63),s.Wb(8,"button",66),s.ic("click",(function(e){s.Ec(n);var i=t.index;return s.kc(3).arrayFieldDelete("outputProperties",i,e)})),s.lc(9,"translate"),s.Rb(10,"i",11),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit;s.rc("formGroupName",t.index+""),s.Db(2),s.rc("ngClass",s.wc(7,mt,i.controls.name.touched&&!i.controls.name.valid)),s.Db(2),s.rc("ngClass",s.wc(9,mt,i.controls.title.touched&&!i.controls.title.valid)),s.Db(2),s.rc("ngClass",s.wc(11,mt,i.controls.default_value.touched&&!i.controls.default_value.valid)),s.Db(2),s.sc("ngbTooltip",s.mc(9,5,"DELETE"))}}function vt(e,t){if(1&e&&(s.Wb(0,"tbody"),s.Mc(1,gt,11,13,"tr",60),s.Vb()),2&e){var n=s.kc(2);s.Db(1),s.rc("ngForOf",n.arrayFields.outputProperties.controls)}}function yt(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",67),s.Wb(1,"table",54),s.Wb(2,"thead"),s.Wb(3,"tr"),s.Wb(4,"th"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Wb(7,"th"),s.Oc(8),s.lc(9,"translate"),s.Vb(),s.Wb(10,"th"),s.Oc(11),s.lc(12,"translate"),s.Vb(),s.Rb(13,"th"),s.Vb(),s.Vb(),s.Mc(14,vt,2,1,"tbody",55),s.Wb(15,"tfoot"),s.Wb(16,"tr",56),s.Wb(17,"td",57),s.Wb(18,"button",58),s.ic("click",(function(e){return s.Ec(n),s.kc().arrayFieldAdd("outputProperties",e)})),s.Rb(19,"i",59),s.Oc(20," \xa0 "),s.Wb(21,"span"),s.Oc(22),s.lc(23,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=s.kc();s.Db(5),s.Qc(" ",s.mc(6,5,"SYSTEM_NAME")," "),s.Db(3),s.Qc(" ",s.mc(9,7,"TITLE")," "),s.Db(3),s.Qc(" ",s.mc(12,9,"DEFAULT_VALUE")," "),s.Db(3),s.rc("ngIf",i.arrayFields.outputProperties),s.Db(8),s.Pc(s.mc(23,11,"ADD"))}}function Dt(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",68),s.Wb(1,"button",69),s.ic("click",(function(){return s.Ec(n),s.kc().errorMessage=""})),s.Wb(2,"span",70),s.Oc(3,"\xd7"),s.Vb(),s.Vb(),s.Oc(4),s.Vb()}if(2&e){var i=s.kc();s.Db(4),s.Qc(" ",i.errorMessage," ")}}var Ct,kt,Vt,It=function(e){return{"no-events":e}},Wt=function(){return["/catalog"]},Ot=((Ct=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r,l,a){var c;return _classCallCheck(this,n),(c=t.call(this,e,i,o,r,l)).fb=e,c.activeModal=i,c.translateService=o,c.dataService=r,c.elRef=l,c.systemNameService=a,c.model=new dt(0,"","","",!0,[],[]),c.formFields=[{name:"title",validators:[g.w.required]},{name:"name",validators:[g.w.required,g.w.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"isActive",validators:[]},{name:"inputProperties",validators:[],children:[{name:"name",validators:[g.w.required]},{name:"title",validators:[g.w.required]},{name:"default_value",validators:[]}]},{name:"outputProperties",validators:[],children:[{name:"name",validators:[g.w.required]},{name:"title",validators:[g.w.required]},{name:"default_value",validators:[]}]}],c}return _createClass(n,[{key:"generateName",value:function(e,t){t&&t.preventDefault();var n=this.getControl(this.form,null,"title").value||"";e.name=this.systemNameService.generateName(n),this.getControl(this.form,null,"name").setValue(e.name)}}]),n}(U.a)).\u0275fac=function(e){return new(e||Ct)(s.Qb(g.e),s.Qb(M.b),s.Qb(d.d),s.Qb(Re),s.Qb(s.l),s.Qb(D.a))},Ct.\u0275cmp=s.Kb({type:Ct,selectors:[["app-field-type-modal-content"]],features:[s.Ab],decls:84,vars:68,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-md-6"],[1,"form-group","form-group-message","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","formControlName","title","id","fieldTitle",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"form-group","form-group-message"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group","row"],[1,"col-12"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"],[1,"form-group"],["for","fieldDescription",1,"label-filled"],["rows","5","name","description","formControlName","description","id","fieldDescription",1,"form-control"],["activeIds","accordion-input-options",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-input-options",3,"title"],["ngbPanelContent",""],["id","accordion-output-options",3,"title"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],["formArrayName","inputProperties"],[1,"table","table-bordered","table-divided","mb-0"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],[1,"text-center"],["type","text","formControlName","title",1,"form-control",3,"ngClass"],["type","text","formControlName","default_value",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["formArrayName","outputProperties"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"button",2),s.ic("click",(function(e){return t.closeModal(e)})),s.Rb(3,"i",3),s.Wb(4,"span"),s.Oc(5),s.lc(6,"translate"),s.Vb(),s.Vb(),s.Wb(7,"button",2),s.ic("click",(function(e){return t.minimize(e)})),s.Rb(8,"i",4),s.Wb(9,"span"),s.Oc(10),s.lc(11,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(12,"div",5),s.Wb(13,"div",6),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(e){return t.maximize(e)})),s.lc(16,"translate"),s.Rb(17,"i",9),s.Vb(),s.Wb(18,"button",10),s.ic("click",(function(e){return t.closeModal(e)})),s.lc(19,"translate"),s.Rb(20,"i",11),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"h4",12),s.Oc(22),s.Vb(),s.Vb(),s.Wb(23,"form",13,14),s.ic("ngSubmit",(function(){return t.onSubmit()})),s.Wb(25,"div",15),s.Wb(26,"div",16),s.Wb(27,"div",17),s.Wb(28,"div",18),s.Wb(29,"label",19),s.Oc(30),s.lc(31,"translate"),s.Vb(),s.Rb(32,"input",20),s.Mc(33,bt,2,1,"div",21),s.Vb(),s.Wb(34,"div",22),s.Wb(35,"label",23),s.Oc(36),s.lc(37,"translate"),s.Vb(),s.Wb(38,"div",24),s.Rb(39,"input",25),s.Wb(40,"div",26),s.Wb(41,"button",27),s.ic("click",(function(){return t.generateName(t.model)})),s.lc(42,"translate"),s.Rb(43,"i",28),s.Vb(),s.Vb(),s.Vb(),s.Mc(44,ut,2,1,"div",21),s.Vb(),s.Wb(45,"div",29),s.Wb(46,"div",30),s.Wb(47,"div",31),s.Wb(48,"div",32),s.Rb(49,"input",33),s.Wb(50,"label",34),s.Oc(51),s.lc(52,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(53,"div",17),s.Wb(54,"div",35),s.Wb(55,"label",36),s.Oc(56),s.lc(57,"translate"),s.Vb(),s.Rb(58,"textarea",37),s.Vb(),s.Vb(),s.Vb(),s.Wb(59,"ngb-accordion",38,39),s.Wb(61,"ngb-panel",40),s.lc(62,"translate"),s.Mc(63,ht,24,13,"ng-template",41),s.Vb(),s.Wb(64,"ngb-panel",42),s.lc(65,"translate"),s.Mc(66,yt,24,13,"ng-template",41),s.Vb(),s.Vb(),s.Mc(67,Dt,5,1,"div",43),s.Vb(),s.Wb(68,"div",44),s.Wb(69,"div",45),s.Wb(70,"button",46),s.ic("click",(function(e){return t.save(!0,e)})),s.Wb(71,"span"),s.Oc(72),s.lc(73,"translate"),s.Vb(),s.Vb(),s.Wb(74,"div",47),s.Rb(75,"button",48),s.Wb(76,"div",49),s.Wb(77,"button",50),s.ic("click",(function(e){return t.save(!1,e)})),s.Oc(78),s.lc(79,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb(),s.Wb(80,"button",51),s.ic("click",(function(e){return t.closeModal(e)})),s.Wb(81,"span"),s.Oc(82),s.lc(83,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Vb()),2&e&&(s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(6,32,"CLOSE")),s.Db(2),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(11,34,"MINIMIZE")),s.Db(5),s.rc("title",s.mc(16,36,"EXPAND")),s.Db(3),s.rc("title",s.mc(19,38,"CLOSE")),s.Db(4),s.Pc(t.modalTitle),s.Db(1),s.rc("formGroup",t.form)("ngClass",s.wc(60,It,t.submitted)),s.Db(2),s.Ib("loading",t.loading),s.Db(5),s.Pc(s.mc(31,40,"TITLE")),s.Db(2),s.rc("ngClass",s.wc(62,mt,t.form.controls.title.touched&&!t.form.controls.title.valid)),s.Db(1),s.rc("ngIf",t.formErrors.title),s.Db(3),s.Pc(s.mc(37,42,"SYSTEM_NAME")),s.Db(2),s.rc("ngClass",s.wc(64,mt,t.form.controls.name.touched&&!t.form.controls.name.valid)),s.Db(1),s.rc("ngClass",s.wc(66,mt,t.form.controls.name.touched&&!t.form.controls.name.valid)),s.Db(2),s.sc("ngbTooltip",s.mc(42,44,"GENERATE")),s.Db(3),s.rc("ngIf",t.formErrors.name),s.Db(5),s.tc("id","fieldIsActive",t.uniqueId,""),s.Db(1),s.tc("for","fieldIsActive",t.uniqueId,""),s.Db(1),s.Pc(s.mc(52,46,"ACTIVE")),s.Db(5),s.Pc(s.mc(57,48,"DESCRIPTION")),s.Db(3),s.rc("closeOthers",!1),s.Db(2),s.rc("title",s.mc(62,50,"INPUT_OPTIONS")),s.Db(3),s.rc("title",s.mc(65,52,"OUTPUT_OPTIONS")),s.Db(3),s.rc("ngIf",t.errorMessage),s.Db(3),s.rc("disabled",t.submitted),s.Db(2),s.Pc(s.mc(73,54,"SAVE_AND_CLOSE")),s.Db(3),s.rc("disabled",t.submitted),s.Db(3),s.Pc(s.mc(79,56,"SAVE")),s.Db(4),s.Pc(s.mc(83,58,"CLOSE")))},directives:[g.y,g.o,g.h,l.n,g.b,g.n,g.g,l.p,M.u,g.a,M.a,M.k,M.l,M.d,M.g,M.f,M.e,g.d,l.o,g.i],pipes:[d.c],encapsulation:2}),Ct),Et=[{path:"",component:m,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:Te},{path:"content_types",component:st},{path:"field_types",component:(kt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,r){var l;return _classCallCheck(this,n),(l=t.call(this,e,i,o,r)).dataService=e,l.activeModal=i,l.modalService=o,l.translateService=r,l.title="Field types",l.queryOptions=new N.a("name","asc",1,10,0,0),l.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}],l}return _createClass(n,[{key:"setModalInputs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_get(_getPrototypeOf(n.prototype),"setModalInputs",this).call(this,e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?"".concat(this.getLangString("FIELD_TYPE")," #").concat(e):this.getLangString("ADD_FIELD_TYPE")}},{key:"getModalElementId",value:function(e){return["modal","field_type",e||0].join("-")}},{key:"getModalContent",value:function(){return Ot}}]),n}(h.a),kt.\u0275fac=function(e){return new(e||kt)(s.Qb(Re),s.Qb(M.b),s.Qb(M.h),s.Qb(d.d))},kt.\u0275cmp=s.Kb({type:kt,selectors:[["app-shk-field-types"]],features:[s.Ab],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"div",1),s.Wb(2,"a",2),s.Rb(3,"i",3),s.Oc(4," \xa0 "),s.Wb(5,"span"),s.Oc(6),s.lc(7,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(8,"div",4),s.Wb(9,"div",5),s.Wb(10,"button",6),s.Wb(11,"span"),s.Oc(12),s.lc(13,"translate"),s.Vb(),s.Vb(),s.Wb(14,"div",7),s.Wb(15,"button",8),s.ic("click",(function(){return t.blockSelected()})),s.Oc(16),s.lc(17,"translate"),s.Vb(),s.Wb(18,"button",8),s.ic("click",(function(){return t.deleteSelected()})),s.Oc(19),s.lc(20,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Wb(21,"button",9),s.ic("click",(function(){return t.modalOpen()})),s.Rb(22,"i",10),s.Oc(23," \xa0 "),s.Wb(24,"span"),s.Oc(25),s.lc(26,"translate"),s.Vb(),s.Vb(),s.Vb(),s.Rb(27,"div",11),s.Vb(),s.Wb(28,"app-table",12,13),s.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),s.Vb()),2&e&&(s.Db(2),s.rc("routerLink",s.vc(23,Wt)),s.Db(4),s.Pc(s.mc(7,13,"CATALOG")),s.Db(6),s.Pc(s.mc(13,15,"BATCH_ACTIONS")),s.Db(4),s.Pc(s.mc(17,17,"DISABLE_ENABLE")),s.Db(3),s.Pc(s.mc(20,19,"DELETE")),s.Db(6),s.Pc(s.mc(26,21,"ADD")),s.Db(3),s.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[c.e,M.d,M.g,M.f,Ee.a],pipes:[d.c],encapsulation:2}),kt)}]}],Tt=((Vt=function e(){_classCallCheck(this,e)}).\u0275mod=s.Ob({type:Vt}),Vt.\u0275inj=s.Nb({factory:function(e){return new(e||Vt)},imports:[[c.f.forChild(Et)],c.f]}),Vt);n.d(t,"CatalogModule",(function(){return St}));var Mt,St=((Mt=function e(){_classCallCheck(this,e)}).\u0275mod=s.Ob({type:Mt}),Mt.\u0275inj=s.Nb({factory:function(e){return new(e||Mt)},providers:[W,Re,we,O],imports:[[l.c,a.a,Tt]]}),Mt)},BWxc:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("JIr8"),o=n("7AsP"),r=n("fXoL"),l=n("tk/3"),a=function(){var e=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).setRequestUrl("/admin/content_types"),i}return _createClass(n,[{key:"getItemByName",value:function(e){var t=this.getRequestUrl()+"/by_name/"+e;return this.http.get(t).pipe(Object(i.a)(this.handleError()))}}]),n}(o.a);return e.\u0275fac=function(t){return new(t||e)(r.ec(l.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},bbPC:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("3Pt+"),o=n("XNiG"),r=n("1G5W"),l=n("pvw1"),a=n("fXoL"),c=n("7AsP"),s=n("qbpQ"),d=n("1kSV"),b=n("sYmb"),u=function(){var e=function(){function e(t,n,i,r,l,a,c){_classCallCheck(this,e),this.fb=t,this.dataService=n,this.systemNameService=i,this.activeModal=r,this.tooltipConfig=l,this.translateService=a,this.elRef=c,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new o.a,l.placement="bottom",l.container="body",l.triggers="hover click"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then((function(){e.onAfterGetData()})):this.onAfterGetData(),this.onAfterInit()}},{key:"onBeforeInit",value:function(){}},{key:"onAfterInit",value:function(){}},{key:"onAfterGetData",value:function(){}},{key:"getSystemFieldName",value:function(){return"name"}},{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"getModelData",value:function(){var e=this;return this.loading=!0,new Promise((function(t,n){e.dataService.getItem(e.itemId).pipe(Object(r.a)(e.destroyed$)).subscribe({next:function(n){e.isItemCopy&&(n.id=null,n[e.getSystemFieldName()]=""),e.model=n,e.loading=!1,t(n)},error:function(t){e.errorMessage=t.error||e.getLangString("ERROR"),e.loading=!1,n(t)}})}))}},{key:"buildForm",value:function(){var e=this,t=this.buildControls(this.formFields,"model");this.form=this.fb.group(t),this.form.valueChanges.pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(t){return e.onValueChanged("form","",t)}})}},{key:"buildControls",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o={};for(var r in e)if(e.hasOwnProperty(r)){var l=e[r],a=l.dataKey?this[t][l.dataKey]:this[t];a[r]||(a[r]=l.value),o[r]=new i.f({value:a[r]||"",disabled:l.disabled||!1},l.validators),this.formErrors[n+r]="",this.translateValidationMessages(n,r,l)}return o}},{key:"translateValidationMessages",value:function(e,t,n){var o=this,r={};n.fieldLabel&&(Object.keys(n.messages).forEach((function(e){"required"!==e&&o.translateService.get(String(n.messages[e])).subscribe((function(t){r[e]=t}))})),n.validators.indexOf(i.w.required)>-1&&this.translateService.get(n.fieldLabel).subscribe((function(e){o.translateService.get("FIELD_REQUIRED",{name:e}).subscribe((function(e){r.required=e}))})),this.validationMessages[e+t]=r)}},{key:"getControl",value:function(e){return this.form.controls.name}},{key:"onValueChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";arguments.length>2&&arguments[2];if(this[e]){var n=this[e].value;for(var i in n)if(n.hasOwnProperty(i)){this.formErrors[t+i]="";var o=this[e].get(i);if(o&&(o.dirty||this[t+"submitted"])&&!o.valid)for(var r in o.errors)this.formErrors[t+i]+=this.validationMessages[t+i][r]?this.validationMessages[t+i][r]+" ":this.getLangString("ERROR")+" "}}}},{key:"displayToggle",value:function(e,t){e.style.display=(t=t||"none"===e.style.display)?"block":"none"}},{key:"toggleAccordion",value:function(e,t,n){e.activeIds.indexOf(t)>-1&&n||e.toggle(t)}},{key:"generateName",value:function(e){e.name=this.systemNameService.generateName(e.title||"")}},{key:"closeModal",value:function(e){e&&e.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}},{key:"close",value:function(e){e&&e.preventDefault(),this.activeModal.dismiss(this.closeReason)}},{key:"minimize",value:function(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),n.classList.add("d-none")}},{key:"maximize",value:function(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),n.classList.remove("d-none")}},{key:"getFormData",value:function(){var e=this,t={};return Object.keys(this.model).forEach((function(n){t[n]=e.files[n]?Array.isArray(e.model[n])?[l.a.getFileData(e.files[n])]:l.a.getFileData(e.files[n]):e.model[n]})),t}},{key:"fileChange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.target.files;i.length>0&&(this.model[t]=n?[l.a.getFileData(i[0])]:l.a.getFileData(i[0]),this.files[t]=i[0],this.form.controls[t].setValue(this.files[t].name))}},{key:"fileClear",value:function(e,t){this.model[e]=null,this.form.controls[e].reset(null),t.files=null,t.value="",delete this.files[e]}},{key:"onLocaleSwitch",value:function(){var e=this;if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach((function(t){e.model[t]=e.localePreviousValues[t]})),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach((function(t){e.localePreviousValues[t]=e.model[t]||"",e.model[t]=e.model.translations[t]&&e.model.translations[t][e.localeCurrent]||""}))}},{key:"saveTranslations",value:function(e){var t=this;e&&e.preventDefault(),this.localeFieldsAllowed.forEach((function(e){t.model[e]?(t.model.translations[e]||(t.model.translations[e]={}),t.model.translations[e][t.localeCurrent]=t.model[e]):t.model.translations[e]&&(t.model.translations[e][t.localeCurrent]&&delete t.model.translations[e][t.localeCurrent],0===Object.keys(t.model.translations[e]).length&&delete t.model.translations[e])})),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}},{key:"saveRequest",value:function(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}},{key:"onSubmit",value:function(){this.submitted=!0,this.closeModal()}},{key:"appendFormData",value:function(e){}},{key:"saveFiles",value:function(e){var t=this;if(0!==Object.keys(this.files).length){var n=new FormData;for(var i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&n.append(i,this.files[i],this.files[i].name);n.append("itemId",String(e)),this.appendFormData(n),this.dataService.postFormData(n).pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(){t.closeModal()},error:function(e){t.errorMessage=e.error||t.getLangString("ERROR"),t.submitted=!1,t.loading=!1}})}else this.closeModal()}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(n&&n.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(n){Object.keys(e.files).length>0?e.saveFiles(n._id||n.id):(t?e.closeModal():n&&n.id&&(e.model=n,e.onAfterGetData(),e.isEditMode=!0),e.closeReason="updated",e.loading=!1,e.submitted=!1)},error:function(t){e.errorMessage=t.error||e.getLangString("ERROR"),e.loading=!1,e.submitted=!1}})}},{key:"emailValidator",value:function(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}},{key:"getRootElement",value:function(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}},{key:"createUniqueId",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Qb(i.e),a.Qb(c.a),a.Qb(s.a),a.Qb(d.b),a.Qb(d.v),a.Qb(b.d),a.Qb(a.l))},e.\u0275dir=a.Lb({type:e,inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"}}),e}()},ot8b:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var i=n("3Pt+"),o=n("XNiG"),r=n("1G5W"),l=n("7AsP"),a=n("fXoL"),c=n("1kSV"),s=n("sYmb"),d=["formEl"],b=function(){var e=function(){function e(t,n,i,r,l){_classCallCheck(this,e),this.fb=t,this.activeModal=n,this.translateService=i,this.dataService=r,this.elRef=l,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new o.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then((function(){e.onAfterGetData()})):this.onAfterGetData(),this.onAfterInit()}},{key:"onBeforeInit",value:function(){}},{key:"onAfterInit",value:function(){}},{key:"onAfterGetData",value:function(){this.buildControls(this.form,this.formFields)}},{key:"getSystemFieldName",value:function(){return""}},{key:"getLangString",value:function(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}},{key:"getModelData",value:function(){var e=this;return this.loading=!0,new Promise((function(t,n){e.dataService.getItem(e.itemId).pipe(Object(r.a)(e.destroyed$)).subscribe({next:function(n){if(e.isItemCopy){n.id=null;var i=e.getSystemFieldName();i&&(n[i]="")}Object.assign(e.model,n),e.loading=!1,t(n)},error:function(t){e.errorMessage=t.error||e.getLangString("ERROR"),e.loading=!1,n(t)}})}))}},{key:"buildForm",value:function(){var e=this;this.form=this.fb.group(this.buildControls(null,this.formFields)),this.form.valueChanges.pipe(Object(r.a)(this.destroyed$)).subscribe((function(){return e.onValueChanged()}))}},{key:"buildControls",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"model",o={};return void 0===e&&(e=this.form||null),t.forEach((function(t){var r=n.getControl(e,t),l=null;if(i&&n[i]?(n[i].options||(n[i].options={}),l=0===t.name.indexOf("options_")?n[i].options[t.name.substr(8)]||null:n[i][t.name]||null):l=null,r)if(t.disabled&&r.disable(),t.children){var a=l,c=r;c.clear(),a.forEach((function(e,i){var o=n.getFormFieldByName(t.name),r=n.buildControls(null,o.children,null);c.push(n.fb.group(r))})),c.patchValue(a)}else r.setValue(l);else t.children?(o[t.name]=n.fb.array([]),n.createArrayFieldsProperty(t.name)):o[t.name]=n.fb.control({value:l,disabled:t.disabled||!1},t.validators)})),o}},{key:"onValueChanged",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this[t]&&(this[t].valid&&(this.errorMessage=""),Object.keys(this[t].value).forEach((function(t){e.formErrors[t]="";var n=e.getControl(e.form,null,t);if(n&&!n.valid&&n.errors){var i="";Object.keys(n.errors).forEach((function(t){i+=(i?" ":"")+e.getLangString("INVALID_"+t.toUpperCase())})),e.formErrors[t]=i}})))}},{key:"getFormFieldByName",value:function(e){var t=this.formFields.filter((function(t){return t.name===e}));return t.length>0?t[0]:null}},{key:"createArrayFieldsProperty",value:function(e){var t=this;Object.defineProperty(this.arrayFields,e,{get:function(){return t.form?t.form.get(e):null}})}},{key:"getControl",value:function(e,t,n){return e?e.get(n||t.name):null}},{key:"focusFormError",value:function(){var e=this;setTimeout((function(){e.formEl.nativeElement.querySelector(".form-control.is-invalid")&&e.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()}),1)}},{key:"formGroupMarkTouched",value:function(e){var t=this;Object.keys(e.controls).forEach((function(n){e.controls[n].markAsTouched(),e.controls[n]instanceof i.c&&Array.from(t.form.controls[n].controls).forEach((function(e){t.formGroupMarkTouched(e)}))}))}},{key:"getSaveRequest",value:function(e){return e.id||"root"===e.name?this.dataService.update(e):this.dataService.create(e)}},{key:"getFormData",value:function(){var e=this.form.value;return e.id=this.model.id||0,void 0!==this.model.translations&&(e.translations=this.model.translations||null),e}},{key:"arrayFieldDelete",value:function(e,t,n){n&&n.preventDefault(),this.arrayFields[e].removeAt(t)}},{key:"arrayFieldAdd",value:function(e,t){t&&t.preventDefault();var n=this.getFormFieldByName(e);if(n){var i=this.buildControls(null,n.children,null);this.arrayFields[e].push(this.fb.group(i))}}},{key:"closeModal",value:function(e){e&&e.preventDefault(),this.close(this.closeReason)}},{key:"close",value:function(e,t){t&&t.preventDefault(),"submit"===e?this.activeModal.close(e):this.activeModal.dismiss(e)}},{key:"minimize",value:function(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),n.classList.add("d-none")}},{key:"maximize",value:function(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");var t=this.getRootElement(),n=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),n.classList.remove("d-none")}},{key:"save",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;t&&t.preventDefault(),this.onSubmit(e)}},{key:"saveFiles",value:function(e){var t=this;if(0!==Object.keys(this.files).length){var n=new FormData;for(var i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&n.append(i,this.files[i],this.files[i].name);n.append("itemId",String(e)),this.dataService.postFormData(n).pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(){t.close("submit")},error:function(e){t.errorMessage=e.error||t.getLangString("ERROR"),t.submitted=!1,t.loading=!1}})}else this.close("submit")}},{key:"onSubmit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;var n=this.getFormData();this.getSaveRequest(n).pipe(Object(r.a)(this.destroyed$)).subscribe({next:function(n){Object.keys(e.files).length>0?e.saveFiles(n._id||n.id):t&&e.close("submit"),n&&n.id&&(e.model.id=n.id),e.closeReason="updated",e.loading=!1,e.submitted=!1},error:function(t){t.error&&(e.errorMessage=t.error),t.errors&&(e.formErrors=t.errors,e.errorMessage=e.getLangString("PLEASE_FIX_FORM_ERRORS")),e.loading=!1,e.submitted=!1}})}},{key:"onLocaleSwitch",value:function(){var e=this;if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach((function(t){e.model[t]=e.localePreviousValues[t],e.getControl(e.form,null,t).setValue(e.localePreviousValues[t])})),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach((function(t){e.localePreviousValues[t]=e.getControl(e.form,null,t).value,e.model.translations[t]?(e.model[t]=e.model.translations[t][e.localeCurrent]||"",e.getControl(e.form,null,t).setValue(e.model[t])):(e.model[t]="",e.getControl(e.form,null,t).setValue(""))}))}},{key:"saveTranslations",value:function(e){var t=this;e&&e.preventDefault(),this.localeFieldsAllowed.forEach((function(e){t.getControl(t.form,null,e)&&t.getControl(t.form,null,e).value?(t.model.translations[e]||(t.model.translations[e]={}),t.model.translations[e][t.localeCurrent]=t.getControl(t.form,null,e).value):t.model.translations[e]&&(t.model.translations[e][t.localeCurrent]&&delete t.model.translations[e][t.localeCurrent],0===Object.keys(t.model.translations[e]).length&&delete t.model.translations[e])})),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}},{key:"emailValidator",value:function(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}},{key:"getRootElement",value:function(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}},{key:"createUniqueId",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(),this.destroyed$.complete()}},{key:"formErrors",set:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=this.getControl(this.form,null,t);n&&n.setErrors({incorrect:!0})}this._formFieldsErrors=e},get:function(){return this._formFieldsErrors}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Qb(i.e),a.Qb(c.b),a.Qb(s.d),a.Qb(l.a),a.Qb(a.l))},e.\u0275dir=a.Lb({type:e,viewQuery:function(e,t){var n;1&e&&a.Sc(d,!0),2&e&&a.Cc(n=a.jc())&&(t.formEl=n.first)},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"}}),e}()}}]);