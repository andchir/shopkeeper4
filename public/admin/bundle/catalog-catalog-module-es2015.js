(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"4p3S":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("XNiG"),n=i("1G5W"),s=i("RwQR"),r=i("Y2tp"),l=i("8Y7J"),c=i("7AsP"),a=i("G0yt"),d=i("TSSN");const b=["table"];let u=(()=>{class e{constructor(e,t,i,n){this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=n,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new s.a("name","asc",1,10,0,0),this.destroyed$=new o.a}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(e){}onSearchWordUpdate(e){if(void 0!==e)return this.queryOptions.search_word=e,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(e){return["modal",e||0].join("-")}setModalInputs(e,t=!1,i=""){const o=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(o?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=o}modalOpen(e,t=!1){const i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const e=window.document.getElementById(i),t=e.previousElementSibling;return e.classList.add("d-block"),e.classList.remove("modal-minimized"),void t.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(e,t,i),this.modalRef.result.then(e=>{this.destroyed$.isStopped||(this.onModalClose(e),this.getList())},e=>{this.destroyed$.isStopped||(this.onModalClose(e),e&&["submit","updated"].indexOf(e)>-1&&this.getList())})}deleteItemConfirm(e){this.modalRef=this.modalService.open(r.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(t=>{"accept"===t&&this.deleteItem(e)})}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}confirmAction(e){return this.modalRef=this.modalService.open(r.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(e=>{this.clearSelected(),this.getList()},e=>this.showAlert(e.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(e=>{"accept"===e&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(e=>{this.clearSelected(),this.getList()},e=>this.showAlert(e.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(e){this.modalRef=this.modalService.open(r.a),this.modalRef.componentInstance.modalContent=e,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(e){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(t=>{"accept"===t&&this.dataService.deleteItem(e).subscribe(e=>{this.getList()},e=>{e.error&&this.showAlert(e.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(e){switch(e[0]){case"edit":this.modalOpen(e[1]);break;case"copy":this.modalOpen(e[1],!0);break;case"delete":this.deleteItem(e[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe(Object(n.a)(this.destroyed$)).subscribe({next:e=>{this.items=e.items,this.collectionSize=e.total,this.loading=!1},error:e=>{this.items=[],this.collectionSize=0,e.error&&this.showAlert(e.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.title="",e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(a.b),l.Qb(a.h),l.Qb(d.d))},e.\u0275dir=l.Lb({type:e,viewQuery:function(e,t){var i;1&e&&l.Jc(b,!0),2&e&&l.Cc(i=l.jc())&&(t.table=i.first)}}),e})()},"6J3s":function(e,t,i){"use strict";i.r(t);var o=i("SVse"),n=i("d2mR"),s=i("iInd"),r=i("8Y7J"),l=i("TSSN");const c=function(){return["field_types"]},a=function(){return["content_types"]};let d=(()=>{class e{constructor(){}ngOnInit(){}}return e.title="CATALOG",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Kb({type:e,selectors:[["app-catalog"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ml-md-2",3,"routerLink"],[1,"icon-toggle"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-box"],[1,"card"],[1,"card-body"],[1,"float-md-left","mt-4","mt-md-0"],[1,"icon-layers"],[1,"clearfix"],[1,"min-height400"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"a",2),r.Rb(3,"i",3),r.Oc(4," \xa0 "),r.Wb(5,"span"),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Vb(),r.Wb(8,"a",4),r.Rb(9,"i",5),r.Oc(10," \xa0 "),r.Wb(11,"span"),r.Oc(12),r.lc(13,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(14,"div",6),r.Wb(15,"div",7),r.Wb(16,"div",8),r.Wb(17,"h3"),r.Rb(18,"i",9),r.Oc(19," \xa0 "),r.Wb(20,"span"),r.Oc(21),r.lc(22,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Rb(23,"div",10),r.Rb(24,"hr"),r.Wb(25,"div",11),r.Rb(26,"router-outlet"),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Db(2),r.rc("routerLink",r.vc(11,c)),r.Db(4),r.Pc(r.mc(7,5,"FIELD_TYPES")),r.Db(2),r.rc("routerLink",r.vc(12,a)),r.Db(4),r.Pc(r.mc(13,7,"CONTENT_TYPES")),r.Db(9),r.Pc(r.mc(22,9,"CATALOG")))},directives:[s.e,s.d,s.g],pipes:[l.c],encapsulation:2}),e})();var b=i("LvDl");class u{constructor(e,t,i,o,n,s,r,l,c,a,d,b){this.id=e,this.isFolder=t,this.parentId=i,this.name=o,this.title=n,this.description=s,this.contentTypeName=r,this.isActive=l,this.clearCache=c,this.menuIndex=a,this.translations=d,this.image=b,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}static createTree(e,t=null,i=!0){if(0===e.length)return null;if(!t){const o=Object(b.findIndex)(e,{name:"root"});t=o>-1?u.toTreeNode(e[o],i):{id:0,parentId:0,label:"",expanded:!0,children:[]}}t.children=[];const o=e.filter(e=>0!==e.id&&e.parentId===t.id);return o.length>0&&(o.forEach(e=>{t.children.push(u.toTreeNode(e,i))}),t.children.forEach(t=>{u.createTree(e,t,i)})),0===t.children.length&&(t.children=null),t}static getCurrentNode(e,t){if(!t)return null;if(t.id===e)return t;if(t.children){let i=null;for(let o=0;null==i&&o<t.children.length;o++)i=u.getCurrentNode(e,t.children[o]);return i}return null}static toTreeNode(e,t=!0){return{id:e.id,label:e.title,parentId:e.parentId||0,expanded:t}}}var m=i("4p3S"),h=i("s7LF");class p{constructor(e,t,i,o,n,s,r,l,c){this.id=e,this.name=t,this.title=i,this.description=o,this.collection=n,this.fields=s,this.groups=r,this.isActive=l,this.isCreateByUsersAllowed=c,this.isCreateByUsersAllowed||(this.isCreateByUsersAllowed=!1)}static getSystemFieldName(e){const t=Object(b.findIndex)(e.fields,{inputType:"system_name"});return t>-1?e.fields[t].name:"name"}static getFieldByName(e,t){const i=Object(b.findIndex)(e.fields,{name:t});return i>-1?e.fields[i]:null}}var f=i("bbPC"),g=i("qbpQ"),v=i("e07I"),y=i("BWxc"),D=i("7AsP"),V=i("IheW");let I=(()=>{class e extends D.a{constructor(e){super(e),this.setRequestUrl("/admin/products")}}return e.\u0275fac=function(t){return new(t||e)(r.ec(V.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac}),e})(),W=(()=>{class e extends D.a{constructor(e){super(e),this.setRequestUrl("/admin/files")}}return e.\u0275fac=function(t){return new(t||e)(r.ec(V.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac}),e})();var C=i("3UOJ"),E=i("wgQU"),O=i("G0yt"),T=i("Cp0g"),M=i("keWK");function S(e,t){if(1&e&&(r.Wb(0,"div",44),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.parentId," ")}}function w(e,t){if(1&e&&(r.Ub(0),r.Rb(1,"app-input-field-renderer",45),r.Tb()),2&e){const e=r.kc();r.Db(1),r.rc("fields",e.currentContentType.fields)("groups",e.currentContentType.groups)("formErrors",e.formErrors)("validationMessages",e.validationMessages)("model",e.model)("form",e.form)("files",e.files)("localeFieldsAllowed",e.localeFieldsAllowed)("isLocalizationActive",e.localeCurrent!==e.localeDefault)}}function k(e,t){if(1&e&&(r.Wb(0,"label",51),r.Rb(1,"input",52),r.Oc(2),r.Vb()),2&e){const e=t.$implicit;r.Db(1),r.rc("value",e),r.Db(1),r.Qc(" ",e," ")}}const R=function(){return{standalone:!0}};function L(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",46),r.Wb(1,"button",47),r.ic("click",(function(t){return r.Ec(e),r.kc().saveTranslations(t)})),r.lc(2,"translate"),r.Rb(3,"i",48),r.Vb(),r.Wb(4,"div",49),r.ic("ngModelChange",(function(t){return r.Ec(e),r.kc().localeCurrent=t}))("ngModelChange",(function(){return r.Ec(e),r.kc().onLocaleSwitch()})),r.Mc(5,k,3,2,"label",50),r.Vb(),r.Vb()}if(2&e){const e=r.kc();r.Db(1),r.sc("ngbTooltip",r.mc(2,5,"SAVE")),r.rc("hidden",e.localeCurrent==e.localeDefault),r.Db(3),r.rc("ngModel",e.localeCurrent)("ngModelOptions",r.vc(7,R)),r.Db(1),r.rc("ngForOf",e.localeList)}}let A=(()=>{class e extends f.a{constructor(e,t,i,o,n,s,r,l,c,a,d){super(e,t,i,o,n,s,r),this.fb=e,this.dataService=t,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.contentTypesService=l,this.categoriesService=c,this.filesService=a,this.appSettings=d,this.categories=[],this.contentTypes=[],this.currentContentType=new p(0,"","","","",[],[],!0),this.model={},this.dataLoaded=!1,this.formFields={parentId:{value:0,validators:[h.w.required],messages:{required:"Category is required."}},isActive:{value:!0,validators:[],messages:{}},clearCache:{value:!0,validators:[],messages:{}}},this.model.id=0,this.model.parentId=0}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),this.model.clearCache=!0,this.model.parentId=this.category.id,this.dataService.setRequestUrl("/admin/products/"+this.category.id),this.buildForm(),this.getCategories(),this.getContentType().then(e=>this.itemId?this.getModelData():Promise.reject(""),e=>(this.dataLoaded=!0,this.errorMessage=e.error||"Error.",Promise.reject(""))).then(e=>{this.dataLoaded=!0,this.onAfterGetData(),this.updateForm()},()=>{this.dataLoaded=!0,this.onAfterGetData()})}onAfterGetData(){this.currentContentType.fields.forEach(e=>{["text","textarea","rich_text"].indexOf(e.inputType)>-1&&this.localeFieldsAllowed.push(e.name)}),this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={})}getSystemFieldName(){return p.getSystemFieldName(this.currentContentType)}getCategories(){this.categoriesService.getListPage().subscribe(e=>{this.categories=e.items},e=>{this.errorMessage=e.error||"Error."})}getContentType(){return this.loading=!0,this.category.contentTypeName?new Promise((e,t)=>{this.contentTypesService.getItemByName(this.category.contentTypeName).subscribe(t=>{this.currentContentType=t,this.errorMessage="",this.loading=!1,e(t)},e=>{this.errorMessage=e.error||"Error.",this.loading=!1,t(e)})}):Promise.reject({error:"Content type name not found."})}updateForm(e){e||(e=Object(b.clone)(this.model));const t=Object(b.map)(this.currentContentType.fields,(function(e){return e.name}));t.push("id","parentId","previousParentId","isActive","clearCache","translations"),e.clearCache=!0,Object.keys(this.model).forEach(e=>{if(e.indexOf("__")>-1){const i=C.a.getFieldBaseName(e);if(i===e)return;const o=C.a.getFieldIndexData(this.currentContentType.fields,i);if(-1===o.index)return;const n=Object(b.cloneDeep)(this.currentContentType.fields[o.index]);n.name=e,this.currentContentType.fields.splice(o.index+o.additFieldsCount+1,0,n),t.push(e)}});for(const i in this.form.controls)this.form.controls.hasOwnProperty(i)&&-1===t.indexOf(i)&&this.form.removeControl(i);this.model=Object(b.pick)(e,t)}onChangeContentType(){const e=parseInt(String(this.model.parentId),10),t=Object(b.findIndex)(this.categories,{id:e});-1!==t&&(this.currentContentType&&this.currentContentType.name===this.categories[t].contentTypeName||(this.model.previousParentId=this.category.id,this.category=Object(b.cloneDeep)(this.categories[t]),this.getContentType()))}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),t.append("ownerType",this.currentContentType.name),t.append("categoryId",String(this.model.parentId)),t.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1})}getErrorsString(){const e=[];return Object.keys(this.form.controls).forEach(t=>{if(this.form.controls[t].invalid&&this.validationMessages[t]){const i=C.a.getFieldBaseName(t),o=p.getFieldByName(this.currentContentType,i);if(!o)return;let n="";n=this.formErrors[t]?this.formErrors[t]:o.title+" - error.",e.push(n)}}),e.join(" ")}getFormData(){const e=Object(b.cloneDeep)(this.model);for(const t in e)e.hasOwnProperty(t)&&e[t]&&"object"==typeof e[t]&&e[t].dataUrl&&delete e[t].dataUrl;return e.fieldsSort=this.getFieldsSortData(),e}getFieldsSortData(){let e=this.currentContentType.fields.map(e=>e.name);return e=e.filter(e=>{if(!this.model[e]||-1===e.indexOf("__"))return!1;const t=e.split("__");return!isNaN(t[1])}),e}save(e=!1){if(this.submitted=!0,this.errorMessage=null,!this.form.valid)return this.onValueChanged("form"),this.errorMessage=this.getErrorsString(),void(this.submitted=!1);this.loading=!0,this.dataService.setRequestUrl("/admin/products/"+this.category.id),this.saveRequest().subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t.id||t._id):(e?this.closeModal():t&&(t.id||t._id)&&(this.model=t,this.model.id=t.id||t._id,this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1}})}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(h.e),r.Qb(I),r.Qb(g.a),r.Qb(O.b),r.Qb(O.v),r.Qb(l.d),r.Qb(r.l),r.Qb(y.a),r.Qb(v.a),r.Qb(W),r.Qb(E.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-product-modal-content"]],inputs:{category:"category"},features:[r.Cb([I]),r.Ab],decls:71,vars:50,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],[3,"formGroup"],[1,"modal-body","py-0"],[1,"row","form-group","form-group-message"],[1,"col-md-5"],["for","fieldCategory"],[1,"col-md-7"],["name","parentId","formControlName","parentId",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-indicator"],[1,"custom-control-label",3,"for"],[1,"custom-control","custom-checkbox","mt-2"],["type","checkbox","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"min-height300"],[4,"ngIf"],[1,"alert","alert-danger","mt-3","mb-0",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"fields","groups","formErrors","validationMessages","model","form","files","localeFieldsAllowed","isLocalizationActive"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ic("click",(function(e){return t.closeModal(e)})),r.Rb(3,"i",3),r.Wb(4,"span"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Vb(),r.Wb(7,"button",2),r.ic("click",(function(e){return t.minimize(e)})),r.Rb(8,"i",4),r.Wb(9,"span"),r.Oc(10),r.lc(11,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(12,"div",5),r.Wb(13,"div",6),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(e){return t.maximize(e)})),r.lc(16,"translate"),r.Rb(17,"i",9),r.Vb(),r.Wb(18,"button",10),r.ic("click",(function(e){return t.closeModal(e)})),r.lc(19,"translate"),r.Rb(20,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"h4",12),r.Oc(22),r.Vb(),r.Vb(),r.Wb(23,"form",13),r.Wb(24,"div",14),r.Wb(25,"div",15),r.Wb(26,"div",16),r.Wb(27,"label",17),r.Oc(28),r.lc(29,"translate"),r.Vb(),r.Vb(),r.Wb(30,"div",18),r.Wb(31,"app-select-parent-dropdown",19),r.ic("ngModelChange",(function(e){return t.model.parentId=e}))("ngModelChange",(function(){return t.onChangeContentType()})),r.Vb(),r.Mc(32,S,2,1,"div",20),r.Vb(),r.Vb(),r.Wb(33,"div",21),r.Wb(34,"div",22),r.Wb(35,"div",23),r.Wb(36,"div",24),r.Wb(37,"input",25),r.ic("ngModelChange",(function(e){return t.model.isActive=e})),r.Vb(),r.Rb(38,"span",26),r.Wb(39,"label",27),r.Oc(40),r.lc(41,"translate"),r.Vb(),r.Vb(),r.Wb(42,"div",28),r.Wb(43,"input",29),r.ic("ngModelChange",(function(e){return t.model.clearCache=e})),r.Vb(),r.Wb(44,"label",27),r.Oc(45),r.lc(46,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(47,"div",30),r.Mc(48,w,2,9,"ng-container",31),r.Vb(),r.Wb(49,"div",32),r.Wb(50,"button",33),r.ic("click",(function(){return t.errorMessage=""})),r.Wb(51,"span",34),r.Oc(52,"\xd7"),r.Vb(),r.Vb(),r.Oc(53),r.Vb(),r.Vb(),r.Wb(54,"div",35),r.Mc(55,L,6,8,"div",36),r.Wb(56,"div",37),r.Wb(57,"button",38),r.ic("click",(function(){return t.save(!0)})),r.Wb(58,"span"),r.Oc(59),r.lc(60,"translate"),r.Vb(),r.Vb(),r.Wb(61,"div",39),r.Rb(62,"button",40),r.Wb(63,"div",41),r.Wb(64,"button",42),r.ic("click",(function(){return t.save()})),r.Oc(65),r.lc(66,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(67,"button",43),r.ic("click",(function(e){return t.closeModal(e)})),r.Wb(68,"span"),r.Oc(69),r.lc(70,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(6,30,"CLOSE")),r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(11,32,"MINIMIZE")),r.Db(5),r.rc("title",r.mc(16,34,"EXPAND")),r.Db(3),r.rc("title",r.mc(19,36,"CLOSE")),r.Db(4),r.Pc(t.modalTitle),r.Db(1),r.Ib("loading",t.loading),r.rc("formGroup",t.form),r.Db(5),r.Pc(r.mc(29,38,"PARENT_FOLDER")),r.Db(3),r.rc("ngModel",t.model.parentId),r.Db(1),r.rc("ngIf",t.formErrors.parentId),r.Db(5),r.tc("id","fieldIsActive",t.uniqueId,""),r.rc("ngModel",t.model.isActive),r.Db(2),r.tc("for","fieldIsActive",t.uniqueId,""),r.Db(1),r.Pc(r.mc(41,40,"ACTIVE")),r.Db(3),r.tc("id","fieldClearCache",t.uniqueId,""),r.rc("ngModel",t.model.clearCache),r.Db(1),r.tc("for","fieldClearCache",t.uniqueId,""),r.Db(1),r.Pc(r.mc(46,42,"CLEAR_FILE_CACHE")),r.Db(3),r.rc("ngIf",t.dataLoaded),r.Db(1),r.rc("hidden",!t.errorMessage),r.Db(4),r.Qc(" ",t.errorMessage," "),r.Db(2),r.rc("ngIf",t.localeList.length>1),r.Db(2),r.rc("disabled",t.submitted||t.isSaveButtonDisabled),r.Db(2),r.Pc(r.mc(60,44,"SAVE_AND_CLOSE")),r.Db(3),r.rc("disabled",t.submitted||t.isSaveButtonDisabled),r.Db(3),r.Pc(r.mc(66,46,"SAVE")),r.Db(4),r.Pc(r.mc(70,48,"CLOSE")))},directives:[h.y,h.o,h.h,T.a,h.n,h.g,o.p,h.a,O.d,O.g,O.f,O.e,M.a,O.u,O.p,h.q,o.o,O.c,O.o],pipes:[l.c],encapsulation:2}),e})();var F=i("RwQR"),N=i("XNiG"),P=i("1G5W");function _(e,t){if(1&e&&(r.Wb(0,"li"),r.Wb(1,"a",1),r.Oc(2),r.Vb(),r.Rb(3,"app-list-recursive",2),r.Vb()),2&e){const e=t.$implicit,i=r.kc();r.Db(2),r.Qc(" ",e.title," "),r.Db(1),r.rc("inputItems",i.inputItems)("parentId",e.id)("currentId",i.currentId)}}let x=(()=>{class e{ngOnInit(){this.filterInputItems()}ngOnChanges(e){e.inputItems&&this.filterInputItems(),e.currentId&&this.updateParentsIds()}filterInputItems(){this.items=[];const e=this.items,t=this.parentId;this.inputItems.forEach((function(i){i.id!==i.parentId&&i.parentId===t&&e.push(i)})),this.updateParentsIds()}updateParentsIds(){const e=this.inputItems.findIndex(e=>e.id===this.currentId);this.currentParentsIds=[],-1!==e&&(this.currentParentsIds=this.getParentIds(this.inputItems[e].parentId))}getParentIds(e,t){if(t=t||[],e>0){t.push(e);const i=Object(b.findIndex)(this.inputItems,{id:e});return-1===i?t:this.getParentIds(this.inputItems[i].parentId,t)}return t}getIsActiveParent(e){return this.currentParentsIds.indexOf(e)>-1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Kb({type:e,selectors:[["app-list-recursive"]],inputs:{inputItems:"inputItems",items:"items",parentId:"parentId",currentId:"currentId"},features:[r.Bb],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"dropdown-item"],[3,"inputItems","parentId","currentId"]],template:function(e,t){1&e&&(r.Wb(0,"ul"),r.Mc(1,_,4,4,"li",0),r.Vb()),2&e&&(r.Db(1),r.rc("ngForOf",t.items))},directives:[o.o,e],encapsulation:2}),e})();var Q=i("ot8b"),q=i("Y2tp"),G=i("c863"),U=i("HEhh");function j(e,t){if(1&e&&(r.Wb(0,"div",57),r.Oc(1),r.Vb()),2&e){const e=r.kc(2);r.Db(1),r.Qc(" ",e.formErrors.parentId," ")}}function B(e,t){if(1&e&&(r.Wb(0,"div",23),r.Wb(1,"div",18),r.Wb(2,"label",35),r.Oc(3),r.lc(4,"translate"),r.Vb(),r.Vb(),r.Wb(5,"div",20),r.Rb(6,"app-select-parent-dropdown",56),r.Mc(7,j,2,1,"div",22),r.Vb(),r.Vb()),2&e){const e=r.kc();r.Db(3),r.Pc(r.mc(4,5,"PARENT_FOLDER")),r.Db(3),r.Ib("is-invalid",e.formErrors.parentId),r.rc("filterId",e.model.id),r.Db(1),r.rc("ngIf",e.formErrors.parentId)}}function Y(e,t){if(1&e&&(r.Wb(0,"div",57),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.title," ")}}function z(e,t){if(1&e&&(r.Wb(0,"div",57),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.name," ")}}function $(e,t){if(1&e&&(r.Wb(0,"option",58),r.Oc(1),r.Vb()),2&e){const e=t.$implicit;r.rc("value",e.name),r.Db(1),r.Pc(e.title)}}function X(e,t){if(1&e&&(r.Wb(0,"div",57),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.contentTypeName," ")}}function J(e,t){if(1&e&&(r.Wb(0,"div",57),r.Oc(1),r.Vb()),2&e){const e=r.kc(2);r.Db(1),r.Qc(" ",e.formErrors.menuIndex," ")}}function K(e,t){if(1&e&&(r.Wb(0,"div",23),r.Wb(1,"div",18),r.Wb(2,"label",59),r.Oc(3),r.lc(4,"translate"),r.Vb(),r.Vb(),r.Wb(5,"div",20),r.Rb(6,"input",60),r.Mc(7,J,2,1,"div",22),r.Vb(),r.Vb()),2&e){const e=r.kc();r.Db(3),r.Qc(" ",r.mc(4,4,"MENU_INDEX")," "),r.Db(3),r.Ib("is-invalid",e.formErrors.menuIndex),r.Db(1),r.rc("ngIf",e.formErrors.menuIndex)}}function H(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",61),r.Wb(1,"button",62),r.ic("click",(function(){return r.Ec(e),r.kc().errorMessage=""})),r.Wb(2,"span",63),r.Oc(3,"\xd7"),r.Vb(),r.Vb(),r.Oc(4),r.Vb()}if(2&e){const e=r.kc();r.Db(4),r.Qc(" ",e.errorMessage," ")}}function Z(e,t){if(1&e&&(r.Wb(0,"label",69),r.Rb(1,"input",70),r.Oc(2),r.Vb()),2&e){const e=t.$implicit;r.Db(1),r.rc("value",e),r.Db(1),r.Qc(" ",e," ")}}const ee=function(){return{standalone:!0}};function te(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",64),r.Wb(1,"button",65),r.ic("click",(function(t){return r.Ec(e),r.kc().saveTranslations(t)})),r.lc(2,"translate"),r.Rb(3,"i",66),r.Vb(),r.Wb(4,"div",67),r.ic("ngModelChange",(function(t){return r.Ec(e),r.kc().localeCurrent=t}))("ngModelChange",(function(){return r.Ec(e),r.kc().onLocaleSwitch()})),r.Mc(5,Z,3,2,"label",68),r.Vb(),r.Vb()}if(2&e){const e=r.kc();r.Db(1),r.sc("ngbTooltip",r.mc(2,5,"SAVE")),r.rc("hidden",e.localeCurrent==e.localeDefault),r.Db(3),r.rc("ngModel",e.localeCurrent)("ngModelOptions",r.vc(7,ee)),r.Db(1),r.rc("ngForOf",e.localeList)}}const ie=function(e){return{"no-events":e}},oe=function(e,t){return{"is-invalid":e,"border-success":t}},ne=function(e){return{"is-invalid":e}},se=function(e){return{"border-success":e}};function re(e,t){1&e&&(r.Wb(0,"div",2),r.Rb(1,"i",3),r.Vb())}const le=function(e){return["/catalog/category/",e]};function ce(e,t){if(1&e&&(r.Wb(0,"li",6),r.Wb(1,"a",7),r.Oc(2),r.Vb(),r.Rb(3,"app-categories-list",8),r.Vb()),2&e){const e=t.$implicit,i=r.kc(2);r.Ib("active",e.id==i.currentId)("current-level",i.getIsActiveParent(e.id)),r.Db(1),r.Ib("item-inactive",!e.isActive),r.rc("routerLink",r.wc(11,le,e.id)),r.Db(1),r.Qc(" ",e.title," "),r.Db(1),r.rc("inputItems",i.inputItems)("parentId",e.id)("currentId",i.currentId)}}function ae(e,t){if(1&e&&(r.Wb(0,"ul",4),r.Mc(1,ce,4,13,"li",5),r.Vb()),2&e){const e=r.kc();r.Ib("shadow",0!=e.parentId),r.Db(1),r.rc("ngForOf",e.items)}}const de=["categoriesDropdown"];function be(e,t){if(1&e){const e=r.Xb();r.Wb(0,"button",7),r.ic("click",(function(){return r.Ec(e),r.kc().goToRootCategory()})),r.lc(1,"translate"),r.Rb(2,"i",17),r.Vb()}2&e&&r.sc("ngbTooltip",r.mc(1,1,"OPEN_ROOT_CATEGORY"))}function ue(e,t){if(1&e){const e=r.Xb();r.Ub(0),r.Wb(1,"div",18),r.Wb(2,"button",19),r.ic("click",(function(t){return r.Ec(e),r.kc().expandAll(t)})),r.Oc(3),r.lc(4,"translate"),r.Vb(),r.Wb(5,"button",20),r.ic("click",(function(t){return r.Ec(e),r.kc().collapseAll(t)})),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Vb(),r.Tb()}2&e&&(r.Db(3),r.Qc(" ",r.mc(4,2,"EXPAND_ALL")," "),r.Db(3),r.Qc(" ",r.mc(7,4,"COLLAPSE_ALL")," "))}let me=(()=>{class e extends Q.a{constructor(e,t,i,o,n,s,r,l,c){super(e,t,i,o,n),this.fb=e,this.activeModal=t,this.translateService=i,this.dataService=o,this.elRef=n,this.filesService=s,this.contentTypesService=r,this.appSettings=l,this.systemNameService=c,this.isRoot=!1,this.model=new u(null,!1,0,"","","","",!0),this.contentTypes=[],this.loadingCategories=!1,this.categories=[],this.isCollapsed=!1,this.localeFieldsAllowed=["title","description"],this.files={},this.formFields=[{name:"title",validators:[h.w.required]},{name:"name",validators:[h.w.required]},{name:"description",validators:[]},{name:"parentId",validators:[]},{name:"image",validators:[]},{name:"contentTypeName",validators:[]},{name:"menuIndex",validators:[]},{name:"isActive",validators:[]},{name:"clearCache",validators:[]}]}ngOnInit(){this.uniqueId=this.createUniqueId(),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),void 0!==this.itemId&&(this.model.id=this.itemId),this.model.parentId=this.isEditMode?this.currentCategory.parentId:this.currentCategory.id,this.model.contentTypeName=this.currentCategory.contentTypeName,this.isRoot&&(this.model.id=0,this.model.title=this.getLangString("ROOT_FOLDER"),this.model.name="root"),this.getContentTypes(),super.ngOnInit()}ngAfterViewInit(){this.elRef.nativeElement.querySelector("#fieldTitle")&&this.elRef.nativeElement.querySelector("#fieldTitle").focus()}onAfterGetData(){this.model.clearCache=!0,this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={}),super.onAfterGetData()}getContentTypes(){this.contentTypesService.getListPage().subscribe(e=>{this.contentTypes=e.items},e=>this.errorMessage=e)}onCategorySelect(e){this.form.controls.parentId.setValue(e.node.id),this.model.parentId=e.node.id}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),t.append("ownerType","category"),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1})}generateName(e,t){t&&t.preventDefault();const i=this.getControl(this.form,null,"title").value||"";e.name=this.systemNameService.generateName(i),this.getControl(this.form,null,"name").setValue(e.name)}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(h.e),r.Qb(O.b),r.Qb(l.d),r.Qb(v.a),r.Qb(r.l),r.Qb(W),r.Qb(y.a),r.Qb(E.a),r.Qb(g.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-category-modal-content"]],inputs:{currentCategory:"currentCategory",isRoot:"isRoot"},features:[r.Ab],decls:103,vars:84,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],["class","row form-group form-group-message",4,"ngIf"],[1,"row","form-group","show-on-hover-parent","form-group-message"],[1,"col-md-5"],["for","fieldTitle"],[1,"col-md-7"],["type","text","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group","form-group-message"],["for","fieldName"],[1,"input-group",3,"ngClass"],["type","text","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","disabled","click"],[1,"icon-reload"],[1,"row","form-group","show-on-hover-parent"],["for","fieldDescription"],["type","text","id","fieldDescription","rows","4","name","description","formControlName","description",1,"form-control",3,"ngClass"],[1,"row","form-group"],["formControlName","image",3,"hasPreviewImage","allowedExtensions","files","filesChange"],["for","fieldContentType"],["id","fieldContentType","name","contentTypeName","formControlName","contentTypeName",1,"custom-select"],["value","1",3,"value",4,"ngFor","ngForOf"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","mb-2"],["type","checkbox","id","fieldIsActive","value","1","name","isActive","formControlName","isActive",1,"custom-control-input"],["for","fieldIsActive",1,"custom-control-label"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","id","fieldClearCache","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input"],["for","fieldClearCache",1,"custom-control-label"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"disabled","click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["formControlName","parentId",3,"filterId"],[1,"alert","alert-danger"],["value","1",3,"value"],["for","fieldMenuIndex"],["type","number","id","fieldMenuIndex","name","menuIndex","formControlName","menuIndex",1,"form-control"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ic("click",(function(e){return t.closeModal(e)})),r.Rb(3,"i",3),r.Wb(4,"span"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Vb(),r.Wb(7,"button",2),r.ic("click",(function(e){return t.minimize(e)})),r.Rb(8,"i",4),r.Wb(9,"span"),r.Oc(10),r.lc(11,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(12,"div",5),r.Wb(13,"div",6),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(e){return t.maximize(e)})),r.lc(16,"translate"),r.Rb(17,"i",9),r.Vb(),r.Wb(18,"button",10),r.ic("click",(function(e){return t.closeModal(e)})),r.lc(19,"translate"),r.Rb(20,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"h4",12),r.Oc(22),r.Vb(),r.Vb(),r.Wb(23,"form",13,14),r.ic("ngSubmit",(function(){return t.onSubmit()})),r.Wb(25,"div",15),r.Mc(26,B,8,7,"div",16),r.Wb(27,"div",17),r.Wb(28,"div",18),r.Wb(29,"label",19),r.Oc(30),r.lc(31,"translate"),r.Vb(),r.Vb(),r.Wb(32,"div",20),r.Rb(33,"input",21),r.Mc(34,Y,2,1,"div",22),r.Vb(),r.Vb(),r.Wb(35,"div",23),r.Wb(36,"div",18),r.Wb(37,"label",24),r.Oc(38),r.lc(39,"translate"),r.Vb(),r.Vb(),r.Wb(40,"div",20),r.Wb(41,"div",25),r.Rb(42,"input",26),r.Wb(43,"div",27),r.Wb(44,"button",28),r.ic("click",(function(){return t.generateName(t.model)})),r.lc(45,"translate"),r.Rb(46,"i",29),r.Vb(),r.Vb(),r.Vb(),r.Mc(47,z,2,1,"div",22),r.Vb(),r.Vb(),r.Wb(48,"div",30),r.Wb(49,"div",18),r.Wb(50,"label",31),r.Oc(51),r.lc(52,"translate"),r.Vb(),r.Vb(),r.Wb(53,"div",20),r.Rb(54,"textarea",32),r.Vb(),r.Vb(),r.Wb(55,"div",33),r.Wb(56,"div",18),r.Wb(57,"label"),r.Oc(58),r.lc(59,"translate"),r.Vb(),r.Vb(),r.Wb(60,"div",20),r.Wb(61,"app-file-widget",34),r.ic("filesChange",(function(e){return t.files=e})),r.Vb(),r.Vb(),r.Vb(),r.Wb(62,"div",23),r.Wb(63,"div",18),r.Wb(64,"label",35),r.Oc(65),r.lc(66,"translate"),r.Vb(),r.Vb(),r.Wb(67,"div",20),r.Wb(68,"select",36),r.Mc(69,$,2,2,"option",37),r.Vb(),r.Mc(70,X,2,1,"div",22),r.Vb(),r.Vb(),r.Mc(71,K,8,6,"div",16),r.Wb(72,"div",33),r.Wb(73,"div",38),r.Wb(74,"div",39),r.Wb(75,"div",40),r.Rb(76,"input",41),r.Wb(77,"label",42),r.Oc(78),r.lc(79,"translate"),r.Vb(),r.Vb(),r.Wb(80,"div",43),r.Rb(81,"input",44),r.Wb(82,"label",45),r.Oc(83),r.lc(84,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Mc(85,H,5,1,"div",46),r.Vb(),r.Wb(86,"div",47),r.Mc(87,te,6,8,"div",48),r.Wb(88,"div",49),r.Wb(89,"button",50),r.ic("click",(function(e){return t.save(!0,e)})),r.Wb(90,"span"),r.Oc(91),r.lc(92,"translate"),r.Vb(),r.Vb(),r.Wb(93,"div",51),r.Rb(94,"button",52),r.Wb(95,"div",53),r.Wb(96,"button",54),r.ic("click",(function(e){return t.save(!1,e)})),r.Oc(97),r.lc(98,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(99,"button",55),r.ic("click",(function(e){return t.closeModal(e)})),r.Wb(100,"span"),r.Oc(101),r.lc(102,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(6,43,"CLOSE")),r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(11,45,"MINIMIZE")),r.Db(5),r.rc("title",r.mc(16,47,"EXPAND")),r.Db(3),r.rc("title",r.mc(19,49,"CLOSE")),r.Db(4),r.Pc(t.modalTitle),r.Db(1),r.rc("formGroup",t.form)("ngClass",r.wc(73,ie,t.submitted)),r.Db(2),r.Ib("loading",t.loading),r.Db(1),r.rc("ngIf",!t.isRoot),r.Db(4),r.Qc(" ",r.mc(31,51,"TITLE")," "),r.Db(3),r.rc("ngClass",r.xc(75,oe,t.form.controls.title.touched&&!t.form.controls.title.valid,t.localeCurrent!=t.localeDefault)),r.Db(1),r.rc("ngIf",t.formErrors.title),r.Db(4),r.Qc(" ",r.mc(39,53,"SYSTEM_NAME")," "),r.Db(3),r.rc("ngClass",r.wc(78,ne,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.Db(1),r.rc("ngClass",r.wc(80,ne,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.Db(2),r.sc("ngbTooltip",r.mc(45,55,"GENERATE")),r.rc("disabled",t.form.controls.name.disabled),r.Db(3),r.rc("ngIf",t.formErrors.name),r.Db(4),r.Qc(" ",r.mc(52,57,"DESCRIPTION")," "),r.Db(3),r.rc("ngClass",r.wc(82,se,t.localeCurrent!=t.localeDefault)),r.Db(4),r.Qc(" ",r.mc(59,59,"IMAGE")," "),r.Db(3),r.rc("hasPreviewImage",!0)("allowedExtensions","image/*")("files",t.files),r.Db(4),r.Qc(" ",r.mc(66,61,"CONTENT_TYPE")," "),r.Db(3),r.Ib("is-invalid",t.formErrors.contentTypeName),r.Db(1),r.rc("ngForOf",t.contentTypes),r.Db(1),r.rc("ngIf",t.formErrors.contentTypeName),r.Db(1),r.rc("ngIf",!t.isRoot),r.Db(7),r.Pc(r.mc(79,63,"ACTIVE")),r.Db(5),r.Pc(r.mc(84,65,"CLEAR_FILE_CACHE")),r.Db(2),r.rc("ngIf",t.errorMessage),r.Db(2),r.rc("ngIf",t.localeList.length>1),r.Db(2),r.rc("disabled",t.submitted||t.isSaveButtonDisabled),r.Db(2),r.Pc(r.mc(92,67,"SAVE_AND_CLOSE")),r.Db(3),r.rc("disabled",t.submitted||t.isSaveButtonDisabled),r.Db(2),r.rc("disabled",t.submitted||t.isSaveButtonDisabled),r.Db(1),r.Qc(" ",r.mc(98,69,"SAVE")," "),r.Db(4),r.Pc(r.mc(102,71,"CLOSE")))},directives:[h.y,h.o,h.h,o.n,o.p,h.b,h.n,h.g,O.u,G.a,h.v,o.o,h.a,O.d,O.g,O.f,O.e,T.a,h.r,h.x,h.s,O.p,h.q,O.c,O.o],pipes:[l.c],encapsulation:2}),e})(),he=(()=>{class e extends x{}return e.\u0275fac=function(t){return pe(t||e)},e.\u0275cmp=r.Kb({type:e,selectors:[["app-categories-list"]],features:[r.Ab],decls:2,vars:2,consts:[["class","pos-absolute-right pos-absolute-right2 no-events",4,"ngIf"],["class","dropdown-menu dropdown-menu-second",3,"shadow",4,"ngIf"],[1,"pos-absolute-right","pos-absolute-right2","no-events"],[1,"icon-keyboard_arrow_right"],[1,"dropdown-menu","dropdown-menu-second"],["class","dropdown-item active",3,"active","current-level",4,"ngFor","ngForOf"],[1,"dropdown-item","active"],["href","",3,"routerLink"],[3,"inputItems","parentId","currentId"]],template:function(e,t){1&e&&(r.Mc(0,re,2,0,"div",0),r.Mc(1,ae,2,3,"ul",1)),2&e&&(r.rc("ngIf",t.items.length>0&&0!=t.parentId),r.Db(1),r.rc("ngIf",t.items.length>0))},directives:[o.p,o.o,s.e,e],encapsulation:2}),e})();const pe=r.Yb(he);let fe=(()=>{class e{constructor(e,t,i,o,n){this.router=e,this.route=t,this.modalService=i,this.categoriesService=o,this.translateService=n,this.rootTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",this.changeRequest=new r.n,this.currentCategory=new u(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode={id:0},this.categoriesTree=[{id:0,parentId:0,label:"",expanded:!0,children:null}],this.categories=[],this.errorMessage="",this.categoryId=0,this.loading=!1,this.destroyed$=new N.a}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}ngOnInit(){this.loading=!0,this.getCategories().then(e=>{this.loading=!1,this.route.paramMap.pipe(Object(P.a)(this.destroyed$)).subscribe(e=>{this.categoryId=e.get("categoryId")?parseInt(e.get("categoryId"),10):0,this.selectCurrent()})})}selectCurrent(){if(this.currentCategory.id===this.categoryId)return;const e=Object(b.findIndex)(this.categories,{id:this.categoryId});e>-1?(this.currentCategory=Object(b.cloneDeep)(this.categories[e]),this.changeRequest.emit(this.currentCategory)):this.openRootCategory(),this.currentCategoryNode=u.getCurrentNode(this.currentCategory.id,this.categoriesTree[0])}getCategories(){return new Promise((e,t)=>{this.categoriesService.getListPage(new F.a("menuIndex,title","asc",1)).subscribe(t=>{t.items&&t.items.length>0&&(this.categories=t.items,this.categoriesTree=[u.createTree(t.items)]),e(t.items)},e=>{this.errorMessage=e,t()})})}openModalCategory(e,t=!1){this.categoriesDropdown.nativeElement.previousSibling.classList.remove("dropdown-toggle-hover"),setTimeout(()=>{this.categoriesDropdown.nativeElement.previousSibling.classList.add("dropdown-toggle-hover")},1);const i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const e=window.document.getElementById(i),t=e.previousElementSibling;return e.classList.add("d-block"),e.classList.remove("modal-minimized"),void t.classList.remove("d-none")}const o=0===e||null===e,n=void 0!==e&&!t;this.modalRef=this.modalService.open(me,{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.modalRef.componentInstance.modalTitle=n?this.getLangString("CATEGORY")+(e?" #"+e:""):this.getLangString("ADD_NEW_CATEGORY"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.currentCategory=this.currentCategory,this.modalRef.componentInstance.isRoot=o,this.modalRef.componentInstance.isEditMode=n,this.modalRef.result.then(e=>{this.destroyed$.isStopped||(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1}))},e=>{this.destroyed$.isStopped||(e&&["submit","updated"].indexOf(e)>-1&&(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1})),this.loading=!1)})}getModalElementId(e){return["modal","category",e||0].join("-")}deleteCategoryItemConfirm(e){const t=Object(b.findIndex)(this.categories,{id:e});-1!==t&&(this.modalRef=this.modalService.open(q.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE_CATEGORY")+` "${this.categories[t].title}"?`,this.modalRef.result.then(t=>{"accept"===t&&this.deleteCategoryItem(e)},e=>{}))}deleteCategoryItem(e){this.loading=!0,this.categoriesService.deleteItem(e).subscribe(e=>{this.categoryId=0,this.getCategories().then(()=>{this.goToRootCategory(),this.loading=!1})},e=>{e.error&&(this.errorMessage=e.error),this.loading=!1})}openCategory(e){this.router.navigate(["/catalog/category",e.node.id])}goToRootCategory(){this.router.navigate(["/catalog/category",""])}openRootCategory(){this.currentCategory=new u(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode=this.categoriesTree[0],this.changeRequest.emit(this.currentCategory)}copyCategory(){this.openModalCategory(this.currentCategory.id,!0)}expandAll(e){e&&e.preventDefault(),this.categoriesTree.forEach(e=>{this.expandRecursive(e,!0)})}collapseAll(e){e&&e.preventDefault(),this.categoriesTree.forEach(e=>{this.expandRecursive(e,!1)})}expandRecursive(e,t){e.expanded=t,e.children&&e.children.forEach(e=>{this.expandRecursive(e,t)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(s.c),r.Qb(s.a),r.Qb(O.h),r.Qb(v.a),r.Qb(l.d))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-categories-menu"]],viewQuery:function(e,t){var i;1&e&&r.Jc(de,!0),2&e&&r.Cc(i=r.jc())&&(t.categoriesDropdown=i.first)},inputs:{rootTitle:"rootTitle"},outputs:{changeRequest:"changeRequest"},decls:26,vars:26,consts:[[1,"d-block","d-md-inline-block","dropdown"],[1,"btn","btn-secondary","dropdown-toggle","dropdown-toggle-hover","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],[1,"icon-folder","mr-1"],[1,"dropdown-menu","shadow"],["categoriesDropdown",""],[1,"dropdown-header"],["type","button","class","btn btn-sm btn-secondary mr-2",3,"ngbTooltip","click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","click"],[1,"icon-plus"],[1,"icon-pencil"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-stack"],[1,"icon-cross"],[1,"dropdown-divider"],[4,"ngIf"],[1,"px-1"],[3,"value","emptyMessage","selectionMode","selection","filter","onNodeSelect"],[1,"icon-home"],[1,"dropdown-footer","px-4","pt-1"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"button",1),r.Rb(2,"i",2),r.Oc(3),r.Vb(),r.Wb(4,"div",3,4),r.Wb(6,"div"),r.Wb(7,"div",5),r.Mc(8,be,3,3,"button",6),r.Wb(9,"button",7),r.ic("click",(function(){return t.openModalCategory()})),r.lc(10,"translate"),r.Rb(11,"i",8),r.Vb(),r.Wb(12,"button",7),r.ic("click",(function(){return t.openModalCategory(t.currentCategory.id)})),r.lc(13,"translate"),r.Rb(14,"i",9),r.Vb(),r.Wb(15,"button",10),r.ic("click",(function(){return t.copyCategory()})),r.lc(16,"translate"),r.Rb(17,"i",11),r.Vb(),r.Wb(18,"button",10),r.ic("click",(function(){return t.deleteCategoryItemConfirm(t.currentCategory.id)})),r.lc(19,"translate"),r.Rb(20,"i",12),r.Vb(),r.Vb(),r.Rb(21,"div",13),r.Mc(22,ue,8,6,"ng-container",14),r.Wb(23,"div",15),r.Wb(24,"p-tree",16),r.ic("onNodeSelect",(function(e){return t.openCategory(e)})),r.lc(25,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Db(3),r.Qc(" ",t.currentCategory.title," "),r.Db(3),r.Ib("loading",t.loading),r.Db(2),r.rc("ngIf",t.currentCategory.id>0),r.Db(1),r.sc("ngbTooltip",r.mc(10,16,"ADD_NEW_CATEGORY")),r.Db(3),r.sc("ngbTooltip",r.mc(13,18,"EDIT_CATEGORY")),r.Db(3),r.sc("ngbTooltip",r.mc(16,20,"COPY_CATEGORY")),r.rc("hidden",!t.currentCategory.id),r.Db(3),r.sc("ngbTooltip",r.mc(19,22,"DELETE_CATEGORY")),r.rc("hidden",!t.currentCategory.id),r.Db(4),r.rc("ngIf",t.categoriesTree[0].children),r.Db(2),r.rc("value",t.categoriesTree[0].children)("emptyMessage",r.mc(25,24,"NO_CATEGORIES"))("selectionMode","single")("selection",t.currentCategoryNode)("filter",!!t.categoriesTree[0].children))},directives:[o.p,O.u,U.a],pipes:[l.c],encapsulation:2}),e})();var ge=i("hecf");let ve=(()=>{class e extends m.a{constructor(e,t,i,o,n){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.contentTypesService=n,this.queryOptions=new F.a("id","desc",1,10,0,0),this.tableFields=[]}ngOnInit(){}updateTableConfig(){this.currentContentType&&(this.tableFields=[],this.currentContentType.fields.forEach(e=>{e.showInTable&&this.tableFields.push({name:e.name,sortName:e.name,title:e.title,outputType:e.outputType,outputProperties:e.outputProperties})}),this.tableFields.unshift({name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}}),this.tableFields.push({name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}))}getModalContent(){return A}getContentType(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}openCategory(e){if(this.currentCategory=Object(b.clone)(e),!this.currentCategory.contentTypeName)return this.items=[],this.tableFields=[],void(this.currentCategory.id=0);this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.loading=!0,this.queryOptions.page=1,this.getContentType().subscribe(e=>{this.currentContentType=e,this.loading=!1,this.updateTableConfig(),this.getList()},()=>{this.items=[],this.tableFields=[],this.currentCategory.id=0})}openRootCategory(){this.currentCategory=new u(0,!1,0,"root","","","",!0),this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.getList()}setModalInputs(e,t=!1,i=""){const o=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=o?`${this.getLangString("PAGE")} #${e}`:this.getLangString("ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=o,this.modalRef.componentInstance.category=Object.assign({},this.currentCategory)}getModalElementId(e){return["modal","product",e||0].join("-")}}return e.title="CATEGORY",e.\u0275fac=function(t){return new(t||e)(r.Qb(I),r.Qb(O.b),r.Qb(O.h),r.Qb(l.d),r.Qb(y.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-catalog-category"]],features:[r.Cb([I]),r.Ab],decls:26,vars:18,consts:[[1,"mb-3"],[1,"float-md-left"],[3,"changeRequest"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div"),r.Wb(2,"div",1),r.Wb(3,"app-categories-menu",2),r.ic("changeRequest",(function(e){return t.openCategory(e)})),r.Vb(),r.Vb(),r.Wb(4,"div",3),r.Wb(5,"div",4),r.Wb(6,"button",5),r.Wb(7,"span"),r.Oc(8),r.lc(9,"translate"),r.Vb(),r.Vb(),r.Wb(10,"div",6),r.Wb(11,"button",7),r.ic("click",(function(){return t.blockSelected()})),r.Oc(12),r.lc(13,"translate"),r.Vb(),r.Wb(14,"button",7),r.ic("click",(function(){return t.deleteSelected()})),r.Oc(15),r.lc(16,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(17,"button",8),r.ic("click",(function(){return t.modalOpen()})),r.Rb(18,"i",9),r.Oc(19," \xa0 "),r.Wb(20,"span"),r.Oc(21),r.lc(22,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Rb(23,"div",10),r.Vb(),r.Vb(),r.Wb(24,"app-table",11,12),r.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),r.Vb()),2&e&&(r.Db(8),r.Pc(r.mc(9,10,"BATCH_ACTIONS")),r.Db(4),r.Pc(r.mc(13,12,"DISABLE_ENABLE")),r.Db(3),r.Pc(r.mc(16,14,"DELETE")),r.Db(6),r.Pc(r.mc(22,16,"ADD")),r.Db(3),r.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[fe,O.d,O.g,O.f,ge.a],pipes:[l.c],encapsulation:2}),e})();var ye=i("LRne"),De=i("JIr8");let Ve=(()=>{class e{constructor(e){this.http=e,this.headers=new V.e({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}setRequestUrl(e){this.requestUrl=e}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe(Object(De.a)(this.handleError()))}deleteItemByName(e){const t=`${this.getRequestUrl()}/${e}`;return this.http.delete(t,{headers:this.headers}).pipe(Object(De.a)(this.handleError()))}handleError(e="operation",t){return e=>{if(e.error)throw e.error;return Object(ye.a)(t)}}}return e.\u0275fac=function(t){return new(t||e)(r.ec(V.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac}),e})(),Ie=(()=>{class e extends D.a{constructor(e){super(e),this.setRequestUrl("/admin/field_types")}}return e.\u0275fac=function(t){return new(t||e)(r.ec(V.a))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac}),e})();var We=i("XWOk"),Ce=i("fMdm");const Ee=["addCollectionBlock"],Oe=["addGroupBlock"],Te=["accordion"],Me=["blockFieldList"];function Se(e,t){if(1&e&&(r.Wb(0,"div",106),r.Oc(1),r.Vb()),2&e){const e=r.kc().message;r.Db(1),r.Pc(e)}}function we(e,t){if(1&e&&(r.Wb(0,"p",103),r.Oc(1),r.lc(2,"translate"),r.Vb(),r.Mc(3,Se,2,1,"div",104),r.Wb(4,"div",103),r.Wb(5,"button",105),r.ic("click",(function(){return(0,t.confirm)()})),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Oc(8," \xa0 "),r.Wb(9,"button",44),r.ic("click",(function(){return t.p.close()})),r.Oc(10),r.lc(11,"translate"),r.Vb(),r.Vb()),2&e){const e=t.message;r.Db(1),r.Pc(r.mc(2,4,"YOU_SURE_YOU_WANT_DELETE")),r.Db(2),r.rc("ngIf",e),r.Db(3),r.Pc(r.mc(7,6,"YES")),r.Db(4),r.Pc(r.mc(11,8,"NO"))}}function ke(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.title," ")}}function Re(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.name," ")}}function Le(e,t){if(1&e&&(r.Wb(0,"option",108),r.Oc(1),r.Vb()),2&e){const e=t.$implicit;r.sc("value",e),r.Db(1),r.Pc(e)}}function Ae(e,t){if(1&e&&(r.Wb(0,"div",109),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.newCollection," ")}}function Fe(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_title," ")}}function Ne(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_name," ")}}function Pe(e,t){if(1&e&&(r.Wb(0,"option",108),r.Oc(1),r.Vb()),2&e){const e=t.$implicit;r.sc("value",e.name),r.Db(1),r.Pc(e.title)}}function _e(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_inputType," ")}}const xe=function(){return{standalone:!0}};function Qe(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",110),r.Wb(1,"div",54),r.Oc(2),r.Vb(),r.Wb(3,"div",55),r.Wb(4,"input",111),r.ic("ngModelChange",(function(i){r.Ec(e);const o=t.$implicit;return r.kc().fieldModel.inputProperties[o.name]=i})),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit,i=r.kc();r.Db(2),r.Qc(" ",e.title," "),r.Db(2),r.rc("ngModel",i.fieldModel.inputProperties[e.name])("ngModelOptions",r.vc(3,xe))}}function qe(e,t){if(1&e&&(r.Wb(0,"option",108),r.Oc(1),r.Vb()),2&e){const e=t.$implicit;r.sc("value",e.name),r.Db(1),r.Pc(e.title)}}function Ge(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_outputType," ")}}function Ue(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",110),r.Wb(1,"div",54),r.Oc(2),r.Vb(),r.Wb(3,"div",55),r.Wb(4,"input",111),r.ic("ngModelChange",(function(i){r.Ec(e);const o=t.$implicit;return r.kc().fieldModel.outputProperties[o.name]=i})),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit,i=r.kc();r.Db(2),r.Qc(" ",e.title," "),r.Db(2),r.rc("ngModel",i.fieldModel.outputProperties[e.name])("ngModelOptions",r.vc(3,xe))}}function je(e,t){if(1&e&&(r.Wb(0,"option",108),r.Oc(1),r.Vb()),2&e){const e=t.$implicit;r.rc("value",e),r.Db(1),r.Pc(e)}}function Be(e,t){if(1&e&&(r.Wb(0,"div",107),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_group," ")}}function Ye(e,t){if(1&e&&(r.Wb(0,"div",109),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.fld_newGroup," ")}}function ze(e,t){if(1&e){const e=r.Xb();r.Wb(0,"tr",122),r.Wb(1,"td"),r.Oc(2),r.Wb(3,"span",123),r.Oc(4),r.Vb(),r.Vb(),r.Wb(5,"td"),r.Oc(6),r.Vb(),r.Wb(7,"td"),r.Oc(8),r.Vb(),r.Wb(9,"td"),r.Rb(10,"app-output-field",124),r.Vb(),r.Wb(11,"td"),r.Wb(12,"div",125),r.Wb(13,"div",126),r.Wb(14,"button",127),r.ic("click",(function(){r.Ec(e);const i=t.$implicit;return r.kc(2).editField(i)})),r.lc(15,"translate"),r.Rb(16,"i",128),r.Vb(),r.Wb(17,"button",129),r.ic("click",(function(){r.Ec(e);const i=t.$implicit;return r.kc(2).copyField(i)})),r.lc(18,"translate"),r.Rb(19,"i",130),r.Vb(),r.Wb(20,"button",127),r.ic("click",(function(){r.Ec(e);const i=t.$implicit;return r.kc(2).deleteField(i)})),r.lc(21,"translate"),r.Rb(22,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Rb(23,"app-output-field",124),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit,i=r.kc(2);r.Db(2),r.Qc(" ",e.title," "),r.Db(2),r.Qc("(",e.name,")"),r.Db(2),r.Qc(" ",e.inputType," "),r.Db(2),r.Qc(" ",e.group," "),r.Db(2),r.rc("value",e.required),r.Db(4),r.sc("ngbTooltip",r.mc(15,11,"EDIT")),r.rc("hidden",e.name==i.currentFieldName),r.Db(3),r.sc("ngbTooltip",r.mc(18,13,"COPY")),r.Db(3),r.sc("ngbTooltip",r.mc(21,15,"DELETE")),r.rc("hidden",e.name==i.currentFieldName),r.Db(3),r.rc("value",e.showInTable)}}function $e(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",null,112),r.Wb(2,"div"),r.Wb(3,"div",113),r.Wb(4,"button",114),r.ic("click",(function(t){return r.Ec(e),r.kc().sortingInit("","",t)})),r.Rb(5,"i",115),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Oc(8," \xa0 "),r.Wb(9,"button",114),r.ic("click",(function(t){return r.Ec(e),r.kc().sortingInit("listOrder","showInList",t)})),r.Rb(10,"i",115),r.Oc(11),r.lc(12,"translate"),r.Vb(),r.Oc(13," \xa0 "),r.Wb(14,"button",114),r.ic("click",(function(t){return r.Ec(e),r.kc().sortingInit("filterOrder","isFilter",t)})),r.Rb(15,"i",115),r.Oc(16),r.lc(17,"translate"),r.Vb(),r.Vb(),r.Wb(18,"div",116),r.Wb(19,"table",117),r.Wb(20,"thead"),r.Wb(21,"tr"),r.Wb(22,"th"),r.Oc(23),r.lc(24,"translate"),r.Vb(),r.Wb(25,"th"),r.Oc(26),r.lc(27,"translate"),r.Vb(),r.Wb(28,"th"),r.Oc(29),r.lc(30,"translate"),r.Vb(),r.Wb(31,"th"),r.Oc(32),r.lc(33,"translate"),r.Vb(),r.Wb(34,"th"),r.Oc(35),r.lc(36,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(37,"tbody"),r.Mc(38,ze,24,17,"tr",118),r.Wb(39,"tr",119),r.Wb(40,"td",120),r.Oc(41),r.lc(42,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(43,"app-sorting-dnd",121),r.ic("itemsChange",(function(t){return r.Ec(e),r.kc().sortData=t}))("save",(function(t){return r.Ec(e),r.kc().sortingApply(t)}))("cancel",(function(){return r.Ec(e),r.kc().sortingReset()})),r.Vb()}if(2&e){const e=r.kc();r.Db(3),r.rc("hidden",e.model.fields.length<2),r.Db(3),r.Qc(" ",r.mc(7,13,"SORT_FIELDS")," "),r.Db(5),r.Qc(" ",r.mc(12,15,"SORT_FIELDS_LIST")," "),r.Db(5),r.Qc(" ",r.mc(17,17,"SORT_FILTERS")," "),r.Db(7),r.Pc(r.mc(24,19,"TITLE")),r.Db(3),r.Pc(r.mc(27,21,"INPUT_TYPE")),r.Db(3),r.Pc(r.mc(30,23,"GROUP")),r.Db(3),r.Qc("",r.mc(33,25,"REQUIRED"),"?"),r.Db(3),r.Qc("",r.mc(36,27,"SHOW_IN_TABLE"),"?"),r.Db(3),r.rc("ngForOf",e.model.fields),r.Db(1),r.rc("hidden",e.model.fields.length>0),r.Db(2),r.Qc(" ",r.mc(42,29,"EMPTY")," "),r.Db(2),r.rc("items",e.sortData)}}const Xe=function(){return["/catalog"]};let Je=(()=>{class e extends f.a{constructor(e,t,i,o,n,s,r,l,c,a){super(e,t,i,o,n,s,r),this.fb=e,this.dataService=t,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.fieldTypesService=l,this.collectionsService=c,this.modalService=a,this.model=new p(0,"","","","products",[],["General","Service"],!0,!1),this.fieldModel=new C.a(0,"","","","",{},"",{},"",!1,!1,!1),this.sortData=[],this.sortingfieldName="",this.fld_submitted=!1,this.action="add_field",this.currentFieldName="",this.collections=["products"],this.fieldTypeProperties={input:[],output:[]},this.formFields={name:{fieldLabel:"SYSTEM_NAME",value:"",validators:[h.w.required,h.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters and numbers."}},title:{fieldLabel:"TITLE",value:"",validators:[h.w.required],messages:{}},description:{fieldLabel:"DESCRIPTION",value:"",validators:[],messages:{}},collection:{fieldLabel:"COLLECTION",value:"",validators:[h.w.required],messages:{}},newCollection:{fieldLabel:"COLLECTION",value:"",validators:[h.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters and numbers.",exists:"Collection with the same name already exists."}},isCreateByUsersAllowed:{fieldLabel:"CREATE_BY_USERS_ALLOWED",value:"",validators:[],messages:{}},isActive:{fieldLabel:"ACTIVE",value:"",validators:[],messages:{}}},this.fieldsFormOptions={title:{fieldLabel:"TITLE",value:"",validators:[h.w.required],messages:{}},name:{fieldLabel:"SYSTEM_NAME",value:"",validators:[h.w.required,h.w.pattern("[A-Za-z0-9_-]+")],messages:{pattern:"The name must contain only Latin letters."}},description:{fieldLabel:"DESCRIPTION",value:"",validators:[],messages:{}},inputType:{fieldLabel:"INPUT_TYPE",value:"",validators:[h.w.required],messages:{}},outputType:{fieldLabel:"OUTPUT_TYPE",value:"",validators:[h.w.required],messages:{}},group:{fieldLabel:"GROUP",value:"",validators:[h.w.required],messages:{}},newGroup:{fieldLabel:"GROUP",value:"",validators:[],messages:{}},required:{value:"",validators:[],messages:{}},showInTable:{value:"",validators:[],messages:{}},showInList:{value:"",validators:[],messages:{}},isFilter:{value:"",validators:[],messages:{}}}}ngOnInit(){super.ngOnInit(),this.getFieldTypes(),this.getCollectionsList()}buildForm(){super.buildForm();const e=this.buildControls(this.fieldsFormOptions,"fieldModel","fld_");this.fieldForm=this.fb.group(e),this.fieldForm.valueChanges.subscribe(()=>this.onValueChanged("fieldForm","fld_"))}getFieldTypes(){const e=new F.a("title","asc",0,0,1);this.fieldTypesService.getListPage(e).subscribe(e=>{this.fieldTypes=e.items},e=>this.errorMessage=e)}getCollectionsList(){this.collectionsService.getList().subscribe(e=>{e.length>0&&(this.collections=e)})}selectFieldTypeProperties(e,t){t&&(this.fieldModel[e+"Type"]=t);const i=Object(b.find)(this.fieldTypes,{name:this.fieldModel[e+"Type"]});if(!i)return void(this.fieldTypeProperties[e]=[]);const o=e+"Properties",n=Object(b.map)(i[e+"Properties"],"name");this.fieldTypeProperties[e].splice(0),i[e+"Properties"].forEach((t,i)=>{this.fieldTypeProperties[e].push(t)});for(const s in this.fieldModel[o])this.fieldModel[o].hasOwnProperty(s)&&-1===n.indexOf(s)&&delete this.fieldModel[o][s];for(const s in this.fieldTypeProperties[e])if(this.fieldTypeProperties[e].hasOwnProperty(s)){const t=this.fieldTypeProperties[e][s].name;void 0===this.fieldModel[o][t]&&(this.fieldModel[o][t]=this.fieldTypeProperties[e][s].default_value)}"input"!==e||this.fieldModel.outputType||this.selectFieldTypeProperties("output",this.fieldModel.inputType)}addCollection(){const e=this.form.get("newCollection");if(!e.valid||!e.value)return!1;this.formErrors.newCollection="";const t=e.value;return this.collections.indexOf(t)>-1?(this.formErrors.newCollection+=this.validationMessages.newCollection.exists,!1):(this.collections.push(t),this.model.collection=t,this.elementAddCollectionBlock.nativeElement.style.display="none",!0)}deleteCollection(e){if(!this.model.collection)return;if(e.isOpen())return void e.close();let t;e.placement="top",e.popoverTitle=this.getLangString("CONFIRM"),t={p:e,confirm:(function(){this.loading=!0,this.collectionsService.deleteItemByName(this.model.collection).subscribe(t=>{const i=this.collections.indexOf(this.model.collection);i>-1&&(this.collections.splice(i,1),this.model.collection=this.collections[0]),e.close(),this.loading=!1},e=>{this.errorMessage=e.error||"Error.",this.loading=!1})}).bind(this),message:""},e.open(t)}addGroup(){const e=this.fieldForm.get("newGroup");if(!e||!e.valid||!e.value)return!1;this.formErrors.fld_newGroup="";const t=e.value;return this.model.groups.indexOf(t)>-1?(this.formErrors.fld_newGroup+=this.validationMessages.fld_newGroup.exists,!1):(this.model.groups.push(t),this.fieldModel.group=t,this.elementAddGroupBlock.nativeElement.style.display="none",!0)}deleteGroup(){const e=this.fieldForm.get("group").value;let t=Object(b.findIndex)(this.model.fields,{group:e});this.errorFieldMessage="",t>-1?this.errorFieldMessage="You can't delete a group because it is not empty.":(t=this.model.groups.indexOf(e),t>-1&&this.model.groups.splice(t,1))}editField(e){this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="edit_field",this.fieldModel=Object(b.cloneDeep)(e);const t={};for(const i in this.fieldsFormOptions)this.fieldsFormOptions.hasOwnProperty(i)&&(t[i]=e[i]||"");this.fieldForm.setValue(t),this.currentFieldName=this.fieldModel.name,this.fld_submitted=!1}copyField(e){this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="add_field",this.fieldModel=Object(b.cloneDeep)(e),this.fieldModel.name="",this.fieldForm.setValue(this.fieldModel),this.currentFieldName="",this.fld_submitted=!1}deleteField(e){const t=Object(b.findIndex)(this.model.fields,{name:e.name});-1!==t?this.model.fields.splice(t,1):this.errorMessage="Field not found."}resetFieldForm(){this.action="add_field",this.errorMessage="",this.errorFieldMessage="",this.fld_submitted=!1,this.currentFieldName="",this.fieldForm.reset(),this.fieldModel=new C.a(0,"","","","",{},"",{},"",!1,!1,!1)}editFieldCancel(){this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.resetFieldForm(),this.onValueChanged("fieldForm","fld_")}fieldMove(e,t){if("up"===t&&0===e||"down"===t&&e===this.model.fields.length-1)return;const i="up"===t?e-1:e+1,o=this.model.fields[e];this.model.fields.splice(e,1),this.model.fields.splice(i,0,o)}submitField(){if(this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.fld_submitted=!0,!this.fieldForm.valid)return this.onValueChanged("fieldForm","fld_"),void(this.fld_submitted=!1);const e=Object(b.cloneDeep)(this.fieldModel);e.inputProperties=Object(b.extend)({},this.fieldModel.inputProperties),e.outputProperties=Object(b.extend)({},this.fieldModel.outputProperties);let t=Object(b.findIndex)(this.model.fields,{name:e.name});t>-1&&this.currentFieldName!==e.name?this.errorMessage='A field named "'+e.name+'" already exists.':("add_field"===this.action?this.model.fields.push(e):"edit_field"===this.action&&(t=Object(b.findIndex)(this.model.fields,{name:this.currentFieldName}),t>-1&&(this.model.fields[t]=e)),this.resetFieldForm())}getFieldTypeProperty(e,t){if(!e)return null;let i=null;const o=Object(b.findIndex)(this.fieldTypes,{name:e});return o>-1&&void 0!==this.fieldTypes[o][t]&&(i=this.fieldTypes[o][t]),i}sortingInit(e,t,i){let o;i&&i.preventDefault(),this.sortingfieldName=e,o=t?this.model.fields.filter(e=>e[t]):this.model.fields,e&&o.sort((function(t,i){return t[e]-i[e]})),this.sortData=[],o.forEach(e=>{this.sortData.push({name:e.name,title:e.title})}),this.blockFieldList.nativeElement.style.display="none"}sortingApply(){if(this.sortingfieldName)this.sortData.forEach((e,t)=>{const i=this.model.fields.findIndex(t=>t.name===e.name);i>-1&&(this.model.fields[i][this.sortingfieldName]=t)});else{const e=this.sortData.map(e=>e.name);this.model.fields.sort((function(t,i){return e.indexOf(t.name)-e.indexOf(i.name)}))}this.sortingReset()}sortingReset(){const e=Object(b.findIndex)(this.model.fields,{name:this.currentFieldName});this.action=e>-1?"edit_field":"add_field",this.sortData.splice(0,this.sortData.length),this.sortingfieldName="",this.blockFieldList.nativeElement.style.display="block"}save(e=!1,t){t&&t.preventDefault(),this.submitted=!0,this.sortData.length>0&&this.sortingApply(),setTimeout(()=>{if(!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().subscribe({next:t=>{e?this.closeModal():t&&t.id&&(this.model.id=t.id,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1}})},1)}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(h.e),r.Qb(y.a),r.Qb(g.a),r.Qb(O.b),r.Qb(O.v),r.Qb(l.d),r.Qb(r.l),r.Qb(Ie),r.Qb(Ve),r.Qb(O.h))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-content-type-modal-content"]],viewQuery:function(e,t){var i;1&e&&(r.Jc(Ee,!0),r.Jc(Oe,!0),r.Jc(Te,!0),r.Sc(Me,!0)),2&e&&(r.Cc(i=r.jc())&&(t.elementAddCollectionBlock=i.first),r.Cc(i=r.jc())&&(t.elementAddGroupBlock=i.first),r.Cc(i=r.jc())&&(t.accordion=i.first),r.Cc(i=r.jc())&&(t.blockFieldList=i.first))},features:[r.Ab],decls:286,vars:229,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["confirmPopover",""],[1,"modal-body","py-0"],[1,"row","mb-3"],[1,"col-lg-4",3,"formGroup"],[1,"form-group","form-group-message"],[1,"label-filled"],["type","text","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],["for","fieldName",1,"label-filled"],[1,"input-group"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group"],["type","text","rows","3","name","description","formControlName","description",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row","form-group-message"],[1,"col-12"],[1,"form-group","mb-0"],["name","collection","formControlName","collection",1,"custom-select","custom-select-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"icon-plus"],["triggers","manual",1,"input-group-append",3,"ngbPopover"],["buttonDeleteCollection","ngbPopover"],[1,"card","p-1","mt-2","form-group-message",2,"display","none"],["addCollectionBlock",""],["type","text","formControlName","newCollection",1,"form-control","form-control-sm"],["addCollectionField",""],["class","alert alert-danger mb-1",4,"ngIf"],[1,"text-right","mt-1"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isCreateByUsersAllowed","formControlName","isCreateByUsersAllowed",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"for"],[1,"card","card-body","p-2","pl-3"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"col-lg-8",3,"formGroup"],[1,"label-filled",3,"hidden"],[1,"card"],[1,"card-body"],[1,"col-md-5"],[1,"col-md-7"],["type","text","name","field_title","formControlName","title",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["type","text","name","field_name","formControlName","name",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"form-group","row"],["type","text","rows","3","name","field_description","formControlName","description",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["name","field_inputType","formControlName","inputType","placement","left",1,"custom-select","custom-select-sm",3,"ngModel","ngbTooltip","ngModelChange"],["value",""],[1,"icon-cog"],[1,"card","card-body","bg-light","mb-3",2,"display","none",3,"hidden"],["inputTypeOptionsBlock",""],[1,"alert","alert-secondary","small",3,"hidden"],["class","row form-group",4,"ngFor","ngForOf"],["name","field_outputType","formControlName","outputType","placement","left",1,"custom-select","custom-select-sm",3,"ngModel","ngbTooltip","ngModelChange"],["outputTypeOptionsBlock",""],[1,"form-group-message"],[1,"input-group","input-group-sm"],["name","field_group","formControlName","group",1,"custom-select",3,"ngModel","ngModelChange"],["addGroupBlock",""],["type","text","formControlName","newGroup",1,"form-control","form-control-sm"],["addGroupField",""],[1,"form-group","row","mb-0"],[1,"col-md-7","offset-md-5"],[1,"custom-control","custom-checkbox"],["type","checkbox","value","1","name","required","formControlName","required",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","showInTable","formControlName","showInTable",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","showInList","formControlName","showInList",1,"custom-control-input",3,"id","ngModel","ngModelChange"],["type","checkbox","value","1","name","isFilter","formControlName","isFilter",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"alert","alert-danger","mt-3","mb-3",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"mt-3"],["type","button",1,"btn","btn-sm","btn-info","btn-wide",3,"hidden","click"],["type","button",1,"btn","btn-sm","btn-success","btn-wide",3,"hidden","click"],[1,"icon-check"],["type","button",1,"btn","btn-sm","btn-secondary","btn-wide",3,"click"],["activeIds","accordion-content-type-fields",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-content-type-fields",3,"title"],["ngbPanelContent",""],[1,"alert","alert-danger","mt-3","mb-0",3,"hidden"],[1,"modal-footer","d-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"text-center"],["class","alert alert-danger p-2",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"alert","alert-danger","p-2"],[1,"alert","alert-danger"],[3,"value"],[1,"alert","alert-danger","mb-1"],[1,"row","form-group"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","ngModelChange"],["blockFieldList",""],[1,"text-right","mb-2",3,"hidden"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"icon-shuffle"],[1,"table-responsive"],[1,"table","table-striped","table-divided","mb-0"],["class","show-on-hover-parent",4,"ngFor","ngForOf"],[1,"table-active",3,"hidden"],["colspan","5",1,"text-center","p-3"],[3,"items","itemsChange","save","cancel"],[1,"show-on-hover-parent"],[1,"text-muted"],["outputType","boolean",3,"value"],[1,"relative"],[1,"show-on-hover-right"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"hidden","ngbTooltip","click"],[1,"icon-pencil"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"ngbTooltip","click"],[1,"icon-stack"]],template:function(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ic("click",(function(e){return t.closeModal(e)})),r.Rb(3,"i",3),r.Wb(4,"span"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Vb(),r.Wb(7,"button",2),r.ic("click",(function(e){return t.minimize(e)})),r.Rb(8,"i",4),r.Wb(9,"span"),r.Oc(10),r.lc(11,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(12,"div",5),r.Wb(13,"div",6),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(e){return t.maximize(e)})),r.lc(16,"translate"),r.Rb(17,"i",9),r.Vb(),r.Wb(18,"button",10),r.ic("click",(function(e){return t.closeModal(e)})),r.lc(19,"translate"),r.Rb(20,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"h4",12),r.Oc(22),r.Vb(),r.Vb(),r.Mc(23,we,12,10,"ng-template",null,13,r.Nc),r.Wb(25,"form"),r.Wb(26,"div",14),r.Wb(27,"div",15),r.Wb(28,"div",16),r.Wb(29,"div",17),r.Wb(30,"label",18),r.Oc(31),r.lc(32,"translate"),r.Vb(),r.Wb(33,"input",19),r.ic("ngModelChange",(function(e){return t.model.title=e})),r.Vb(),r.Mc(34,ke,2,1,"div",20),r.Vb(),r.Wb(35,"div",17),r.Wb(36,"label",21),r.Oc(37),r.lc(38,"translate"),r.Vb(),r.Wb(39,"div",22),r.Wb(40,"input",23),r.ic("ngModelChange",(function(e){return t.model.name=e})),r.Vb(),r.Wb(41,"div",24),r.Wb(42,"button",25),r.ic("click",(function(){return t.generateName(t.model)})),r.lc(43,"translate"),r.Rb(44,"i",26),r.Vb(),r.Vb(),r.Vb(),r.Mc(45,Re,2,1,"div",20),r.Vb(),r.Wb(46,"div",27),r.Wb(47,"label",18),r.Oc(48),r.lc(49,"translate"),r.Vb(),r.Wb(50,"textarea",28),r.ic("ngModelChange",(function(e){return t.model.description=e})),r.Vb(),r.Vb(),r.Wb(51,"div",29),r.Wb(52,"div",30),r.Wb(53,"div",31),r.Wb(54,"label",18),r.Oc(55),r.lc(56,"translate"),r.Vb(),r.Wb(57,"div",22),r.Wb(58,"select",32),r.ic("ngModelChange",(function(e){return t.model.collection=e})),r.Mc(59,Le,2,2,"option",33),r.Vb(),r.Wb(60,"div",24),r.Wb(61,"button",34),r.ic("click",(function(){r.Ec(e);const i=r.Dc(70),o=r.Dc(72);return t.displayToggle(i),o.value="",t.onValueChanged(),o.focus()})),r.lc(62,"translate"),r.Rb(63,"i",35),r.Vb(),r.Vb(),r.Wb(64,"div",36,37),r.Wb(66,"button",34),r.ic("click",(function(){r.Ec(e);const i=r.Dc(65);return t.deleteCollection(i)})),r.lc(67,"translate"),r.Rb(68,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Wb(69,"div",38,39),r.Rb(71,"input",40,41),r.Mc(73,Ae,2,1,"div",42),r.Wb(74,"div",43),r.Wb(75,"button",44),r.ic("click",(function(){return t.addCollection()})),r.Oc(76),r.lc(77,"translate"),r.Vb(),r.Oc(78," \xa0 "),r.Wb(79,"button",44),r.ic("click",(function(){return r.Ec(e),r.Dc(70).style.display="none",t.formErrors.newCollection=""})),r.Oc(80),r.lc(81,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(82,"div",27),r.Wb(83,"div",45),r.Wb(84,"input",46),r.ic("ngModelChange",(function(e){return t.model.isCreateByUsersAllowed=e})),r.Vb(),r.Wb(85,"label",47),r.Oc(86),r.lc(87,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(88,"div",27),r.Wb(89,"div",48),r.Wb(90,"div",45),r.Wb(91,"input",49),r.ic("ngModelChange",(function(e){return t.model.isActive=e})),r.Vb(),r.Wb(92,"label",47),r.Oc(93),r.lc(94,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(95,"div",50),r.Wb(96,"label",51),r.Oc(97),r.lc(98,"translate"),r.Vb(),r.Wb(99,"label",51),r.Oc(100),r.lc(101,"translate"),r.Vb(),r.Wb(102,"div",52),r.Wb(103,"div",53),r.Wb(104,"div",29),r.Wb(105,"div",54),r.Wb(106,"label"),r.Oc(107),r.lc(108,"translate"),r.Vb(),r.Vb(),r.Wb(109,"div",55),r.Wb(110,"input",56),r.ic("ngModelChange",(function(e){return t.fieldModel.title=e})),r.Vb(),r.Mc(111,Fe,2,1,"div",20),r.Vb(),r.Vb(),r.Wb(112,"div",29),r.Wb(113,"div",54),r.Wb(114,"label"),r.Oc(115),r.lc(116,"translate"),r.Vb(),r.Vb(),r.Wb(117,"div",55),r.Wb(118,"div",22),r.Wb(119,"input",57),r.ic("ngModelChange",(function(e){return t.fieldModel.name=e})),r.Vb(),r.Wb(120,"div",24),r.Wb(121,"button",34),r.ic("click",(function(){return t.generateName(t.fieldModel)})),r.lc(122,"translate"),r.Rb(123,"i",26),r.Vb(),r.Vb(),r.Vb(),r.Mc(124,Ne,2,1,"div",20),r.Vb(),r.Vb(),r.Wb(125,"div",58),r.Wb(126,"div",54),r.Wb(127,"label"),r.Oc(128),r.lc(129,"translate"),r.Vb(),r.Vb(),r.Wb(130,"div",55),r.Wb(131,"textarea",59),r.ic("ngModelChange",(function(e){return t.fieldModel.description=e})),r.Vb(),r.Vb(),r.Vb(),r.Wb(132,"div",29),r.Wb(133,"div",54),r.Wb(134,"label"),r.Oc(135),r.lc(136,"translate"),r.Vb(),r.Vb(),r.Wb(137,"div",55),r.Wb(138,"div",22),r.Wb(139,"select",60),r.ic("ngModelChange",(function(e){return t.fieldModel.inputType=e}))("ngModelChange",(function(){return t.selectFieldTypeProperties("input")})),r.Rb(140,"option",61),r.Mc(141,Pe,2,2,"option",33),r.Vb(),r.Wb(142,"div",24),r.Wb(143,"button",34),r.ic("click",(function(){r.Ec(e);const i=r.Dc(148);return t.displayToggle(i)})),r.lc(144,"translate"),r.Rb(145,"i",62),r.Vb(),r.Vb(),r.Vb(),r.Mc(146,_e,2,1,"div",20),r.Vb(),r.Vb(),r.Wb(147,"div",63,64),r.Wb(149,"div"),r.Wb(150,"div",65),r.Oc(151," There are no parameters. "),r.Vb(),r.Mc(152,Qe,5,4,"div",66),r.Vb(),r.Wb(153,"div",43),r.Wb(154,"button",44),r.ic("click",(function(){return r.Ec(e),r.Dc(148).style.display="none"})),r.Oc(155),r.lc(156,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(157,"div",29),r.Wb(158,"div",54),r.Wb(159,"label"),r.Oc(160),r.lc(161,"translate"),r.Vb(),r.Vb(),r.Wb(162,"div",55),r.Wb(163,"div",22),r.Wb(164,"select",67),r.ic("ngModelChange",(function(e){return t.fieldModel.outputType=e}))("ngModelChange",(function(){return t.selectFieldTypeProperties("output")})),r.Rb(165,"option",61),r.Mc(166,qe,2,2,"option",33),r.Vb(),r.Wb(167,"div",24),r.Wb(168,"button",34),r.ic("click",(function(){r.Ec(e);const i=r.Dc(173);return t.displayToggle(i)})),r.lc(169,"translate"),r.Rb(170,"i",62),r.Vb(),r.Vb(),r.Vb(),r.Mc(171,Ge,2,1,"div",20),r.Vb(),r.Vb(),r.Wb(172,"div",63,68),r.Wb(174,"div",65),r.Oc(175," There are no parameters. "),r.Vb(),r.Mc(176,Ue,5,4,"div",66),r.Wb(177,"div",43),r.Wb(178,"button",44),r.ic("click",(function(){return r.Ec(e),r.Dc(173).style.display="none"})),r.Oc(179),r.lc(180,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(181,"div",58),r.Wb(182,"div",54),r.Wb(183,"label"),r.Oc(184),r.lc(185,"translate"),r.Vb(),r.Vb(),r.Wb(186,"div",55),r.Wb(187,"div",69),r.Wb(188,"div",70),r.Wb(189,"select",71),r.ic("ngModelChange",(function(e){return t.fieldModel.group=e})),r.Rb(190,"option",61),r.Mc(191,je,2,2,"option",33),r.Vb(),r.Wb(192,"div",24),r.Wb(193,"button",34),r.ic("click",(function(){r.Ec(e);const i=r.Dc(202),o=r.Dc(204);return t.displayToggle(i),o.value="",o.focus()})),r.lc(194,"translate"),r.Rb(195,"i",35),r.Vb(),r.Vb(),r.Wb(196,"div",24),r.Wb(197,"button",34),r.ic("click",(function(){return t.deleteGroup()})),r.lc(198,"translate"),r.Rb(199,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Mc(200,Be,2,1,"div",20),r.Wb(201,"div",38,72),r.Rb(203,"input",73,74),r.Mc(205,Ye,2,1,"div",42),r.Wb(206,"div",43),r.Wb(207,"button",44),r.ic("click",(function(){return t.addGroup()})),r.Oc(208),r.lc(209,"translate"),r.Vb(),r.Oc(210," \xa0 "),r.Wb(211,"button",44),r.ic("click",(function(){return r.Ec(e),r.Dc(202).style.display="none",t.formErrors.fld_newGroup=""})),r.Oc(212),r.lc(213,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(214,"div",75),r.Wb(215,"div",76),r.Wb(216,"div",77),r.Wb(217,"input",78),r.ic("ngModelChange",(function(e){return t.fieldModel.required=e})),r.Vb(),r.Wb(218,"label",47),r.Oc(219),r.lc(220,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(221,"div",75),r.Wb(222,"div",76),r.Wb(223,"div",77),r.Wb(224,"input",79),r.ic("ngModelChange",(function(e){return t.fieldModel.showInTable=e})),r.Vb(),r.Wb(225,"label",47),r.Oc(226),r.lc(227,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(228,"div",75),r.Wb(229,"div",76),r.Wb(230,"div",77),r.Wb(231,"input",80),r.ic("ngModelChange",(function(e){return t.fieldModel.showInList=e})),r.Vb(),r.Wb(232,"label",47),r.Oc(233),r.lc(234,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(235,"div",75),r.Wb(236,"div",76),r.Wb(237,"div",77),r.Wb(238,"input",81),r.ic("ngModelChange",(function(e){return t.fieldModel.isFilter=e})),r.Vb(),r.Wb(239,"label",47),r.Oc(240),r.lc(241,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(242,"div",82),r.Wb(243,"button",83),r.ic("click",(function(){return t.errorFieldMessage=""})),r.Wb(244,"span",84),r.Oc(245,"\xd7"),r.Vb(),r.Vb(),r.Oc(246),r.Vb(),r.Wb(247,"div",85),r.Wb(248,"button",86),r.ic("click",(function(){return t.submitField()})),r.Rb(249,"i",35),r.Oc(250),r.lc(251,"translate"),r.Vb(),r.Wb(252,"button",87),r.ic("click",(function(){return t.submitField()})),r.Rb(253,"i",88),r.Oc(254),r.lc(255,"translate"),r.Vb(),r.Oc(256," \xa0 "),r.Wb(257,"button",89),r.ic("click",(function(){return t.editFieldCancel()})),r.Oc(258),r.lc(259,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(260,"ngb-accordion",90,91),r.Wb(262,"ngb-panel",92),r.lc(263,"translate"),r.Mc(264,$e,44,31,"ng-template",93),r.Vb(),r.Vb(),r.Wb(265,"div",94),r.Wb(266,"button",83),r.ic("click",(function(){return t.errorMessage=""})),r.Wb(267,"span",84),r.Oc(268,"\xd7"),r.Vb(),r.Vb(),r.Oc(269),r.Vb(),r.Vb(),r.Wb(270,"div",95),r.Wb(271,"div",96),r.Wb(272,"button",97),r.ic("click",(function(e){return t.save(!0,e)})),r.Wb(273,"span"),r.Oc(274),r.lc(275,"translate"),r.Vb(),r.Vb(),r.Wb(276,"div",98),r.Rb(277,"button",99),r.Wb(278,"div",100),r.Wb(279,"button",101),r.ic("click",(function(e){return t.save(!1,e)})),r.Oc(280),r.lc(281,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(282,"button",102),r.ic("click",(function(e){return t.closeModal(e)})),r.Wb(283,"span"),r.Oc(284),r.lc(285,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=r.Dc(24);r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(6,143,"CLOSE")),r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(11,145,"MINIMIZE")),r.Db(5),r.rc("title",r.mc(16,147,"EXPAND")),r.Db(3),r.rc("title",r.mc(19,149,"CLOSE")),r.Db(4),r.Pc(t.modalTitle),r.Db(3),r.Ib("loading",t.loading),r.Db(3),r.rc("formGroup",t.form),r.Db(3),r.Qc(" ",r.mc(32,151,"TITLE")," "),r.Db(2),r.Ib("is-invalid",t.formErrors.title),r.rc("ngModel",t.model.title),r.Db(1),r.rc("ngIf",t.formErrors.title),r.Db(3),r.Qc(" ",r.mc(38,153,"SYSTEM_NAME")," "),r.Db(2),r.Ib("is-invalid",t.formErrors.name),r.Db(1),r.Ib("is-invalid",t.formErrors.name),r.rc("ngModel",t.model.name),r.Db(2),r.sc("ngbTooltip",r.mc(43,155,"GENERATE")),r.Db(3),r.rc("ngIf",t.formErrors.name),r.Db(3),r.Qc(" ",r.mc(49,157,"DESCRIPTION")," "),r.Db(2),r.rc("ngModel",t.model.description),r.Db(5),r.Pc(r.mc(56,159,"COLLECTION")),r.Db(2),r.Ib("is-invalid",t.formErrors.collection),r.Db(1),r.Ib("is-invalid",t.formErrors.collection),r.rc("ngModel",t.model.collection),r.Db(1),r.rc("ngForOf",t.collections),r.Db(2),r.sc("ngbTooltip",r.mc(62,161,"ADD_COLLECTION")),r.Db(3),r.rc("ngbPopover",e),r.Db(2),r.sc("ngbTooltip",r.mc(67,163,"DELETE")),r.Db(5),r.Ib("is-invalid",t.formErrors.newCollection),r.Db(2),r.rc("ngIf",t.formErrors.newCollection),r.Db(3),r.Qc(" ",r.mc(77,165,"ADD")," "),r.Db(4),r.Qc(" ",r.mc(81,167,"CANCEL")," "),r.Db(4),r.tc("id","fieldIsCreateByUsersAllowed",t.uniqueId,""),r.rc("ngModel",t.model.isCreateByUsersAllowed),r.Db(1),r.tc("for","fieldIsCreateByUsersAllowed",t.uniqueId,""),r.Db(1),r.Qc(" ",r.mc(87,169,"CREATE_BY_USERS_ALLOWED")," "),r.Db(5),r.tc("id","fieldIsActive",t.uniqueId,""),r.rc("ngModel",t.model.isActive),r.Db(1),r.tc("for","fieldIsActive",t.uniqueId,""),r.Db(1),r.Pc(r.mc(94,171,"ACTIVE")),r.Db(2),r.rc("formGroup",t.fieldForm),r.Db(1),r.rc("hidden","add_field"!=t.action),r.Db(1),r.Qc(" ",r.mc(98,173,"ADD_FIELD")," "),r.Db(2),r.rc("hidden","edit_field"!=t.action),r.Db(1),r.Qc(" ",r.mc(101,175,"EDIT_FIELD")," "),r.Db(7),r.Pc(r.mc(108,177,"TITLE")),r.Db(3),r.Ib("is-invalid",t.formErrors.fld_title),r.rc("ngModel",t.fieldModel.title),r.Db(1),r.rc("ngIf",t.formErrors.fld_title),r.Db(4),r.Pc(r.mc(116,179,"SYSTEM_NAME")),r.Db(3),r.Ib("is-invalid",t.formErrors.fld_name),r.Db(1),r.Ib("is-invalid",t.formErrors.fld_name),r.rc("ngModel",t.fieldModel.name),r.Db(2),r.sc("ngbTooltip",r.mc(122,181,"GENERATE")),r.Db(3),r.rc("ngIf",t.formErrors.fld_name),r.Db(4),r.Pc(r.mc(129,183,"DESCRIPTION")),r.Db(3),r.rc("ngModel",t.fieldModel.description),r.Db(4),r.Pc(r.mc(136,185,"INPUT_TYPE")),r.Db(3),r.Ib("is-invalid",t.formErrors.fld_inputType),r.Db(1),r.Ib("is-invalid",t.formErrors.fld_inputType),r.rc("ngModel",t.fieldModel.inputType)("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.inputType,"description")),r.Db(2),r.rc("ngForOf",t.fieldTypes),r.Db(2),r.sc("ngbTooltip",r.mc(144,187,"OPTIONS")),r.Db(3),r.rc("ngIf",t.formErrors.fld_inputType),r.Db(1),r.rc("hidden",!t.fieldModel.inputType),r.Db(3),r.rc("hidden",t.fieldTypeProperties.input.length>0),r.Db(2),r.rc("ngForOf",t.fieldTypeProperties.input),r.Db(3),r.Qc(" ",r.mc(156,189,"CLOSE")," "),r.Db(5),r.Pc(r.mc(161,191,"OUTPUT_TYPE")),r.Db(3),r.Ib("is-invalid",t.formErrors.fld_outputType),r.Db(1),r.Ib("is-invalid",t.formErrors.fld_outputType),r.rc("ngModel",t.fieldModel.outputType)("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.outputType,"description")),r.Db(2),r.rc("ngForOf",t.fieldTypes),r.Db(2),r.sc("ngbTooltip",r.mc(169,193,"OPTIONS")),r.Db(3),r.rc("ngIf",t.formErrors.fld_outputType),r.Db(1),r.rc("hidden",!t.fieldModel.outputType),r.Db(2),r.rc("hidden",t.fieldTypeProperties.output.length>0),r.Db(2),r.rc("ngForOf",t.fieldTypeProperties.output),r.Db(3),r.Qc(" ",r.mc(180,195,"CLOSE")," "),r.Db(5),r.Pc(r.mc(185,197,"GROUP")),r.Db(4),r.Ib("is-invalid",t.formErrors.fld_group),r.Db(1),r.Ib("is-invalid",t.formErrors.fld_group),r.rc("ngModel",t.fieldModel.group),r.Db(2),r.rc("ngForOf",t.model.groups),r.Db(2),r.sc("ngbTooltip",r.mc(194,199,"ADD_GROUP")),r.Db(4),r.sc("ngbTooltip",r.mc(198,201,"DELETE_GROUP")),r.Db(3),r.rc("ngIf",t.formErrors.fld_group),r.Db(3),r.Ib("is-invalid",t.formErrors.fld_newGroup),r.Db(2),r.rc("ngIf",t.formErrors.fld_newGroup),r.Db(3),r.Qc(" ",r.mc(209,203,"ADD")," "),r.Db(4),r.Qc(" ",r.mc(213,205,"CANCEL")," "),r.Db(5),r.tc("id","fieldRequired",t.uniqueId,""),r.rc("ngModel",t.fieldModel.required),r.Db(1),r.tc("for","fieldRequired",t.uniqueId,""),r.Db(1),r.Pc(r.mc(220,207,"REQUIRED")),r.Db(5),r.tc("id","fieldShowInTable",t.uniqueId,""),r.rc("ngModel",t.fieldModel.showInTable),r.Db(1),r.tc("for","fieldShowInTable",t.uniqueId,""),r.Db(1),r.Pc(r.mc(227,209,"SHOW_IN_TABLE")),r.Db(5),r.tc("id","fieldShowInList",t.uniqueId,""),r.rc("ngModel",t.fieldModel.showInList),r.Db(1),r.tc("for","fieldShowInList",t.uniqueId,""),r.Db(1),r.Pc(r.mc(234,211,"SHOW_IN_LIST")),r.Db(5),r.tc("id","fieldIsFilter",t.uniqueId,""),r.rc("ngModel",t.fieldModel.isFilter),r.Db(1),r.tc("for","fieldIsFilter",t.uniqueId,""),r.Db(1),r.Pc(r.mc(241,213,"SHOW_IN_FILTER")),r.Db(2),r.rc("hidden",!t.errorFieldMessage),r.Db(4),r.Qc(" ",t.errorFieldMessage," "),r.Db(2),r.rc("hidden","add_field"!=t.action),r.Db(2),r.Qc(" ",r.mc(251,215,"ADD_FIELD")," "),r.Db(2),r.rc("hidden","edit_field"!=t.action),r.Db(2),r.Qc(" ",r.mc(255,217,"SAVE_FIELD")," "),r.Db(4),r.Qc(" ",r.mc(259,219,"CANCEL")," "),r.Db(2),r.rc("closeOthers",!0),r.Db(2),r.rc("title",r.mc(263,221,"FIELDS")),r.Db(3),r.rc("hidden",!t.errorMessage),r.Db(4),r.Qc(" ",t.errorMessage," "),r.Db(3),r.rc("disabled",t.submitted),r.Db(2),r.Pc(r.mc(275,223,"SAVE_AND_CLOSE")),r.Db(3),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(281,225,"SAVE")),r.Db(4),r.Pc(r.mc(285,227,"CLOSE"))}},directives:[h.y,h.o,h.p,h.h,h.b,h.n,h.g,o.p,O.u,h.v,o.o,O.m,h.a,h.r,h.x,O.a,O.k,O.l,O.d,O.g,O.f,O.e,h.q,We.a,Ce.a],pipes:[l.c],encapsulation:2}),e})(),Ke=(()=>{class e extends m.a{constructor(e,t,i,o){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.title="\u0422\u0438\u043f\u044b \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430",this.queryOptions=new F.a("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"collection",sortName:"collection",title:"COLLECTION",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}getModalContent(){return Je}getModalElementId(e){return["modal","content_type",e||0].join("-")}setModalInputs(e,t=!1,i=""){super.setModalInputs(e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?`${this.getLangString("CONTENT_TYPE")} #${e}`:this.getLangString("ADD_CONTENT_TYPE")}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(y.a),r.Qb(O.b),r.Qb(O.h),r.Qb(l.d))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-shk-content-types"]],features:[r.Ab],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"a",2),r.Rb(3,"i",3),r.Oc(4," \xa0 "),r.Wb(5,"span"),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",4),r.Wb(9,"div",5),r.Wb(10,"button",6),r.Wb(11,"span"),r.Oc(12),r.lc(13,"translate"),r.Vb(),r.Vb(),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(){return t.blockSelected()})),r.Oc(16),r.lc(17,"translate"),r.Vb(),r.Wb(18,"button",8),r.ic("click",(function(){return t.deleteSelected()})),r.Oc(19),r.lc(20,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"button",9),r.ic("click",(function(){return t.modalOpen()})),r.Rb(22,"i",10),r.Oc(23," \xa0 "),r.Wb(24,"span"),r.Oc(25),r.lc(26,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Rb(27,"div",11),r.Vb(),r.Wb(28,"app-table",12,13),r.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),r.Vb()),2&e&&(r.Db(2),r.rc("routerLink",r.vc(23,Xe)),r.Db(4),r.Pc(r.mc(7,13,"CATALOG")),r.Db(6),r.Pc(r.mc(13,15,"BATCH_ACTIONS")),r.Db(4),r.Pc(r.mc(17,17,"DISABLE_ENABLE")),r.Db(3),r.Pc(r.mc(20,19,"DELETE")),r.Db(6),r.Pc(r.mc(26,21,"ADD")),r.Db(3),r.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[s.e,O.d,O.g,O.f,ge.a],pipes:[l.c],encapsulation:2}),e})();class He{constructor(e,t,i,o,n,s,r){this.id=e,this.name=t,this.title=i,this.description=o,this.isActive=n,this.inputProperties=s,this.outputProperties=r}}function Ze(e,t){if(1&e&&(r.Wb(0,"div",52),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.title," ")}}function et(e,t){if(1&e&&(r.Wb(0,"div",52),r.Oc(1),r.Vb()),2&e){const e=r.kc();r.Db(1),r.Qc(" ",e.formErrors.name," ")}}const tt=function(e){return{"is-invalid":e}};function it(e,t){if(1&e){const e=r.Xb();r.Wb(0,"tr",61),r.Wb(1,"td"),r.Rb(2,"input",62),r.Vb(),r.Wb(3,"td",63),r.Rb(4,"input",64),r.Vb(),r.Wb(5,"td",63),r.Rb(6,"input",65),r.Vb(),r.Wb(7,"td",63),r.Wb(8,"button",66),r.ic("click",(function(i){r.Ec(e);const o=t.index;return r.kc(3).arrayFieldDelete("inputProperties",o,i)})),r.lc(9,"translate"),r.Rb(10,"i",11),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit;r.rc("formGroupName",t.index+""),r.Db(2),r.rc("ngClass",r.wc(7,tt,e.controls.name.touched&&!e.controls.name.valid)),r.Db(2),r.rc("ngClass",r.wc(9,tt,e.controls.title.touched&&!e.controls.title.valid)),r.Db(2),r.rc("ngClass",r.wc(11,tt,e.controls.default_value.touched&&!e.controls.default_value.valid)),r.Db(2),r.sc("ngbTooltip",r.mc(9,5,"DELETE"))}}function ot(e,t){if(1&e&&(r.Wb(0,"tbody"),r.Mc(1,it,11,13,"tr",60),r.Vb()),2&e){const e=r.kc(2);r.Db(1),r.rc("ngForOf",e.arrayFields.inputProperties.controls)}}function nt(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",53),r.Wb(1,"table",54),r.Wb(2,"thead"),r.Wb(3,"tr"),r.Wb(4,"th"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Wb(7,"th"),r.Oc(8),r.lc(9,"translate"),r.Vb(),r.Wb(10,"th"),r.Oc(11),r.lc(12,"translate"),r.Vb(),r.Rb(13,"th"),r.Vb(),r.Vb(),r.Mc(14,ot,2,1,"tbody",55),r.Wb(15,"tfoot"),r.Wb(16,"tr",56),r.Wb(17,"td",57),r.Wb(18,"button",58),r.ic("click",(function(t){return r.Ec(e),r.kc().arrayFieldAdd("inputProperties",t)})),r.Rb(19,"i",59),r.Oc(20," \xa0 "),r.Wb(21,"span"),r.Oc(22),r.lc(23,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=r.kc();r.Db(5),r.Qc(" ",r.mc(6,5,"SYSTEM_NAME")," "),r.Db(3),r.Qc(" ",r.mc(9,7,"TITLE")," "),r.Db(3),r.Qc(" ",r.mc(12,9,"DEFAULT_VALUE")," "),r.Db(3),r.rc("ngIf",e.arrayFields.inputProperties),r.Db(8),r.Pc(r.mc(23,11,"ADD"))}}function st(e,t){if(1&e){const e=r.Xb();r.Wb(0,"tr",61),r.Wb(1,"td"),r.Rb(2,"input",62),r.Vb(),r.Wb(3,"td",63),r.Rb(4,"input",64),r.Vb(),r.Wb(5,"td",63),r.Rb(6,"input",65),r.Vb(),r.Wb(7,"td",63),r.Wb(8,"button",66),r.ic("click",(function(i){r.Ec(e);const o=t.index;return r.kc(3).arrayFieldDelete("outputProperties",o,i)})),r.lc(9,"translate"),r.Rb(10,"i",11),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit;r.rc("formGroupName",t.index+""),r.Db(2),r.rc("ngClass",r.wc(7,tt,e.controls.name.touched&&!e.controls.name.valid)),r.Db(2),r.rc("ngClass",r.wc(9,tt,e.controls.title.touched&&!e.controls.title.valid)),r.Db(2),r.rc("ngClass",r.wc(11,tt,e.controls.default_value.touched&&!e.controls.default_value.valid)),r.Db(2),r.sc("ngbTooltip",r.mc(9,5,"DELETE"))}}function rt(e,t){if(1&e&&(r.Wb(0,"tbody"),r.Mc(1,st,11,13,"tr",60),r.Vb()),2&e){const e=r.kc(2);r.Db(1),r.rc("ngForOf",e.arrayFields.outputProperties.controls)}}function lt(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",67),r.Wb(1,"table",54),r.Wb(2,"thead"),r.Wb(3,"tr"),r.Wb(4,"th"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Wb(7,"th"),r.Oc(8),r.lc(9,"translate"),r.Vb(),r.Wb(10,"th"),r.Oc(11),r.lc(12,"translate"),r.Vb(),r.Rb(13,"th"),r.Vb(),r.Vb(),r.Mc(14,rt,2,1,"tbody",55),r.Wb(15,"tfoot"),r.Wb(16,"tr",56),r.Wb(17,"td",57),r.Wb(18,"button",58),r.ic("click",(function(t){return r.Ec(e),r.kc().arrayFieldAdd("outputProperties",t)})),r.Rb(19,"i",59),r.Oc(20," \xa0 "),r.Wb(21,"span"),r.Oc(22),r.lc(23,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=r.kc();r.Db(5),r.Qc(" ",r.mc(6,5,"SYSTEM_NAME")," "),r.Db(3),r.Qc(" ",r.mc(9,7,"TITLE")," "),r.Db(3),r.Qc(" ",r.mc(12,9,"DEFAULT_VALUE")," "),r.Db(3),r.rc("ngIf",e.arrayFields.outputProperties),r.Db(8),r.Pc(r.mc(23,11,"ADD"))}}function ct(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",68),r.Wb(1,"button",69),r.ic("click",(function(){return r.Ec(e),r.kc().errorMessage=""})),r.Wb(2,"span",70),r.Oc(3,"\xd7"),r.Vb(),r.Vb(),r.Oc(4),r.Vb()}if(2&e){const e=r.kc();r.Db(4),r.Qc(" ",e.errorMessage," ")}}const at=function(e){return{"no-events":e}},dt=function(){return["/catalog"]};let bt=(()=>{class e extends Q.a{constructor(e,t,i,o,n,s){super(e,t,i,o,n),this.fb=e,this.activeModal=t,this.translateService=i,this.dataService=o,this.elRef=n,this.systemNameService=s,this.model=new He(0,"","","",!0,[],[]),this.formFields=[{name:"title",validators:[h.w.required]},{name:"name",validators:[h.w.required,h.w.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"isActive",validators:[]},{name:"inputProperties",validators:[],children:[{name:"name",validators:[h.w.required]},{name:"title",validators:[h.w.required]},{name:"default_value",validators:[]}]},{name:"outputProperties",validators:[],children:[{name:"name",validators:[h.w.required]},{name:"title",validators:[h.w.required]},{name:"default_value",validators:[]}]}]}generateName(e,t){t&&t.preventDefault();const i=this.getControl(this.form,null,"title").value||"";e.name=this.systemNameService.generateName(i),this.getControl(this.form,null,"name").setValue(e.name)}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(h.e),r.Qb(O.b),r.Qb(l.d),r.Qb(Ie),r.Qb(r.l),r.Qb(g.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-field-type-modal-content"]],features:[r.Ab],decls:84,vars:68,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-md-6"],[1,"form-group","form-group-message","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","formControlName","title","id","fieldTitle",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"form-group","form-group-message"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group","row"],[1,"col-12"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"],[1,"form-group"],["for","fieldDescription",1,"label-filled"],["rows","5","name","description","formControlName","description","id","fieldDescription",1,"form-control"],["activeIds","accordion-input-options",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-input-options",3,"title"],["ngbPanelContent",""],["id","accordion-output-options",3,"title"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],["formArrayName","inputProperties"],[1,"table","table-bordered","table-divided","mb-0"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],[1,"text-center"],["type","text","formControlName","title",1,"form-control",3,"ngClass"],["type","text","formControlName","default_value",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["formArrayName","outputProperties"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ic("click",(function(e){return t.closeModal(e)})),r.Rb(3,"i",3),r.Wb(4,"span"),r.Oc(5),r.lc(6,"translate"),r.Vb(),r.Vb(),r.Wb(7,"button",2),r.ic("click",(function(e){return t.minimize(e)})),r.Rb(8,"i",4),r.Wb(9,"span"),r.Oc(10),r.lc(11,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(12,"div",5),r.Wb(13,"div",6),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(e){return t.maximize(e)})),r.lc(16,"translate"),r.Rb(17,"i",9),r.Vb(),r.Wb(18,"button",10),r.ic("click",(function(e){return t.closeModal(e)})),r.lc(19,"translate"),r.Rb(20,"i",11),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"h4",12),r.Oc(22),r.Vb(),r.Vb(),r.Wb(23,"form",13,14),r.ic("ngSubmit",(function(){return t.onSubmit()})),r.Wb(25,"div",15),r.Wb(26,"div",16),r.Wb(27,"div",17),r.Wb(28,"div",18),r.Wb(29,"label",19),r.Oc(30),r.lc(31,"translate"),r.Vb(),r.Rb(32,"input",20),r.Mc(33,Ze,2,1,"div",21),r.Vb(),r.Wb(34,"div",22),r.Wb(35,"label",23),r.Oc(36),r.lc(37,"translate"),r.Vb(),r.Wb(38,"div",24),r.Rb(39,"input",25),r.Wb(40,"div",26),r.Wb(41,"button",27),r.ic("click",(function(){return t.generateName(t.model)})),r.lc(42,"translate"),r.Rb(43,"i",28),r.Vb(),r.Vb(),r.Vb(),r.Mc(44,et,2,1,"div",21),r.Vb(),r.Wb(45,"div",29),r.Wb(46,"div",30),r.Wb(47,"div",31),r.Wb(48,"div",32),r.Rb(49,"input",33),r.Wb(50,"label",34),r.Oc(51),r.lc(52,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(53,"div",17),r.Wb(54,"div",35),r.Wb(55,"label",36),r.Oc(56),r.lc(57,"translate"),r.Vb(),r.Rb(58,"textarea",37),r.Vb(),r.Vb(),r.Vb(),r.Wb(59,"ngb-accordion",38,39),r.Wb(61,"ngb-panel",40),r.lc(62,"translate"),r.Mc(63,nt,24,13,"ng-template",41),r.Vb(),r.Wb(64,"ngb-panel",42),r.lc(65,"translate"),r.Mc(66,lt,24,13,"ng-template",41),r.Vb(),r.Vb(),r.Mc(67,ct,5,1,"div",43),r.Vb(),r.Wb(68,"div",44),r.Wb(69,"div",45),r.Wb(70,"button",46),r.ic("click",(function(e){return t.save(!0,e)})),r.Wb(71,"span"),r.Oc(72),r.lc(73,"translate"),r.Vb(),r.Vb(),r.Wb(74,"div",47),r.Rb(75,"button",48),r.Wb(76,"div",49),r.Wb(77,"button",50),r.ic("click",(function(e){return t.save(!1,e)})),r.Oc(78),r.lc(79,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(80,"button",51),r.ic("click",(function(e){return t.closeModal(e)})),r.Wb(81,"span"),r.Oc(82),r.lc(83,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(6,32,"CLOSE")),r.Db(2),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(11,34,"MINIMIZE")),r.Db(5),r.rc("title",r.mc(16,36,"EXPAND")),r.Db(3),r.rc("title",r.mc(19,38,"CLOSE")),r.Db(4),r.Pc(t.modalTitle),r.Db(1),r.rc("formGroup",t.form)("ngClass",r.wc(60,at,t.submitted)),r.Db(2),r.Ib("loading",t.loading),r.Db(5),r.Pc(r.mc(31,40,"TITLE")),r.Db(2),r.rc("ngClass",r.wc(62,tt,t.form.controls.title.touched&&!t.form.controls.title.valid)),r.Db(1),r.rc("ngIf",t.formErrors.title),r.Db(3),r.Pc(r.mc(37,42,"SYSTEM_NAME")),r.Db(2),r.rc("ngClass",r.wc(64,tt,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.Db(1),r.rc("ngClass",r.wc(66,tt,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.Db(2),r.sc("ngbTooltip",r.mc(42,44,"GENERATE")),r.Db(3),r.rc("ngIf",t.formErrors.name),r.Db(5),r.tc("id","fieldIsActive",t.uniqueId,""),r.Db(1),r.tc("for","fieldIsActive",t.uniqueId,""),r.Db(1),r.Pc(r.mc(52,46,"ACTIVE")),r.Db(5),r.Pc(r.mc(57,48,"DESCRIPTION")),r.Db(3),r.rc("closeOthers",!1),r.Db(2),r.rc("title",r.mc(62,50,"INPUT_OPTIONS")),r.Db(3),r.rc("title",r.mc(65,52,"OUTPUT_OPTIONS")),r.Db(3),r.rc("ngIf",t.errorMessage),r.Db(3),r.rc("disabled",t.submitted),r.Db(2),r.Pc(r.mc(73,54,"SAVE_AND_CLOSE")),r.Db(3),r.rc("disabled",t.submitted),r.Db(3),r.Pc(r.mc(79,56,"SAVE")),r.Db(4),r.Pc(r.mc(83,58,"CLOSE")))},directives:[h.y,h.o,h.h,o.n,h.b,h.n,h.g,o.p,O.u,h.a,O.a,O.k,O.l,O.d,O.g,O.f,O.e,h.d,o.o,h.i],pipes:[l.c],encapsulation:2}),e})();const ut=[{path:"",component:d,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:ve},{path:"content_types",component:Ke},{path:"field_types",component:(()=>{class e extends m.a{constructor(e,t,i,o){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.title="Field types",this.queryOptions=new F.a("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}setModalInputs(e,t=!1,i=""){super.setModalInputs(e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?`${this.getLangString("FIELD_TYPE")} #${e}`:this.getLangString("ADD_FIELD_TYPE")}getModalElementId(e){return["modal","field_type",e||0].join("-")}getModalContent(){return bt}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(Ie),r.Qb(O.b),r.Qb(O.h),r.Qb(l.d))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-shk-field-types"]],features:[r.Ab],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"a",2),r.Rb(3,"i",3),r.Oc(4," \xa0 "),r.Wb(5,"span"),r.Oc(6),r.lc(7,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",4),r.Wb(9,"div",5),r.Wb(10,"button",6),r.Wb(11,"span"),r.Oc(12),r.lc(13,"translate"),r.Vb(),r.Vb(),r.Wb(14,"div",7),r.Wb(15,"button",8),r.ic("click",(function(){return t.blockSelected()})),r.Oc(16),r.lc(17,"translate"),r.Vb(),r.Wb(18,"button",8),r.ic("click",(function(){return t.deleteSelected()})),r.Oc(19),r.lc(20,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"button",9),r.ic("click",(function(){return t.modalOpen()})),r.Rb(22,"i",10),r.Oc(23," \xa0 "),r.Wb(24,"span"),r.Oc(25),r.lc(26,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Rb(27,"div",11),r.Vb(),r.Wb(28,"app-table",12,13),r.ic("selectedIdsChange",(function(e){return t.selectedIds=e}))("loadingChange",(function(e){return t.loading=e}))("actionRequest",(function(e){return t.actionRequest(e)})),r.Vb()),2&e&&(r.Db(2),r.rc("routerLink",r.vc(23,dt)),r.Db(4),r.Pc(r.mc(7,13,"CATALOG")),r.Db(6),r.Pc(r.mc(13,15,"BATCH_ACTIONS")),r.Db(4),r.Pc(r.mc(17,17,"DISABLE_ENABLE")),r.Db(3),r.Pc(r.mc(20,19,"DELETE")),r.Db(6),r.Pc(r.mc(26,21,"ADD")),r.Db(3),r.rc("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[s.e,O.d,O.g,O.f,ge.a],pipes:[l.c],encapsulation:2}),e})()}]}];let mt=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[s.f.forChild(ut)],s.f]}),e})();i.d(t,"CatalogModule",(function(){return ht}));let ht=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},providers:[I,Ie,Ve,W],imports:[[o.c,n.a,mt]]}),e})()},BWxc:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i("JIr8"),n=i("7AsP"),s=i("8Y7J"),r=i("IheW");let l=(()=>{class e extends n.a{constructor(e){super(e),this.setRequestUrl("/admin/content_types")}getItemByName(e){const t=this.getRequestUrl()+"/by_name/"+e;return this.http.get(t).pipe(Object(o.a)(this.handleError()))}}return e.\u0275fac=function(t){return new(t||e)(s.ec(r.a))},e.\u0275prov=s.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},bbPC:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("s7LF"),n=i("XNiG"),s=i("1G5W"),r=i("pvw1"),l=i("8Y7J"),c=i("7AsP"),a=i("qbpQ"),d=i("G0yt"),b=i("TSSN");let u=(()=>{class e{constructor(e,t,i,o,s,r,l){this.fb=e,this.dataService=t,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=s,this.translateService=r,this.elRef=l,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new n.a,s.placement="bottom",s.container="body",s.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}getModelData(){return this.loading=!0,new Promise((e,t)=>{this.dataService.getItem(this.itemId).pipe(Object(s.a)(this.destroyed$)).subscribe({next:t=>{this.isItemCopy&&(t.id=null,t[this.getSystemFieldName()]=""),this.model=t,this.loading=!1,e(t)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,t(e)}})})}buildForm(){const e=this.buildControls(this.formFields,"model");this.form=this.fb.group(e),this.form.valueChanges.pipe(Object(s.a)(this.destroyed$)).subscribe({next:e=>this.onValueChanged("form","",e)})}buildControls(e,t,i=""){const n={};for(const s in e){if(!e.hasOwnProperty(s))continue;const r=e[s],l=r.dataKey?this[t][r.dataKey]:this[t];l[s]||(l[s]=r.value),n[s]=new o.f({value:l[s]||"",disabled:r.disabled||!1},r.validators),this.formErrors[i+s]="",this.translateValidationMessages(i,s,r)}return n}translateValidationMessages(e,t,i){const n={};i.fieldLabel&&(Object.keys(i.messages).forEach(e=>{"required"!==e&&this.translateService.get(String(i.messages[e])).subscribe(t=>{n[e]=t})}),i.validators.indexOf(o.w.required)>-1&&this.translateService.get(i.fieldLabel).subscribe(e=>{this.translateService.get("FIELD_REQUIRED",{name:e}).subscribe(e=>{n.required=e})}),this.validationMessages[e+t]=n)}getControl(e){return this.form.controls.name}onValueChanged(e,t="",i){if(!this[e])return;const o=this[e].value;for(const n in o){if(!o.hasOwnProperty(n))continue;this.formErrors[t+n]="";const i=this[e].get(n);if(i&&(i.dirty||this[t+"submitted"])&&!i.valid)for(const e in i.errors)this.formErrors[t+n]+=this.validationMessages[t+n][e]?this.validationMessages[t+n][e]+" ":this.getLangString("ERROR")+" "}}displayToggle(e,t){e.style.display=(t=t||"none"===e.style.display)?"block":"none"}toggleAccordion(e,t,i){e.activeIds.indexOf(t)>-1&&i||e.toggle(t)}generateName(e){e.name=this.systemNameService.generateName(e.title||"")}closeModal(e){e&&e.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(e){e&&e.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),i.classList.remove("d-none")}getFormData(){const e={};return Object.keys(this.model).forEach(t=>{e[t]=this.files[t]?Array.isArray(this.model[t])?[r.a.getFileData(this.files[t])]:r.a.getFileData(this.files[t]):this.model[t]}),e}fileChange(e,t,i=!1){const o=e.target.files;o.length>0&&(this.model[t]=i?[r.a.getFileData(o[0])]:r.a.getFileData(o[0]),this.files[t]=o[0],this.form.controls[t].setValue(this.files[t].name))}fileClear(e,t){this.model[e]=null,this.form.controls[e].reset(null),t.files=null,t.value="",delete this.files[e]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(e=>{this.model[e]=this.localePreviousValues[e]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(e=>{this.localePreviousValues[e]=this.model[e]||"",this.model[e]=this.model.translations[e]&&this.model.translations[e][this.localeCurrent]||""})}saveTranslations(e){e&&e.preventDefault(),this.localeFieldsAllowed.forEach(e=>{this.model[e]?(this.model.translations[e]||(this.model.translations[e]={}),this.model.translations[e][this.localeCurrent]=this.model[e]):this.model.translations[e]&&(this.model.translations[e][this.localeCurrent]&&delete this.model.translations[e][this.localeCurrent],0===Object.keys(this.model.translations[e]).length&&delete this.model.translations[e])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(e){}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),this.appendFormData(t),this.dataService.postFormData(t).pipe(Object(s.a)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(e=!1,t){if(t&&t.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe(Object(s.a)(this.destroyed$)).subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t._id||t.id):(e?this.closeModal():t&&t.id&&(this.model=t,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(o.e),l.Qb(c.a),l.Qb(a.a),l.Qb(d.b),l.Qb(d.v),l.Qb(b.d),l.Qb(l.l))},e.\u0275dir=l.Lb({type:e,inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"}}),e})()},ot8b:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var o=i("s7LF"),n=i("XNiG"),s=i("1G5W"),r=i("7AsP"),l=i("8Y7J"),c=i("G0yt"),a=i("TSSN");const d=["formEl"];let b=(()=>{class e{constructor(e,t,i,o,s){this.fb=e,this.activeModal=t,this.translateService=i,this.dataService=o,this.elRef=s,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new n.a}set formErrors(e){for(const t in e)if(e.hasOwnProperty(t)){const e=this.getControl(this.form,null,t);e&&e.setErrors({incorrect:!0})}this._formFieldsErrors=e}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}getModelData(){return this.loading=!0,new Promise((e,t)=>{this.dataService.getItem(this.itemId).pipe(Object(s.a)(this.destroyed$)).subscribe({next:t=>{if(this.isItemCopy){t.id=null;const e=this.getSystemFieldName();e&&(t[e]="")}Object.assign(this.model,t),this.loading=!1,e(t)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,t(e)}})})}buildForm(){this.form=this.fb.group(this.buildControls(null,this.formFields)),this.form.valueChanges.pipe(Object(s.a)(this.destroyed$)).subscribe(()=>this.onValueChanged())}buildControls(e,t,i="model"){const o={};return void 0===e&&(e=this.form||null),t.forEach(t=>{const n=this.getControl(e,t);let s=null;if(i&&this[i]?(this[i].options||(this[i].options={}),s=0===t.name.indexOf("options_")?this[i].options[t.name.substr(8)]||null:this[i][t.name]||null):s=null,n)if(t.disabled&&n.disable(),t.children){const e=s,i=n;i.clear(),e.forEach((e,o)=>{const n=this.getFormFieldByName(t.name),s=this.buildControls(null,n.children,null);i.push(this.fb.group(s))}),i.patchValue(e)}else n.setValue(s);else t.children?(o[t.name]=this.fb.array([]),this.createArrayFieldsProperty(t.name)):o[t.name]=this.fb.control({value:s,disabled:t.disabled||!1},t.validators)}),o}onValueChanged(e="form"){this[e]&&(this[e].valid&&(this.errorMessage=""),Object.keys(this[e].value).forEach(e=>{this.formErrors[e]="";const t=this.getControl(this.form,null,e);if(t&&!t.valid&&t.errors){let i="";Object.keys(t.errors).forEach(e=>{i+=(i?" ":"")+this.getLangString("INVALID_"+e.toUpperCase())}),this.formErrors[e]=i}}))}getFormFieldByName(e){const t=this.formFields.filter(t=>t.name===e);return t.length>0?t[0]:null}createArrayFieldsProperty(e){Object.defineProperty(this.arrayFields,e,{get:()=>this.form?this.form.get(e):null})}getControl(e,t,i){return e?e.get(i||t.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(e){Object.keys(e.controls).forEach(t=>{e.controls[t].markAsTouched(),e.controls[t]instanceof o.c&&Array.from(this.form.controls[t].controls).forEach(e=>{this.formGroupMarkTouched(e)})})}getSaveRequest(e){return e.id||"root"===e.name?this.dataService.update(e):this.dataService.create(e)}getFormData(){const e=this.form.value;return e.id=this.model.id||0,void 0!==this.model.translations&&(e.translations=this.model.translations||null),e}arrayFieldDelete(e,t,i){i&&i.preventDefault(),this.arrayFields[e].removeAt(t)}arrayFieldAdd(e,t){t&&t.preventDefault();const i=this.getFormFieldByName(e);if(!i)return;const o=this.buildControls(null,i.children,null);this.arrayFields[e].push(this.fb.group(o))}closeModal(e){e&&e.preventDefault(),this.close(this.closeReason)}close(e,t){t&&t.preventDefault(),"submit"===e?this.activeModal.close(e):this.activeModal.dismiss(e)}minimize(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),i.classList.remove("d-none")}save(e=!1,t){t&&t.preventDefault(),this.onSubmit(e)}saveFiles(e){if(0===Object.keys(this.files).length)return void this.close("submit");const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),this.dataService.postFormData(t).pipe(Object(s.a)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(e=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const t=this.getFormData();this.getSaveRequest(t).pipe(Object(s.a)(this.destroyed$)).subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t._id||t.id):e&&this.close("submit"),t&&t.id&&(this.model.id=t.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:e=>{e.error&&(this.errorMessage=e.error),e.errors&&(this.formErrors=e.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(e=>{this.model[e]=this.localePreviousValues[e],this.getControl(this.form,null,e).setValue(this.localePreviousValues[e])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(e=>{this.localePreviousValues[e]=this.getControl(this.form,null,e).value,this.model.translations[e]?(this.model[e]=this.model.translations[e][this.localeCurrent]||"",this.getControl(this.form,null,e).setValue(this.model[e])):(this.model[e]="",this.getControl(this.form,null,e).setValue(""))})}saveTranslations(e){e&&e.preventDefault(),this.localeFieldsAllowed.forEach(e=>{this.getControl(this.form,null,e)&&this.getControl(this.form,null,e).value?(this.model.translations[e]||(this.model.translations[e]={}),this.model.translations[e][this.localeCurrent]=this.getControl(this.form,null,e).value):this.model.translations[e]&&(this.model.translations[e][this.localeCurrent]&&delete this.model.translations[e][this.localeCurrent],0===Object.keys(this.model.translations[e]).length&&delete this.model.translations[e])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(o.e),l.Qb(c.b),l.Qb(a.d),l.Qb(r.a),l.Qb(l.l))},e.\u0275dir=l.Lb({type:e,viewQuery:function(e,t){var i;1&e&&l.Sc(d,!0),2&e&&l.Cc(i=l.jc())&&(t.formEl=i.first)},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"}}),e})()}}]);