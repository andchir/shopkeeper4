(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"4p3S":function(t,e,i){"use strict";i.d(e,"a",function(){return u});var o=i("XNiG"),n=i("1G5W"),s=i("RwQR"),r=i("7AsP"),c=i("Y2tp"),l=i("8Y7J"),a=i("G0yt"),d=i("TSSN");const b=["table"];let u=(()=>{class t{constructor(t,e,i,n){this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=n,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new s.a("name","asc",1,10,0,0),this.destroyed$=new o.a}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(t){}onSearchWordUpdate(t){if(void 0!==t)return this.queryOptions.search_word=t,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(t){return["modal",t||0].join("-")}setModalInputs(t,e=!1,i=""){const o=void 0!==t&&!e;this.modalRef.componentInstance.modalTitle=this.getLangString(o?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.isEditMode=o}modalOpen(t,e=!1){const i=this.getModalElementId(t);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const t=window.document.getElementById(i),e=t.previousElementSibling;return t.classList.add("d-block"),t.classList.remove("modal-minimized"),void e.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(t,e,i),this.modalRef.result.then(t=>{this.destroyed$.isStopped||(this.onModalClose(t),this.getList())},t=>{this.destroyed$.isStopped||(this.onModalClose(t),t&&["submit","updated"].indexOf(t)>-1&&this.getList())})}deleteItemConfirm(t){this.modalRef=this.modalService.open(c.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(e=>{"accept"===e&&this.deleteItem(t)})}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][t]||t}confirmAction(t){return this.modalRef=this.modalService.open(c.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=t,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(t=>{"accept"===t&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(t){this.modalRef=this.modalService.open(c.a),this.modalRef.componentInstance.modalContent=t,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(t){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(e=>{"accept"===e&&this.dataService.deleteItem(t).subscribe(t=>{this.getList()},t=>{t.error&&this.showAlert(t.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(t){switch(t[0]){case"edit":this.modalOpen(t[1]);break;case"copy":this.modalOpen(t[1],!0);break;case"delete":this.deleteItem(t[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe(Object(n.a)(this.destroyed$)).subscribe({next:t=>{this.items=t.items,this.collectionSize=t.total,this.loading=!1},error:t=>{this.items=[],this.collectionSize=0,t.error&&this.showAlert(t.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.title="",t.\u0275fac=function(e){return new(e||t)(l.Nb(r.a),l.Nb(a.b),l.Nb(a.h),l.Nb(d.d))},t.\u0275dir=l.Ib({type:t,viewQuery:function(t,e){if(1&t&&l.Kc(b,3),2&t){let t;l.wc(t=l.ec())&&(e.table=t.first)}}}),t})()},"6J3s":function(t,e,i){"use strict";i.r(e),i.d(e,"CatalogModule",function(){return ne});var o=i("SVse"),n=i("d2mR"),s=i("iInd"),r=i("8Y7J"),c=i("TSSN");const l=function(){return["field_types"]},a=function(){return["content_types"]};let d=(()=>{class t{constructor(){}ngOnInit(){}}return t.title="CATALOG",t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Hb({type:t,selectors:[["app-catalog"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ml-md-2",3,"routerLink"],[1,"icon-toggle"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-box"],[1,"card"],[1,"card-body"],[1,"float-md-left","mt-4","mt-md-0"],[1,"m-0"],[1,"icon-layers"],[1,"clearfix"],[1,"min-height400"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"a",2),r.Ob(3,"i",3),r.Gc(4," \xa0 "),r.Tb(5,"span"),r.Gc(6),r.gc(7,"translate"),r.Sb(),r.Sb(),r.Tb(8,"a",4),r.Ob(9,"i",5),r.Gc(10," \xa0 "),r.Tb(11,"span"),r.Gc(12),r.gc(13,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(14,"div",6),r.Tb(15,"div",7),r.Tb(16,"div",8),r.Tb(17,"h3",9),r.Ob(18,"i",10),r.Gc(19," \xa0 "),r.Tb(20,"span"),r.Gc(21),r.gc(22,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Ob(23,"div",11),r.Ob(24,"hr"),r.Tb(25,"div",12),r.Ob(26,"router-outlet"),r.Sb(),r.Sb(),r.Sb()),2&t&&(r.Bb(2),r.mc("routerLink",r.qc(11,l)),r.Bb(4),r.Hc(r.hc(7,5,"FIELD_TYPES")),r.Bb(2),r.mc("routerLink",r.qc(12,a)),r.Bb(4),r.Hc(r.hc(13,7,"CONTENT_TYPES")),r.Bb(9),r.Hc(r.hc(22,9,"CATALOG")))},directives:[s.e,s.d,s.g],pipes:[c.c],encapsulation:2}),t})();var b=i("LvDl");class u{constructor(t,e,i,o,n,s,r,c,l,a,d,b){this.id=t,this.isFolder=e,this.parentId=i,this.name=o,this.title=n,this.description=s,this.contentTypeName=r,this.isActive=c,this.clearCache=l,this.menuIndex=a,this.translations=d,this.image=b,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}static createTree(t,e=null,i=!0){if(0===t.length)return null;if(!e){const o=Object(b.findIndex)(t,{name:"root"});e=o>-1?u.toTreeNode(t[o],i):{id:0,parentId:0,label:"",expanded:!0,children:[]}}e.children=[];const o=t.filter(t=>0!==t.id&&t.parentId===e.id);return o.length>0&&(o.forEach(t=>{e.children.push(u.toTreeNode(t,i))}),e.children.forEach(e=>{u.createTree(t,e,i)})),0===e.children.length&&(e.children=null),e}static getCurrentNode(t,e){if(!e)return null;if(e.id===t)return e;if(e.children){let i=null;for(let o=0;null==i&&o<e.children.length;o++)i=u.getCurrentNode(t,e.children[o]);return i}return null}static toTreeNode(t,e=!0){return{id:t.id,label:t.title,parentId:t.parentId||0,expanded:e}}}var m=i("4p3S"),h=i("s7LF");class p{constructor(t,e,i,o,n,s,r,c,l){this.id=t,this.name=e,this.title=i,this.description=o,this.collection=n,this.fields=s,this.groups=r,this.isActive=c,this.isCreateByUsersAllowed=l,this.isCreateByUsersAllowed||(this.isCreateByUsersAllowed=!1)}static getSystemFieldName(t){const e=Object(b.findIndex)(t.fields,{inputType:"system_name"});return e>-1?t.fields[e].name:"name"}static getFieldByName(t,e){const i=Object(b.findIndex)(t.fields,{name:e});return i>-1?t.fields[i]:null}}var g=i("bbPC"),f=i("qbpQ"),T=i("e07I"),S=i("BWxc"),v=i("7AsP"),y=i("IheW");let I=(()=>{class t extends v.a{constructor(t){super(t),this.setRequestUrl("/admin/products")}}return t.\u0275fac=function(e){return new(e||t)(r.ac(y.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac}),t})(),C=(()=>{class t extends v.a{constructor(t){super(t),this.setRequestUrl("/admin/files")}}return t.\u0275fac=function(e){return new(e||t)(r.ac(y.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac}),t})();var E=i("3UOJ"),B=i("wgQU"),O=i("G0yt"),F=i("Cp0g"),w=i("keWK");function N(t,e){if(1&t&&(r.Tb(0,"div",44),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.parentId," ")}}function k(t,e){if(1&t&&(r.Rb(0),r.Ob(1,"app-input-field-renderer",45),r.Qb()),2&t){const t=r.fc();r.Bb(1),r.mc("fields",t.currentContentType.fields)("groups",t.currentContentType.groups)("formErrors",t.formErrors)("validationMessages",t.validationMessages)("model",t.model)("form",t.form)("files",t.files)("localeFieldsAllowed",t.localeFieldsAllowed)("isLocalizationActive",t.localeCurrent!==t.localeDefault)}}function M(t,e){if(1&t&&(r.Tb(0,"label",51),r.Ob(1,"input",52),r.Gc(2),r.Sb()),2&t){const t=e.$implicit;r.Bb(1),r.mc("value",t),r.Bb(1),r.Ic(" ",t," ")}}const L=function(){return{standalone:!0}};function A(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",46),r.Tb(1,"button",47),r.dc("click",function(e){return r.yc(t),r.fc().saveTranslations(e)}),r.gc(2,"translate"),r.Ob(3,"i",48),r.Sb(),r.Tb(4,"div",49),r.dc("ngModelChange",function(e){return r.yc(t),r.fc().localeCurrent=e})("ngModelChange",function(){return r.yc(t),r.fc().onLocaleSwitch()}),r.Ec(5,M,3,2,"label",50),r.Sb(),r.Sb()}if(2&t){const t=r.fc();r.Bb(1),r.nc("ngbTooltip",r.hc(2,5,"SAVE")),r.mc("hidden",t.localeCurrent==t.localeDefault),r.Bb(3),r.mc("ngModel",t.localeCurrent)("ngModelOptions",r.qc(7,L)),r.Bb(1),r.mc("ngForOf",t.localeList)}}let G=(()=>{class t extends g.a{constructor(t,e,i,o,n,s,r,c,l,a,d){super(t,e,i,o,n,s,r),this.fb=t,this.dataService=e,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.contentTypesService=c,this.categoriesService=l,this.filesService=a,this.appSettings=d,this.categories=[],this.contentTypes=[],this.currentContentType=new p(0,"","","","",[],[],!0),this.model={},this.dataLoaded=!1,this.formFields={parentId:{value:0,validators:[h.v.required],messages:{required:"Category is required."}},isActive:{value:!0,validators:[],messages:{}},clearCache:{value:!0,validators:[],messages:{}}}}ngOnInit(){this.model={id:0,parentId:this.categoryId},this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),this.model.clearCache=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.buildForm(),this.getCategories(),this.getContentType().then(t=>this.itemId?this.getModelData():Promise.reject(""),t=>(this.dataLoaded=!0,this.errorMessage=t.error||"Error.",Promise.reject(""))).then(t=>{this.dataLoaded=!0,this.onAfterGetData(),this.updateForm()},()=>{this.dataLoaded=!0,this.onAfterGetData()})}onAfterGetData(){this.currentContentType.fields.forEach(t=>{["text","textarea","rich_text"].indexOf(t.inputType)>-1&&this.localeFieldsAllowed.push(t.name)}),this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={})}getSystemFieldName(){return p.getSystemFieldName(this.currentContentType)}getCategories(){this.categoriesService.getListPage().subscribe(t=>{this.categories=t.items},t=>{this.errorMessage=t.error||"Error."})}getContentType(){return this.loading=!0,new Promise((t,e)=>{this.contentTypesService.getItemByCategory(this.categoryId).subscribe(e=>{this.currentContentType=e,this.errorMessage="",this.loading=!1,t(e)},t=>{this.errorMessage=t.error||"Error.",this.loading=!1,e(t)})})}updateForm(t){t||(t=Object(b.clone)(this.model));const e=Object(b.map)(this.currentContentType.fields,function(t){return t.name});e.push("id","parentId","previousParentId","isActive","clearCache","translations"),t.clearCache=!0,Object.keys(this.model).forEach(t=>{if(t.indexOf("__")>-1){const i=E.a.getFieldBaseName(t);if(i===t)return;const o=E.a.getFieldIndexData(this.currentContentType.fields,i);if(-1===o.index)return;const n=Object(b.cloneDeep)(this.currentContentType.fields[o.index]);n.name=t,this.currentContentType.fields.splice(o.index+o.additFieldsCount+1,0,n),e.push(t)}});for(const i in this.form.controls)this.form.controls.hasOwnProperty(i)&&-1===e.indexOf(i)&&this.form.removeControl(i);this.model=Object(b.pick)(t,e)}onChangeContentType(){const t=parseInt(String(this.model.parentId),10),e=Object(b.findIndex)(this.categories,{id:t});-1!==e&&(this.currentContentType&&this.currentContentType.name===this.categories[e].contentTypeName||(this.model.previousParentId=this.categoryId,this.categoryId=this.categories[e].id,this.getContentType()))}saveFiles(t){if(0===Object.keys(this.files).length)return void this.closeModal();const e=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&e.append(i,this.files[i],this.files[i].name);e.append("itemId",String(t)),e.append("ownerType",this.currentContentType.name),e.append("categoryId",String(this.model.parentId)),e.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(e).subscribe(()=>{this.closeModal()},t=>{this.errorMessage=t.error||"Error.",this.submitted=!1,this.loading=!1})}getErrorsString(){const t=[];return Object.keys(this.form.controls).forEach(e=>{if(this.form.controls[e].invalid&&this.validationMessages[e]){const i=E.a.getFieldBaseName(e),o=p.getFieldByName(this.currentContentType,i);if(!o)return;let n="";n=this.formErrors[e]?this.formErrors[e]:`${o.title} - error.`,t.push(n)}}),t.join(" ")}getFormData(){const t=Object(b.cloneDeep)(this.model);for(const e in t)t.hasOwnProperty(e)&&t[e]&&"object"==typeof t[e]&&t[e].dataUrl&&delete t[e].dataUrl;return t.fieldsSort=this.getFieldsSortData(),t}getFieldsSortData(){let t=this.currentContentType.fields.map(t=>t.name);return t=t.filter(t=>{if(!this.model[t]||-1===t.indexOf("__"))return!1;const e=t.split("__");return!isNaN(e[1])}),t}save(t=!1){if(this.submitted=!0,this.errorMessage=null,!this.form.valid)return this.onValueChanged("form"),this.errorMessage=this.getErrorsString(),void(this.submitted=!1);this.loading=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.saveRequest().subscribe({next:e=>{Object.keys(this.files).length>0?this.saveFiles(e.id||e._id):(t?this.closeModal():e&&(e.id||e._id)&&(this.model=e,this.model.id=e.id||e._id,this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:t=>{this.errorMessage=t.error||"Error.",this.submitted=!1,this.loading=!1}})}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(h.e),r.Nb(I),r.Nb(f.a),r.Nb(O.b),r.Nb(O.w),r.Nb(c.d),r.Nb(r.l),r.Nb(S.a),r.Nb(T.a),r.Nb(C),r.Nb(B.a))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-product-modal-content"]],inputs:{categoryId:"categoryId"},features:[r.Ab([I]),r.yb],decls:71,vars:50,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],[3,"formGroup"],[1,"modal-body","py-0"],[1,"row","form-group","form-group-message"],[1,"col-md-5"],["for","fieldCategory"],[1,"col-md-7"],["id","fieldCategory","formControlName","parentId",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-indicator"],[1,"custom-control-label",3,"for"],[1,"custom-control","custom-checkbox","mt-2"],["type","checkbox","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"min-height300"],[4,"ngIf"],[1,"alert","alert-danger","mt-3","mb-0",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"fields","groups","formErrors","validationMessages","model","form","files","localeFieldsAllowed","isLocalizationActive"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"button",2),r.dc("click",function(t){return e.closeModal(t)}),r.Ob(3,"i",3),r.Tb(4,"span"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Sb(),r.Tb(7,"button",2),r.dc("click",function(t){return e.minimize(t)}),r.Ob(8,"i",4),r.Tb(9,"span"),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(12,"div",5),r.Tb(13,"div",6),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(t){return e.maximize(t)}),r.gc(16,"translate"),r.Ob(17,"i",9),r.Sb(),r.Tb(18,"button",10),r.dc("click",function(t){return e.closeModal(t)}),r.gc(19,"translate"),r.Ob(20,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"h4",12),r.Gc(22),r.Sb(),r.Sb(),r.Tb(23,"form",13),r.Tb(24,"div",14),r.Tb(25,"div",15),r.Tb(26,"div",16),r.Tb(27,"label",17),r.Gc(28),r.gc(29,"translate"),r.Sb(),r.Sb(),r.Tb(30,"div",18),r.Tb(31,"app-select-parent-dropdown",19),r.dc("ngModelChange",function(t){return e.model.parentId=t})("ngModelChange",function(){return e.onChangeContentType()}),r.Sb(),r.Ec(32,N,2,1,"div",20),r.Sb(),r.Sb(),r.Tb(33,"div",21),r.Tb(34,"div",22),r.Tb(35,"div",23),r.Tb(36,"div",24),r.Tb(37,"input",25),r.dc("ngModelChange",function(t){return e.model.isActive=t}),r.Sb(),r.Ob(38,"span",26),r.Tb(39,"label",27),r.Gc(40),r.gc(41,"translate"),r.Sb(),r.Sb(),r.Tb(42,"div",28),r.Tb(43,"input",29),r.dc("ngModelChange",function(t){return e.model.clearCache=t}),r.Sb(),r.Tb(44,"label",27),r.Gc(45),r.gc(46,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(47,"div",30),r.Ec(48,k,2,9,"ng-container",31),r.Sb(),r.Tb(49,"div",32),r.Tb(50,"button",33),r.dc("click",function(){return e.errorMessage=""}),r.Tb(51,"span",34),r.Gc(52,"\xd7"),r.Sb(),r.Sb(),r.Gc(53),r.Sb(),r.Sb(),r.Tb(54,"div",35),r.Ec(55,A,6,8,"div",36),r.Tb(56,"div",37),r.Tb(57,"button",38),r.dc("click",function(){return e.save(!0)}),r.Tb(58,"span"),r.Gc(59),r.gc(60,"translate"),r.Sb(),r.Sb(),r.Tb(61,"div",39),r.Ob(62,"button",40),r.Tb(63,"div",41),r.Tb(64,"button",42),r.dc("click",function(){return e.save()}),r.Gc(65),r.gc(66,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(67,"button",43),r.dc("click",function(t){return e.closeModal(t)}),r.Tb(68,"span"),r.Gc(69),r.gc(70,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb()),2&t&&(r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(6,30,"CLOSE")),r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(11,32,"MINIMIZE")),r.Bb(5),r.mc("title",r.hc(16,34,"EXPAND")),r.Bb(3),r.mc("title",r.hc(19,36,"CLOSE")),r.Bb(4),r.Hc(e.modalTitle),r.Bb(1),r.Fb("loading",e.loading),r.mc("formGroup",e.form),r.Bb(5),r.Hc(r.hc(29,38,"PARENT_FOLDER")),r.Bb(3),r.mc("ngModel",e.model.parentId),r.Bb(1),r.mc("ngIf",e.formErrors.parentId),r.Bb(5),r.oc("id","fieldIsActive",e.uniqueId,""),r.mc("ngModel",e.model.isActive),r.Bb(2),r.oc("for","fieldIsActive",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(41,40,"ACTIVE")),r.Bb(3),r.oc("id","fieldClearCache",e.uniqueId,""),r.mc("ngModel",e.model.clearCache),r.Bb(1),r.oc("for","fieldClearCache",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(46,42,"CLEAR_FILE_CACHE")),r.Bb(3),r.mc("ngIf",e.dataLoaded),r.Bb(1),r.mc("hidden",!e.errorMessage),r.Bb(4),r.Ic(" ",e.errorMessage," "),r.Bb(2),r.mc("ngIf",e.localeList.length>1),r.Bb(2),r.mc("disabled",e.submitted||e.isSaveButtonDisabled),r.Bb(2),r.Hc(r.hc(60,44,"SAVE_AND_CLOSE")),r.Bb(3),r.mc("disabled",e.submitted||e.isSaveButtonDisabled),r.Bb(3),r.Hc(r.hc(66,46,"SAVE")),r.Bb(4),r.Hc(r.hc(70,48,"CLOSE")))},directives:[h.w,h.o,h.h,F.a,h.n,h.g,o.p,h.a,O.d,O.g,O.f,O.e,w.a,O.v,O.u,h.p,o.o,O.c,O.t],pipes:[c.c],encapsulation:2}),t})();var D=i("RwQR"),R=i("XNiG"),_=i("1G5W"),x=i("ot8b"),P=i("Y2tp"),q=i("c863"),H=i("HEhh");function U(t,e){if(1&t&&(r.Tb(0,"div",57),r.Gc(1),r.Sb()),2&t){const t=r.fc(2);r.Bb(1),r.Ic(" ",t.formErrors.parentId," ")}}function j(t,e){if(1&t&&(r.Tb(0,"div",23),r.Tb(1,"div",18),r.Tb(2,"label",35),r.Gc(3),r.gc(4,"translate"),r.Sb(),r.Sb(),r.Tb(5,"div",20),r.Ob(6,"app-select-parent-dropdown",56),r.Ec(7,U,2,1,"div",22),r.Sb(),r.Sb()),2&t){const t=r.fc();r.Bb(3),r.Hc(r.hc(4,5,"PARENT_FOLDER")),r.Bb(3),r.Fb("is-invalid",t.formErrors.parentId),r.mc("filterId",t.model.id),r.Bb(1),r.mc("ngIf",t.formErrors.parentId)}}function $(t,e){if(1&t&&(r.Tb(0,"div",57),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.title," ")}}function V(t,e){if(1&t&&(r.Tb(0,"div",57),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.name," ")}}function z(t,e){if(1&t&&(r.Tb(0,"option",58),r.Gc(1),r.Sb()),2&t){const t=e.$implicit;r.mc("value",t.name),r.Bb(1),r.Hc(t.title)}}function Y(t,e){if(1&t&&(r.Tb(0,"div",57),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.contentTypeName," ")}}function W(t,e){if(1&t&&(r.Tb(0,"div",57),r.Gc(1),r.Sb()),2&t){const t=r.fc(2);r.Bb(1),r.Ic(" ",t.formErrors.menuIndex," ")}}function X(t,e){if(1&t&&(r.Tb(0,"div",23),r.Tb(1,"div",18),r.Tb(2,"label",59),r.Gc(3),r.gc(4,"translate"),r.Sb(),r.Sb(),r.Tb(5,"div",20),r.Ob(6,"input",60),r.Ec(7,W,2,1,"div",22),r.Sb(),r.Sb()),2&t){const t=r.fc();r.Bb(3),r.Ic(" ",r.hc(4,4,"MENU_INDEX")," "),r.Bb(3),r.Fb("is-invalid",t.formErrors.menuIndex),r.Bb(1),r.mc("ngIf",t.formErrors.menuIndex)}}function J(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",61),r.Tb(1,"button",62),r.dc("click",function(){return r.yc(t),r.fc().errorMessage=""}),r.Tb(2,"span",63),r.Gc(3,"\xd7"),r.Sb(),r.Sb(),r.Gc(4),r.Sb()}if(2&t){const t=r.fc();r.Bb(4),r.Ic(" ",t.errorMessage," ")}}function Q(t,e){if(1&t&&(r.Tb(0,"label",69),r.Ob(1,"input",70),r.Gc(2),r.Sb()),2&t){const t=e.$implicit;r.Bb(1),r.mc("value",t),r.Bb(1),r.Ic(" ",t," ")}}const K=function(){return{standalone:!0}};function Z(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",64),r.Tb(1,"button",65),r.dc("click",function(e){return r.yc(t),r.fc().saveTranslations(e)}),r.gc(2,"translate"),r.Ob(3,"i",66),r.Sb(),r.Tb(4,"div",67),r.dc("ngModelChange",function(e){return r.yc(t),r.fc().localeCurrent=e})("ngModelChange",function(){return r.yc(t),r.fc().onLocaleSwitch()}),r.Ec(5,Q,3,2,"label",68),r.Sb(),r.Sb()}if(2&t){const t=r.fc();r.Bb(1),r.nc("ngbTooltip",r.hc(2,5,"SAVE")),r.mc("hidden",t.localeCurrent==t.localeDefault),r.Bb(3),r.mc("ngModel",t.localeCurrent)("ngModelOptions",r.qc(7,K)),r.Bb(1),r.mc("ngForOf",t.localeList)}}const tt=function(t){return{"no-events":t}},et=function(t,e){return{"is-invalid":t,"border-success":e}},it=function(t){return{"is-invalid":t}},ot=function(t){return{"border-success":t}},nt=["categoriesDropdown"];function st(t,e){if(1&t){const t=r.Ub();r.Rb(0),r.Tb(1,"button",9),r.dc("click",function(e){return r.yc(t),r.fc().expandAll(e)}),r.gc(2,"translate"),r.Ob(3,"i",17),r.Sb(),r.Tb(4,"button",18),r.dc("click",function(e){return r.yc(t),r.fc().collapseAll(e)}),r.gc(5,"translate"),r.Ob(6,"i",19),r.Sb(),r.Qb()}2&t&&(r.Bb(1),r.nc("ngbTooltip",r.hc(2,2,"EXPAND_ALL")),r.Bb(3),r.nc("ngbTooltip",r.hc(5,4,"COLLAPSE_ALL")))}function rt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"button",9),r.dc("click",function(){return r.yc(t),r.fc().goToRootCategory()}),r.gc(1,"translate"),r.Ob(2,"i",20),r.Sb()}2&t&&r.nc("ngbTooltip",r.hc(1,1,"OPEN_ROOT_CATEGORY"))}let ct=(()=>{class t extends x.a{constructor(t,e,i,o,n,s,r,c,l){super(t,e,i,o,n,s),this.fb=t,this.activeModal=e,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.filesService=r,this.contentTypesService=c,this.appSettings=l,this.isRoot=!1,this.model=new u(null,!1,0,"","","","",!0),this.contentTypes=[],this.loadingCategories=!1,this.categories=[],this.isCollapsed=!1,this.localeFieldsAllowed=["title","description"],this.files={},this.formFields=[{name:"title",validators:[h.v.required]},{name:"name",validators:[h.v.required]},{name:"description",validators:[]},{name:"parentId",validators:[]},{name:"image",validators:[]},{name:"contentTypeName",validators:[]},{name:"menuIndex",validators:[]},{name:"isActive",validators:[]},{name:"clearCache",validators:[]}]}ngOnInit(){this.uniqueId=this.createUniqueId(),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),void 0!==this.itemId&&(this.model.id=this.itemId),this.model.parentId=this.isEditMode?this.currentCategory.parentId:this.currentCategory.id,this.model.contentTypeName=this.currentCategory.contentTypeName,this.isRoot&&(this.model.id=0,this.model.title=this.getLangString("ROOT_FOLDER"),this.model.name="root"),this.getContentTypes(),super.ngOnInit()}ngAfterViewInit(){this.elRef.nativeElement.querySelector("#fieldTitle")&&this.elRef.nativeElement.querySelector("#fieldTitle").focus()}onAfterGetData(){this.model.clearCache=!0,this.model.translations&&!Array.isArray(this.model.translations)||(this.model.translations={}),super.onAfterGetData()}getContentTypes(){this.contentTypesService.getListPage().subscribe(t=>{this.contentTypes=t.items},t=>this.errorMessage=t)}onCategorySelect(t){this.form.controls.parentId.setValue(t.node.id),this.model.parentId=t.node.id}saveFiles(t){if(0===Object.keys(this.files).length)return void this.closeModal();const e=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&e.append(i,this.files[i],this.files[i].name);e.append("itemId",String(t)),e.append("ownerType","category"),this.filesService.postFormData(e).subscribe(()=>{this.closeModal()},t=>{this.errorMessage=t.error||"Error.",this.submitted=!1,this.loading=!1})}generateName(t,e){e&&e.preventDefault();const i=this.getControl(this.form,null,"title").value||"";t.name=this.systemNameService.generateName(i),this.getControl(this.form,null,"name").setValue(t.name)}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(h.e),r.Nb(O.b),r.Nb(c.d),r.Nb(f.a),r.Nb(T.a),r.Nb(r.l),r.Nb(C),r.Nb(S.a),r.Nb(B.a))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-category-modal-content"]],inputs:{currentCategory:"currentCategory",isRoot:"isRoot"},features:[r.yb],decls:103,vars:84,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],["class","row form-group form-group-message",4,"ngIf"],[1,"row","form-group","show-on-hover-parent","form-group-message"],[1,"col-md-5"],["for","fieldTitle"],[1,"col-md-7"],["type","text","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"row","form-group","form-group-message"],["for","fieldName"],[1,"input-group",3,"ngClass"],["type","text","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","disabled","click"],[1,"icon-reload"],[1,"row","form-group","show-on-hover-parent"],["for","fieldDescription"],["type","text","id","fieldDescription","rows","4","name","description","formControlName","description",1,"form-control",3,"ngClass"],[1,"row","form-group"],["formControlName","image",3,"hasPreviewImage","allowedExtensions","files","filesChange"],["for","fieldContentType"],["id","fieldContentType","name","contentTypeName","formControlName","contentTypeName",1,"custom-select"],["value","1",3,"value",4,"ngFor","ngForOf"],[1,"col-md-7","ml-md-auto"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","mb-2"],["type","checkbox","id","fieldIsActive","value","1","name","isActive","formControlName","isActive",1,"custom-control-input"],["for","fieldIsActive",1,"custom-control-label"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","id","fieldClearCache","value","1","name","clearCache","formControlName","clearCache",1,"custom-control-input"],["for","fieldClearCache",1,"custom-control-label"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],["class","float-right",4,"ngIf"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"disabled","click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["formControlName","parentId",3,"filterId"],[1,"alert","alert-danger"],["value","1",3,"value"],["for","fieldMenuIndex"],["type","number","id","fieldMenuIndex","name","menuIndex","formControlName","menuIndex",1,"form-control"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"float-right"],["type","button","placement","left",1,"btn","btn-success","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",3,"value"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"button",2),r.dc("click",function(t){return e.closeModal(t)}),r.Ob(3,"i",3),r.Tb(4,"span"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Sb(),r.Tb(7,"button",2),r.dc("click",function(t){return e.minimize(t)}),r.Ob(8,"i",4),r.Tb(9,"span"),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(12,"div",5),r.Tb(13,"div",6),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(t){return e.maximize(t)}),r.gc(16,"translate"),r.Ob(17,"i",9),r.Sb(),r.Tb(18,"button",10),r.dc("click",function(t){return e.closeModal(t)}),r.gc(19,"translate"),r.Ob(20,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"h4",12),r.Gc(22),r.Sb(),r.Sb(),r.Tb(23,"form",13,14),r.dc("ngSubmit",function(){return e.onSubmit()}),r.Tb(25,"div",15),r.Ec(26,j,8,7,"div",16),r.Tb(27,"div",17),r.Tb(28,"div",18),r.Tb(29,"label",19),r.Gc(30),r.gc(31,"translate"),r.Sb(),r.Sb(),r.Tb(32,"div",20),r.Ob(33,"input",21),r.Ec(34,$,2,1,"div",22),r.Sb(),r.Sb(),r.Tb(35,"div",23),r.Tb(36,"div",18),r.Tb(37,"label",24),r.Gc(38),r.gc(39,"translate"),r.Sb(),r.Sb(),r.Tb(40,"div",20),r.Tb(41,"div",25),r.Ob(42,"input",26),r.Tb(43,"div",27),r.Tb(44,"button",28),r.dc("click",function(){return e.generateName(e.model)}),r.gc(45,"translate"),r.Ob(46,"i",29),r.Sb(),r.Sb(),r.Sb(),r.Ec(47,V,2,1,"div",22),r.Sb(),r.Sb(),r.Tb(48,"div",30),r.Tb(49,"div",18),r.Tb(50,"label",31),r.Gc(51),r.gc(52,"translate"),r.Sb(),r.Sb(),r.Tb(53,"div",20),r.Ob(54,"textarea",32),r.Sb(),r.Sb(),r.Tb(55,"div",33),r.Tb(56,"div",18),r.Tb(57,"label"),r.Gc(58),r.gc(59,"translate"),r.Sb(),r.Sb(),r.Tb(60,"div",20),r.Tb(61,"app-file-widget",34),r.dc("filesChange",function(t){return e.files=t}),r.Sb(),r.Sb(),r.Sb(),r.Tb(62,"div",23),r.Tb(63,"div",18),r.Tb(64,"label",35),r.Gc(65),r.gc(66,"translate"),r.Sb(),r.Sb(),r.Tb(67,"div",20),r.Tb(68,"select",36),r.Ec(69,z,2,2,"option",37),r.Sb(),r.Ec(70,Y,2,1,"div",22),r.Sb(),r.Sb(),r.Ec(71,X,8,6,"div",16),r.Tb(72,"div",33),r.Tb(73,"div",38),r.Tb(74,"div",39),r.Tb(75,"div",40),r.Ob(76,"input",41),r.Tb(77,"label",42),r.Gc(78),r.gc(79,"translate"),r.Sb(),r.Sb(),r.Tb(80,"div",43),r.Ob(81,"input",44),r.Tb(82,"label",45),r.Gc(83),r.gc(84,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Ec(85,J,5,1,"div",46),r.Sb(),r.Tb(86,"div",47),r.Ec(87,Z,6,8,"div",48),r.Tb(88,"div",49),r.Tb(89,"button",50),r.dc("click",function(t){return e.save(!0,t)}),r.Tb(90,"span"),r.Gc(91),r.gc(92,"translate"),r.Sb(),r.Sb(),r.Tb(93,"div",51),r.Ob(94,"button",52),r.Tb(95,"div",53),r.Tb(96,"button",54),r.dc("click",function(t){return e.save(!1,t)}),r.Gc(97),r.gc(98,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(99,"button",55),r.dc("click",function(t){return e.closeModal(t)}),r.Tb(100,"span"),r.Gc(101),r.gc(102,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb()),2&t&&(r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(6,43,"CLOSE")),r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(11,45,"MINIMIZE")),r.Bb(5),r.mc("title",r.hc(16,47,"EXPAND")),r.Bb(3),r.mc("title",r.hc(19,49,"CLOSE")),r.Bb(4),r.Hc(e.modalTitle),r.Bb(1),r.mc("formGroup",e.form)("ngClass",r.rc(73,tt,e.submitted)),r.Bb(2),r.Fb("loading",e.loading),r.Bb(1),r.mc("ngIf",!e.isRoot),r.Bb(4),r.Ic(" ",r.hc(31,51,"TITLE")," "),r.Bb(3),r.mc("ngClass",r.sc(75,et,e.form.controls.title.touched&&!e.form.controls.title.valid,e.localeCurrent!=e.localeDefault)),r.Bb(1),r.mc("ngIf",e.formErrors.title),r.Bb(4),r.Ic(" ",r.hc(39,53,"SYSTEM_NAME")," "),r.Bb(3),r.mc("ngClass",r.rc(78,it,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(1),r.mc("ngClass",r.rc(80,it,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(45,55,"GENERATE")),r.mc("disabled",e.form.controls.name.disabled),r.Bb(3),r.mc("ngIf",e.formErrors.name),r.Bb(4),r.Ic(" ",r.hc(52,57,"DESCRIPTION")," "),r.Bb(3),r.mc("ngClass",r.rc(82,ot,e.localeCurrent!=e.localeDefault)),r.Bb(4),r.Ic(" ",r.hc(59,59,"IMAGE")," "),r.Bb(3),r.mc("hasPreviewImage",!0)("allowedExtensions","image/*")("files",e.files),r.Bb(4),r.Ic(" ",r.hc(66,61,"CONTENT_TYPE")," "),r.Bb(3),r.Fb("is-invalid",e.formErrors.contentTypeName),r.Bb(1),r.mc("ngForOf",e.contentTypes),r.Bb(1),r.mc("ngIf",e.formErrors.contentTypeName),r.Bb(1),r.mc("ngIf",!e.isRoot),r.Bb(7),r.Hc(r.hc(79,63,"ACTIVE")),r.Bb(5),r.Hc(r.hc(84,65,"CLEAR_FILE_CACHE")),r.Bb(2),r.mc("ngIf",e.errorMessage),r.Bb(2),r.mc("ngIf",e.localeList.length>1),r.Bb(2),r.mc("disabled",e.submitted||e.isSaveButtonDisabled),r.Bb(2),r.Hc(r.hc(92,67,"SAVE_AND_CLOSE")),r.Bb(3),r.mc("disabled",e.submitted||e.isSaveButtonDisabled),r.Bb(2),r.mc("disabled",e.submitted||e.isSaveButtonDisabled),r.Bb(1),r.Ic(" ",r.hc(98,69,"SAVE")," "),r.Bb(4),r.Hc(r.hc(102,71,"CLOSE")))},directives:[h.w,h.o,h.h,o.n,o.p,h.b,h.n,h.g,O.v,q.a,h.u,o.o,h.a,O.d,O.g,O.f,O.e,F.a,h.q,h.x,h.r,O.u,h.p,O.c,O.t],pipes:[c.c],encapsulation:2}),t})(),lt=(()=>{class t{constructor(t,e,i,o,n){this.router=t,this.route=e,this.modalService=i,this.categoriesService=o,this.translateService=n,this.rootTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",this.changeRequest=new r.n,this.currentCategory=new u(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode={id:0},this.categoriesTree=[{id:0,parentId:0,label:"",expanded:!0,children:null}],this.categories=[],this.errorMessage="",this.categoryId=0,this.loading=!1,this.destroyed$=new R.a}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang][t]||t}ngOnInit(){this.loading=!0,this.getCategories().then(t=>{this.loading=!1,this.route.paramMap.pipe(Object(_.a)(this.destroyed$)).subscribe(t=>{this.categoryId=t.get("categoryId")?parseInt(t.get("categoryId"),10):0,this.selectCurrent()})})}selectCurrent(){if(this.currentCategory.id===this.categoryId)return;const t=Object(b.findIndex)(this.categories,{id:this.categoryId});t>-1?(this.currentCategory=Object(b.cloneDeep)(this.categories[t]),this.changeRequest.emit(this.currentCategory)):this.openRootCategory(),this.currentCategoryNode=u.getCurrentNode(this.currentCategory.id,this.categoriesTree[0])}getCategories(){return new Promise((t,e)=>{this.categoriesService.getListPage(new D.a("menuIndex,title","asc",1)).subscribe(e=>{e.items&&e.items.length>0&&(this.categories=e.items,this.categoriesTree=[u.createTree(e.items)]),t(e.items)},t=>{this.errorMessage=t,e()})})}openModalCategory(t,e=!1){this.categoriesDropdown.nativeElement.previousSibling.classList.remove("dropdown-toggle-hover"),setTimeout(()=>{this.categoriesDropdown.nativeElement.previousSibling.classList.add("dropdown-toggle-hover")},1);const i=this.getModalElementId(t);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const t=window.document.getElementById(i),e=t.previousElementSibling;return t.classList.add("d-block"),t.classList.remove("modal-minimized"),void e.classList.remove("d-none")}const o=0===t||null===t,n=void 0!==t&&!e;this.modalRef=this.modalService.open(ct,{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.modalRef.componentInstance.modalTitle=n?this.getLangString("CATEGORY")+(t?` #${t}`:""):this.getLangString("ADD_NEW_CATEGORY"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.currentCategory=this.currentCategory,this.modalRef.componentInstance.isRoot=o,this.modalRef.componentInstance.isEditMode=n,this.modalRef.result.then(t=>{this.destroyed$.isStopped||(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1}))},t=>{this.destroyed$.isStopped||(t&&["submit","updated"].indexOf(t)>-1&&(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1})),this.loading=!1)})}getModalElementId(t){return["modal","category",t||0].join("-")}deleteCategoryItemConfirm(t){const e=Object(b.findIndex)(this.categories,{id:t});-1!==e&&(this.modalRef=this.modalService.open(P.b),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE_CATEGORY")+` "${this.categories[e].title}"?`,this.modalRef.result.then(e=>{"accept"===e&&this.deleteCategoryItem(t)},t=>{}))}deleteCategoryItem(t){this.loading=!0,this.categoriesService.deleteItem(t).subscribe(t=>{this.categoryId=0,this.getCategories().then(()=>{this.goToRootCategory(),this.loading=!1})},t=>{t.error&&(this.errorMessage=t.error),this.loading=!1})}openCategory(t){this.router.navigate(["/catalog/category",t.node.id])}goToRootCategory(){this.router.navigate(["/catalog/category",""])}openRootCategory(){this.currentCategory=new u(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode=this.categoriesTree[0],this.changeRequest.emit(this.currentCategory)}copyCategory(){this.openModalCategory(this.currentCategory.id,!0)}expandAll(t){t&&t.preventDefault(),this.categoriesTree.forEach(t=>{this.expandRecursive(t,!0)})}collapseAll(t){t&&t.preventDefault(),this.categoriesTree.forEach(t=>{this.expandRecursive(t,!1)})}expandRecursive(t,e){t.expanded=e,t.children&&t.children.forEach(t=>{this.expandRecursive(t,e)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(s.c),r.Nb(s.a),r.Nb(O.h),r.Nb(T.a),r.Nb(c.d))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-categories-menu"]],viewQuery:function(t,e){if(1&t&&r.Kc(nt,3),2&t){let t;r.wc(t=r.ec())&&(e.categoriesDropdown=t.first)}},inputs:{rootTitle:"rootTitle"},outputs:{changeRequest:"changeRequest"},decls:26,vars:26,consts:[[1,"d-block","d-md-inline-block","dropdown"],[1,"btn","btn-secondary","dropdown-toggle","dropdown-toggle-hover","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],[1,"icon-folder","mr-1"],[1,"dropdown-menu","main-menu-container","py-3","shadow"],["categoriesDropdown",""],[1,"px-3","pb-3"],[1,"float-right"],[4,"ngIf"],["type","button","class","btn btn-sm btn-secondary mr-2",3,"ngbTooltip","click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","click"],[1,"icon-plus"],[1,"icon-pencil"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"ngbTooltip","hidden","click"],[1,"icon-stack"],[1,"icon-cross"],[1,"px-3","max-height400"],[3,"value","emptyMessage","selectionMode","selection","filter","onNodeSelect"],[1,"pi","pi-angle-double-down"],["type","button",1,"btn","btn-sm","btn-secondary",3,"ngbTooltip","click"],[1,"pi","pi-angle-double-up"],[1,"icon-home"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"button",1),r.Ob(2,"i",2),r.Gc(3),r.Sb(),r.Tb(4,"div",3,4),r.Tb(6,"div"),r.Tb(7,"div",5),r.Tb(8,"div",6),r.Ec(9,st,7,6,"ng-container",7),r.Sb(),r.Ec(10,rt,3,3,"button",8),r.Tb(11,"button",9),r.dc("click",function(){return e.openModalCategory()}),r.gc(12,"translate"),r.Ob(13,"i",10),r.Sb(),r.Tb(14,"button",9),r.dc("click",function(){return e.openModalCategory(e.currentCategory.id)}),r.gc(15,"translate"),r.Ob(16,"i",11),r.Sb(),r.Tb(17,"button",12),r.dc("click",function(){return e.copyCategory()}),r.gc(18,"translate"),r.Ob(19,"i",13),r.Sb(),r.Tb(20,"button",12),r.dc("click",function(){return e.deleteCategoryItemConfirm(e.currentCategory.id)}),r.gc(21,"translate"),r.Ob(22,"i",14),r.Sb(),r.Sb(),r.Tb(23,"div",15),r.Tb(24,"p-tree",16),r.dc("onNodeSelect",function(t){return e.openCategory(t)}),r.gc(25,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb()),2&t&&(r.Bb(3),r.Ic(" ",e.currentCategory.title," "),r.Bb(3),r.Fb("loading",e.loading),r.Bb(3),r.mc("ngIf",e.categoriesTree[0].children),r.Bb(1),r.mc("ngIf",e.currentCategory.id>0),r.Bb(1),r.nc("ngbTooltip",r.hc(12,16,"ADD_NEW_CATEGORY")),r.Bb(3),r.nc("ngbTooltip",r.hc(15,18,"EDIT_CATEGORY")),r.Bb(3),r.nc("ngbTooltip",r.hc(18,20,"COPY_CATEGORY")),r.mc("hidden",!e.currentCategory.id),r.Bb(3),r.nc("ngbTooltip",r.hc(21,22,"DELETE_CATEGORY")),r.mc("hidden",!e.currentCategory.id),r.Bb(4),r.mc("value",e.categoriesTree[0].children)("emptyMessage",r.hc(25,24,"NO_CATEGORIES"))("selectionMode","single")("selection",e.currentCategoryNode)("filter",!!e.categoriesTree[0].children))},directives:[o.p,O.v,H.a],pipes:[c.c],encapsulation:2}),t})();var at=i("hecf");const dt=function(t){return{"form-control-search-clear":t}};let bt=(()=>{class t extends m.a{constructor(t,e,i,o,n){super(t,e,i,o),this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=o,this.contentTypesService=n,this.queryOptions=new D.a("id","desc",1,10,0,0),this.tableFields=[]}ngOnInit(){}updateTableConfig(){this.currentContentType&&(this.tableFields=[],this.currentContentType.fields.forEach(t=>{t.showInTable&&this.tableFields.push({name:t.name,sortName:t.name,title:t.title,outputType:t.outputType,outputProperties:t.outputProperties})}),this.tableFields.unshift({name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}}),this.tableFields.push({name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}))}getModalContent(){return G}getContentType(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}openCategory(t){if(this.currentCategory=Object(b.clone)(t),!this.currentCategory.contentTypeName)return this.items=[],this.tableFields=[],void(this.currentCategory.id=0);this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.loading=!0,this.queryOptions.page=1,this.getContentType().subscribe(t=>{this.currentContentType=t,this.loading=!1,this.updateTableConfig(),this.getList()},()=>{this.items=[],this.tableFields=[],this.currentCategory.id=0})}openRootCategory(){this.currentCategory=new u(0,!1,0,"root","","","",!0),this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.getList()}setModalInputs(t,e=!1,i=""){const o=void 0!==t&&!e;this.modalRef.componentInstance.modalTitle=o?`${this.getLangString("PAGE")} #${t}`:this.getLangString("ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.isEditMode=o;const n=this.items.findIndex(e=>e.id===t);this.modalRef.componentInstance.categoryId=n>-1?this.items[n].parentId:this.currentCategory.id}getModalElementId(t){return["modal","product",t||0].join("-")}}return t.title="CATEGORY",t.\u0275fac=function(e){return new(e||t)(r.Nb(I),r.Nb(O.b),r.Nb(O.h),r.Nb(c.d),r.Nb(S.a))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-catalog-category"]],features:[r.Ab([I]),r.yb],decls:30,vars:25,consts:[[1,"mb-3"],[1,"float-md-left"],[3,"changeRequest"],[1,"form-control-search","d-block","d-md-inline-block","ml-0","ml-md-3","mb-2","mb-lg-0",3,"ngClass"],["type","text",1,"form-control","min-width250",3,"placeholder","ngModel","ngModelChange"],[3,"click"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div"),r.Tb(2,"div",1),r.Tb(3,"app-categories-menu",2),r.dc("changeRequest",function(t){return e.openCategory(t)}),r.Sb(),r.Tb(4,"div",3),r.Tb(5,"input",4),r.dc("ngModelChange",function(t){return e.queryOptions.search_word=t})("ngModelChange",function(){return e.onSearchWordUpdate()}),r.gc(6,"translate"),r.Sb(),r.Tb(7,"span",5),r.dc("click",function(){return e.onSearchWordUpdate("")}),r.Sb(),r.Sb(),r.Sb(),r.Tb(8,"div",6),r.Tb(9,"div",7),r.Tb(10,"button",8),r.Tb(11,"span"),r.Gc(12),r.gc(13,"translate"),r.Sb(),r.Sb(),r.Tb(14,"div",9),r.Tb(15,"button",10),r.dc("click",function(){return e.blockSelected()}),r.Gc(16),r.gc(17,"translate"),r.Sb(),r.Tb(18,"button",10),r.dc("click",function(){return e.deleteSelected()}),r.Gc(19),r.gc(20,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"button",11),r.dc("click",function(){return e.modalOpen()}),r.Ob(22,"i",12),r.Gc(23," \xa0 "),r.Tb(24,"span"),r.Gc(25),r.gc(26,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Ob(27,"div",13),r.Sb(),r.Sb(),r.Tb(28,"app-table",14,15),r.dc("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)}),r.Sb()),2&t&&(r.Bb(4),r.mc("ngClass",r.rc(23,dt,!!e.queryOptions.search_word)),r.Bb(1),r.oc("placeholder","",r.hc(6,13,"SEARCH"),"..."),r.mc("ngModel",e.queryOptions.search_word),r.Bb(7),r.Hc(r.hc(13,15,"BATCH_ACTIONS")),r.Bb(4),r.Hc(r.hc(17,17,"DISABLE_ENABLE")),r.Bb(3),r.Hc(r.hc(20,19,"DELETE")),r.Bb(6),r.Hc(r.hc(26,21,"ADD")),r.Bb(3),r.mc("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("loading",e.loading))},directives:[lt,o.n,h.b,h.n,h.p,O.d,O.g,O.f,at.a],pipes:[c.c],encapsulation:2}),t})();var ut=i("LRne"),mt=i("JIr8");let ht=(()=>{class t{constructor(t){this.http=t,this.headers=new y.e({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}setRequestUrl(t){this.requestUrl=t}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe(Object(mt.a)(this.handleError()))}deleteItemByName(t){const e=`${this.getRequestUrl()}/${t}`;return this.http.delete(e,{headers:this.headers}).pipe(Object(mt.a)(this.handleError()))}handleError(t="operation",e){return t=>{if(t.error)throw t.error;return Object(ut.a)(e)}}}return t.\u0275fac=function(e){return new(e||t)(r.ac(y.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac}),t})(),pt=(()=>{class t extends v.a{constructor(t){super(t),this.setRequestUrl("/admin/field_types")}}return t.\u0275fac=function(e){return new(e||t)(r.ac(y.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac}),t})();var gt=i("XWOk"),ft=i("fMdm");const Tt=["addCollectionBlock"],St=["addGroupBlock"],vt=["accordion"],yt=["blockFieldList"];function It(t,e){if(1&t&&(r.Tb(0,"div",114),r.Gc(1),r.Sb()),2&t){const t=r.fc().message;r.Bb(1),r.Hc(t)}}function Ct(t,e){if(1&t&&(r.Tb(0,"p",111),r.Gc(1),r.gc(2,"translate"),r.Sb(),r.Ec(3,It,2,1,"div",112),r.Tb(4,"div",111),r.Tb(5,"button",113),r.dc("click",function(){return(0,e.confirm)()}),r.Gc(6),r.gc(7,"translate"),r.Sb(),r.Gc(8," \xa0 "),r.Tb(9,"button",48),r.dc("click",function(){return e.p.close()}),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Sb()),2&t){const t=e.message;r.Bb(1),r.Hc(r.hc(2,4,"YOU_SURE_YOU_WANT_DELETE")),r.Bb(2),r.mc("ngIf",t),r.Bb(3),r.Hc(r.hc(7,6,"YES")),r.Bb(4),r.Hc(r.hc(11,8,"NO"))}}function Et(t,e){if(1&t&&(r.Tb(0,"option",115),r.Gc(1),r.Sb()),2&t){const t=e.$implicit;r.nc("value",t),r.Bb(1),r.Hc(t)}}function Bt(t,e){if(1&t&&(r.Tb(0,"div",116),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.newCollection," ")}}function Ot(t,e){if(1&t&&(r.Tb(0,"option",115),r.Gc(1),r.Sb()),2&t){const t=e.$implicit;r.nc("value",t.name),r.Bb(1),r.Hc(t.title)}}const Ft=function(){return{standalone:!0}};function wt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",117),r.Tb(1,"div",58),r.Tb(2,"label",59),r.Gc(3),r.Sb(),r.Sb(),r.Tb(4,"div",60),r.Tb(5,"input",118),r.dc("ngModelChange",function(i){r.yc(t);const o=e.$implicit;return r.fc().fieldModel.inputProperties[o.name]=i}),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=e.$implicit,i=r.fc();r.Bb(2),r.pc("for","parameterInputField",t.name,"",i.uniqueId,""),r.Bb(1),r.Hc(t.title),r.Bb(2),r.pc("id","parameterInputField",t.name,"",i.uniqueId,""),r.mc("ngModel",i.fieldModel.inputProperties[t.name])("ngModelOptions",r.qc(7,Ft))}}function Nt(t,e){if(1&t&&(r.Tb(0,"option",115),r.Gc(1),r.Sb()),2&t){const t=e.$implicit;r.nc("value",t.name),r.Bb(1),r.Hc(t.title)}}function kt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",117),r.Tb(1,"div",58),r.Tb(2,"label",59),r.Gc(3),r.Sb(),r.Sb(),r.Tb(4,"div",60),r.Tb(5,"input",118),r.dc("ngModelChange",function(i){r.yc(t);const o=e.$implicit;return r.fc().fieldModel.outputProperties[o.name]=i}),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=e.$implicit,i=r.fc();r.Bb(2),r.pc("for","parameterOutputField",t.name,"",i.uniqueId,""),r.Bb(1),r.Hc(t.title),r.Bb(2),r.pc("id","parameterOutputField",t.name,"",i.uniqueId,""),r.mc("ngModel",i.fieldModel.outputProperties[t.name])("ngModelOptions",r.qc(7,Ft))}}function Mt(t,e){if(1&t&&(r.Tb(0,"option",115),r.Gc(1),r.Sb()),2&t){const t=e.$implicit;r.mc("value",t),r.Bb(1),r.Hc(t)}}function Lt(t,e){if(1&t&&(r.Tb(0,"div",22),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.secondFormErrors.group," ")}}function At(t,e){if(1&t&&(r.Tb(0,"div",116),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.secondFormErrors.newGroup," ")}}function Gt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"tr",134),r.Tb(1,"td"),r.Gc(2),r.Tb(3,"span",135),r.Gc(4),r.Sb(),r.Sb(),r.Tb(5,"td"),r.Gc(6),r.Sb(),r.Tb(7,"td",129),r.Gc(8),r.Sb(),r.Tb(9,"td",129),r.Ob(10,"app-output-field",136),r.Sb(),r.Tb(11,"td"),r.Tb(12,"div",137),r.Tb(13,"div",138),r.Tb(14,"button",139),r.dc("click",function(i){r.yc(t);const o=e.$implicit;return r.fc(2).editField(o,i)}),r.gc(15,"translate"),r.Ob(16,"i",140),r.Sb(),r.Tb(17,"button",141),r.dc("click",function(i){r.yc(t);const o=e.$implicit;return r.fc(2).copyField(o,i)}),r.gc(18,"translate"),r.Ob(19,"i",142),r.Sb(),r.Tb(20,"button",139),r.dc("click",function(i){r.yc(t);const o=e.$implicit;return r.fc(2).deleteField(o,i)}),r.gc(21,"translate"),r.Ob(22,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Ob(23,"app-output-field",136),r.Sb(),r.Sb()}if(2&t){const t=e.$implicit,i=r.fc(2);r.Bb(2),r.Ic(" ",t.title," "),r.Bb(2),r.Ic("(",t.name,")"),r.Bb(2),r.Ic(" ",t.inputType," "),r.Bb(2),r.Ic(" ",t.group," "),r.Bb(2),r.mc("value",t.required),r.Bb(4),r.nc("ngbTooltip",r.hc(15,11,"EDIT")),r.mc("hidden",t.name==i.currentFieldName),r.Bb(3),r.nc("ngbTooltip",r.hc(18,13,"COPY")),r.Bb(3),r.nc("ngbTooltip",r.hc(21,15,"DELETE")),r.mc("hidden",t.name==i.currentFieldName),r.Bb(3),r.mc("value",t.showInTable)}}function Dt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",null,119),r.Tb(2,"div"),r.Tb(3,"div",120),r.Tb(4,"select",121,122),r.Tb(6,"option",66),r.Gc(7),r.gc(8,"translate"),r.Sb(),r.Tb(9,"option",123),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Tb(12,"option",124),r.Gc(13),r.gc(14,"translate"),r.Sb(),r.Tb(15,"option",125),r.Gc(16),r.gc(17,"translate"),r.Sb(),r.Sb(),r.Tb(18,"button",126),r.dc("click",function(e){r.yc(t);const i=r.xc(5);return r.fc().sortingStart(i.value,e)}),r.Ob(19,"i",127),r.Gc(20),r.gc(21,"translate"),r.Sb(),r.Sb(),r.Tb(22,"div"),r.Tb(23,"table",128),r.Tb(24,"thead"),r.Tb(25,"tr"),r.Tb(26,"th"),r.Gc(27),r.gc(28,"translate"),r.Sb(),r.Tb(29,"th"),r.Gc(30),r.gc(31,"translate"),r.Sb(),r.Tb(32,"th",129),r.Gc(33),r.gc(34,"translate"),r.Sb(),r.Tb(35,"th",129),r.Gc(36),r.gc(37,"translate"),r.Sb(),r.Tb(38,"th"),r.Gc(39),r.gc(40,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(41,"tbody"),r.Ec(42,Gt,24,17,"tr",130),r.Tb(43,"tr",131),r.Tb(44,"td",132),r.Gc(45),r.gc(46,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(47,"app-sorting-dnd",133),r.dc("itemsChange",function(e){return r.yc(t),r.fc().sortData=e})("save",function(e){return r.yc(t),r.fc().sortingApply(e)})("cancel",function(){return r.yc(t),r.fc().sortingReset()}),r.Sb()}if(2&t){const t=r.fc();r.Bb(3),r.mc("hidden",t.model.fields.length<2),r.Bb(4),r.Hc(r.hc(8,15,"SORT_FIELDS")),r.Bb(3),r.Hc(r.hc(11,17,"SORT_FIELDS_LIST")),r.Bb(3),r.Hc(r.hc(14,19,"SORT_FIELDS_PAGE")),r.Bb(3),r.Hc(r.hc(17,21,"SORT_FILTERS")),r.Bb(4),r.Ic(" ",r.hc(21,23,"SORT")," "),r.Bb(7),r.Hc(r.hc(28,25,"TITLE")),r.Bb(3),r.Hc(r.hc(31,27,"INPUT_TYPE")),r.Bb(3),r.Hc(r.hc(34,29,"GROUP")),r.Bb(3),r.Ic("",r.hc(37,31,"REQUIRED"),"?"),r.Bb(3),r.Ic("",r.hc(40,33,"SHOW_IN_TABLE"),"?"),r.Bb(3),r.mc("ngForOf",t.model.fields),r.Bb(1),r.mc("hidden",t.model.fields.length>0),r.Bb(2),r.Ic(" ",r.hc(46,35,"EMPTY")," "),r.Bb(2),r.mc("items",t.sortData)}}function Rt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",143),r.Tb(1,"button",91),r.dc("click",function(){return r.yc(t),r.fc().errorMessage=""}),r.Tb(2,"span",92),r.Gc(3,"\xd7"),r.Sb(),r.Sb(),r.Gc(4),r.Sb()}if(2&t){const t=r.fc();r.Bb(4),r.Ic(" ",t.errorMessage," ")}}const _t=function(t){return{"no-events":t}},xt=function(t){return{"is-invalid":t}},Pt=function(){return["/catalog"]};let qt=(()=>{class t extends x.a{constructor(t,e,i,o,n,s,r,c,l){super(t,e,i,o,n,s),this.fb=t,this.activeModal=e,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.fieldTypesService=r,this.collectionsService=c,this.modalService=l,this._secondFormFieldsErrors={},this.model=new p(0,"","","","products",[],["General","Service"],!0,!1),this.fieldModel=new E.a(0,"","","","",{},"",{},""),this.sortData=[],this.sortingfieldName="",this.fld_submitted=!1,this.action="add_field",this.currentFieldName="",this.collections=["products"],this.fieldTypeProperties={input:[],output:[]},this.formFields=[{name:"title",validators:[h.v.required]},{name:"name",validators:[h.v.required,h.v.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"collection",validators:[h.v.required]},{name:"newCollection",validators:[h.v.pattern("[A-Za-z0-9_-]+")]},{name:"isCreateByUsersAllowed",validators:[]},{name:"isActive",validators:[]}],this.secondFormFields=[{name:"title",validators:[h.v.required]},{name:"name",validators:[h.v.required,h.v.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"inputType",validators:[h.v.required]},{name:"outputType",validators:[h.v.required]},{name:"group",validators:[h.v.required]},{name:"newGroup",validators:[]},{name:"required",validators:[]},{name:"showInTable",validators:[]},{name:"showOnPage",validators:[]},{name:"showInList",validators:[]},{name:"isFilter",validators:[]}]}set secondFormErrors(t){for(const e in t)if(t.hasOwnProperty(e)){const t=this.getControl(this.form,null,e);t&&t.setErrors({incorrect:!0})}this._secondFormFieldsErrors=t}get secondFormErrors(){return this._secondFormFieldsErrors}onAfterInit(){this.buildForm("secondForm",this.secondFormFields,this.secondFormErrors,"fieldModel"),this.onValueChanged("secondForm",this.secondFormErrors),this.getFieldTypes(),this.getCollectionsList()}getFieldTypes(){const t=new D.a("title","asc",0,0,1);this.fieldTypesService.getListPage(t).subscribe(t=>{this.fieldTypes=t.items},t=>this.errorMessage=t)}getCollectionsList(){this.collectionsService.getList().subscribe(t=>{t.length>0&&(this.collections=t)})}selectFieldTypeProperties(t,e){e?this.secondForm.get(`${t}Type`).setValue(e):e=this.secondForm.get(`${t}Type`).value,this.fieldModel[`${t}Type`]=e;const i=Object(b.find)(this.fieldTypes,{name:e});if(!i)return void(this.fieldTypeProperties[t]=[]);const o=`${t}Properties`,n=Object(b.map)(i[`${t}Properties`],"name");this.fieldTypeProperties[t].splice(0),i[t+"Properties"].forEach((e,i)=>{this.fieldTypeProperties[t].push(e)});for(const s in this.fieldModel[o])this.fieldModel[o].hasOwnProperty(s)&&-1===n.indexOf(s)&&delete this.fieldModel[o][s];for(const s in this.fieldTypeProperties[t])if(this.fieldTypeProperties[t].hasOwnProperty(s)){const e=this.fieldTypeProperties[t][s].name;void 0===this.fieldModel[o][e]&&(this.fieldModel[o][e]=this.fieldTypeProperties[t][s].default_value)}"input"!==t||this.fieldModel.outputType||this.selectFieldTypeProperties("output",e)}addCollectionToggle(t,e){this.displayToggle(this.elementAddCollectionBlock.nativeElement),t.value="",this.onValueChanged(),t.focus()}addCollection(t){t&&t.preventDefault();const e="newCollection",i=this.form.get(e);if(!i.valid||!i.value)return!1;this.formErrors[e]="";const o=i.value;return this.collections.indexOf(o)>-1?(this.getControl(this.form,null,e).setErrors({exists:"COLLECTION_EXISTS"}),this.formErrors[e]=this.getLangString("COLLECTION_EXISTS"),!1):(this.collections.push(o),this.model.collection=o,this.getControl(this.form,null,e).setValue(o),this.elementAddCollectionBlock.nativeElement.style.display="none",!0)}deleteCollection(t){if(!this.model.collection)return;if(t.isOpen())return void t.close();let e;t.placement="top",t.popoverTitle=this.getLangString("CONFIRM"),e={p:t,confirm:(()=>{this.loading=!0,this.collectionsService.deleteItemByName(this.model.collection).subscribe(e=>{const i=this.collections.indexOf(this.model.collection);i>-1&&(this.collections.splice(i,1),this.model.collection=this.collections[0]||""),t.close(),this.loading=!1},t=>{this.errorMessage=t.error||"Error.",this.loading=!1})}).bind(this),message:""},t.open(e)}addGroup(t){t&&t.preventDefault();const e=this.secondForm.get("newGroup");if(!e||!e.valid||!e.value)return!1;this.errorFieldMessage="",this.secondFormErrors.newGroup="";const i=e.value;return this.model.groups.indexOf(i)>-1?(this.getControl(this.secondForm,null,"newGroup").setErrors({exists:"GROUP_ALREADY_EXISTS"}),this.secondFormErrors.newGroup=this.getLangString("GROUP_ALREADY_EXISTS"),!1):(this.model.groups.push(i),this.fieldModel.group=i,this.getControl(this.secondForm,null,"group").setValue(this.fieldModel.group),this.elementAddGroupBlock.nativeElement.style.display="none",!0)}deleteGroup(){const t=this.secondForm.get("group").value;let e=Object(b.findIndex)(this.model.fields,{group:t});this.errorFieldMessage="",e>-1?this.errorFieldMessage=this.getLangString("YOU_CANT_DELETE_NOTEMPTY_GROUP"):(e=this.model.groups.indexOf(t),e>-1&&this.model.groups.splice(e,1))}editField(t,e){e&&e.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="edit_field",this.fieldModel=Object(b.cloneDeep)(t);const i={};this.secondFormFields.forEach(e=>{i[e.name]=t[e.name]||null}),this.secondForm.setValue(i),this.selectFieldTypeProperties("input"),this.selectFieldTypeProperties("output"),this.currentFieldName=this.fieldModel.name,this.fld_submitted=!1}copyField(t,e){e&&e.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="add_field",this.fieldModel=Object(b.cloneDeep)(t),this.fieldModel.name="",this.secondForm.setValue(this.fieldModel),this.currentFieldName="",this.fld_submitted=!1}deleteField(t,e){e&&e.preventDefault();const i=Object(b.findIndex)(this.model.fields,{name:t.name});-1!==i?this.model.fields.splice(i,1):this.errorMessage="Field not found."}resetFieldForm(){this.action="add_field",this.errorMessage="",this.errorFieldMessage="",this.fld_submitted=!1,this.currentFieldName="",this.secondForm.reset(),this.fieldModel=new E.a(0,"","","","",{},"",{},"")}editFieldCancel(t){t&&t.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.resetFieldForm(),this.onValueChanged("secondForm",this.secondFormErrors)}fieldMove(t,e){if("up"===e&&0===t||"down"===e&&t===this.model.fields.length-1)return;const i="up"===e?t-1:t+1,o=this.model.fields[t];this.model.fields.splice(t,1),this.model.fields.splice(i,0,o)}submitField(t){if(t&&t.preventDefault(),this.errorFieldMessage="",this.fld_submitted=!0,!this.secondForm.valid)return this.formGroupMarkTouched(this.secondForm),this.onValueChanged("secondForm",this.secondFormErrors),void(this.fld_submitted=!1);const e=Object(b.cloneDeep)(Object.assign({},this.secondForm.value,{inputProperties:this.fieldModel.inputProperties,outputProperties:this.fieldModel.outputProperties}));let i=Object(b.findIndex)(this.model.fields,{name:e.name});i>-1&&this.currentFieldName!==e.name?this.errorFieldMessage=this.getLangString("FIELD_NAME_EXISTS"):(this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),"add_field"===this.action?this.model.fields.push(e):"edit_field"===this.action&&(i=Object(b.findIndex)(this.model.fields,{name:this.currentFieldName}),i>-1&&(this.model.fields[i]=e)),this.resetFieldForm())}getFieldTypeProperty(t,e){if(!t)return null;let i=null;const o=Object(b.findIndex)(this.fieldTypes,{name:t});return o>-1&&void 0!==this.fieldTypes[o][e]&&(i=this.fieldTypes[o][e]),i}sortingInit(t,e,i){let o;i&&i.preventDefault(),this.sortingfieldName=t,o=e?this.model.fields.filter(t=>t[e]):this.model.fields,t&&o.sort(function(e,i){return e[t]-i[t]}),this.sortData=[],o.forEach(t=>{this.sortData.push({name:t.name,title:t.title})}),this.blockFieldList.nativeElement.style.display="none"}sortingStart(t,e){e&&e.preventDefault(),this.errorMessage="";const i=t.split("-");this.sortingfieldName=i[0];const o=i[1]?this.model.fields.filter(t=>t[i[1]]):this.model.fields;o.sort(function(t,e){return t[i[0]]-e[i[0]]}),0!==o.length?(this.sortData=o.map(t=>({name:t.name,title:t.title})),this.blockFieldList.nativeElement.style.display="none"):this.errorMessage=this.getLangString("SORT_FIELDS_EMPTY")}sortingApply(t){if(this.sortingfieldName)this.sortData.forEach((t,e)=>{const i=this.model.fields.findIndex(e=>e.name===t.name);i>-1&&(this.model.fields[i][this.sortingfieldName]=e)});else{const t=this.sortData.map(t=>t.name);this.model.fields.sort(function(e,i){return t.indexOf(e.name)-t.indexOf(i.name)})}this.sortingReset()}sortingReset(){const t=Object(b.findIndex)(this.model.fields,{name:this.currentFieldName});this.action=t>-1?"edit_field":"add_field",this.sortData.splice(0,this.sortData.length),this.sortingfieldName="",this.blockFieldList.nativeElement.style.display="block"}getSaveRequest(t){return t.id?this.dataService.update(t):this.dataService.create(t)}getFormData(){this.sortData.length>0&&this.sortingApply();const t=this.form.value;return t.id=this.model.id||0,t.groups=this.model.groups,t.fields=this.model.fields,t}toggleAccordion(t,e,i){t.activeIds.indexOf(e)>-1&&i||t.toggle(e)}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(h.e),r.Nb(O.b),r.Nb(c.d),r.Nb(f.a),r.Nb(S.a),r.Nb(r.l),r.Nb(pt),r.Nb(ht),r.Nb(O.h))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-content-type-modal-content"]],viewQuery:function(t,e){if(1&t&&(r.Kc(Tt,3),r.Kc(St,3),r.Kc(vt,3),r.Kc(yt,1)),2&t){let t;r.wc(t=r.ec())&&(e.elementAddCollectionBlock=t.first),r.wc(t=r.ec())&&(e.elementAddGroupBlock=t.first),r.wc(t=r.ec())&&(e.accordion=t.first),r.wc(t=r.ec())&&(e.blockFieldList=t.first)}},features:[r.yb],decls:298,vars:254,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["confirmPopover",""],[1,"modal-body","py-0"],[1,"row","mb-3"],[1,"col-lg-4",3,"formGroup"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"form-group","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],[1,"alert","alert-danger"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group"],["for","fieldDescription",1,"label-filled"],["type","text","rows","3","name","description","id","fieldDescription","formControlName","description",1,"form-control"],[1,"form-group","row","form-group-message"],[1,"col-12"],[1,"form-group","mb-0"],["for","fieldCollectionName",1,"label-filled"],["id","fieldCollectionName","name","collection","formControlName","collection",1,"custom-select","custom-select-sm",3,"ngModel","ngClass","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"icon-plus"],["triggers","manual",1,"input-group-append",3,"ngbPopover"],["buttonDeleteCollection","ngbPopover"],[1,"card","p-1","mt-2","form-group-message",2,"display","none"],["addCollectionBlock",""],["type","text","formControlName","newCollection",1,"form-control","form-control-sm",3,"ngClass"],["addCollectionField",""],["class","alert alert-danger mb-1",4,"ngIf"],[1,"text-right","mt-1"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isCreateByUsersAllowed","formControlName","isCreateByUsersAllowed",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"],[1,"card","card-body","p-2","pl-3"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id"],[1,"col-lg-8",3,"formGroup"],[1,"label-filled",3,"hidden"],[1,"card"],[1,"card-body"],[1,"col-md-5"],[3,"for"],[1,"col-md-7"],["type","text","name","field_title","formControlName","title",1,"form-control","form-control-sm",3,"id","ngClass"],["type","text","name","field_name","formControlName","name",1,"form-control","form-control-sm",3,"id","ngClass"],[1,"form-group","row"],["type","text","rows","3","name","field_description","formControlName","description",1,"form-control","form-control-sm",3,"id","ngClass"],["name","field_inputType","formControlName","inputType","placement","left",1,"custom-select","custom-select-sm",3,"id","ngbTooltip","change"],["value",""],[1,"icon-cog"],[1,"card","card-body","bg-light","mb-3",2,"display","none",3,"hidden"],["inputTypeOptionsBlock",""],[1,"alert","alert-secondary","small",3,"hidden"],["class","row form-group",4,"ngFor","ngForOf"],["name","field_outputType","formControlName","outputType","placement","left",1,"custom-select","custom-select-sm",3,"id","ngbTooltip","ngClass","change"],["outputTypeOptionsBlock",""],["for","field_fieldGroup"],[1,"form-group-message"],[1,"input-group","input-group-sm",3,"ngClass"],["id","field_fieldGroup","name","field_group","formControlName","group",1,"custom-select",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["addGroupBlock",""],["type","text","formControlName","newGroup",1,"form-control","form-control-sm",3,"ngClass"],["addGroupField",""],[1,"form-group","row","mb-0"],[1,"col-md-7","offset-md-5"],[1,"custom-control","custom-checkbox"],["type","checkbox","value","1","name","required","formControlName","required",1,"custom-control-input",3,"id"],["type","checkbox","value","1","name","showInTable","formControlName","showInTable",1,"custom-control-input",3,"id"],["type","checkbox","value","1","name","showOnPage","formControlName","showOnPage",1,"custom-control-input",3,"id"],["type","checkbox","value","1","name","showInList","formControlName","showInList",1,"custom-control-input",3,"id"],["type","checkbox","value","1","name","isFilter","formControlName","isFilter",1,"custom-control-input",3,"id"],[1,"alert","alert-danger","mt-3","mb-3",3,"hidden"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[1,"mt-3"],["type","button",1,"btn","btn-sm","btn-info","btn-wide",3,"hidden","click"],["type","button",1,"btn","btn-sm","btn-success","btn-wide",3,"hidden","click"],[1,"icon-check"],["type","button",1,"btn","btn-sm","btn-secondary","btn-wide",3,"click"],["activeIds","accordion-content-type-fields",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-content-type-fields",3,"title"],["ngbPanelContent",""],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"text-center"],["class","alert alert-danger p-2",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"alert","alert-danger","p-2"],[3,"value"],[1,"alert","alert-danger","mb-1"],[1,"row","form-group"],["type","text",1,"form-control","form-control-sm",3,"id","ngModel","ngModelOptions","ngModelChange"],["blockFieldList",""],[1,"text-right","mb-2",3,"hidden"],[1,"custom-select","custom-select-sm","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["sortTypeSelect",""],["value","listOrder-showInList"],["value","pageOrder-showOnPage"],["value","filterOrder-isFilter"],["type","button",1,"btn","btn-sm","btn-secondary","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-shuffle"],[1,"table","table-striped","table-divided","mb-0"],[1,"d-none","d-lg-table-cell"],["class","show-on-hover-parent",4,"ngFor","ngForOf"],[1,"table-active",3,"hidden"],["colspan","5",1,"text-center","p-3"],[3,"items","itemsChange","save","cancel"],[1,"show-on-hover-parent"],[1,"text-muted"],["outputType","boolean",3,"value"],[1,"relative"],[1,"show-on-hover-right"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"hidden","ngbTooltip","click"],[1,"icon-pencil"],["type","button",1,"btn","btn-secondary","btn-sm","ml-2",3,"ngbTooltip","click"],[1,"icon-stack"],[1,"alert","alert-danger","mt-3","mb-0"]],template:function(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"button",2),r.dc("click",function(t){return e.closeModal(t)}),r.Ob(3,"i",3),r.Tb(4,"span"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Sb(),r.Tb(7,"button",2),r.dc("click",function(t){return e.minimize(t)}),r.Ob(8,"i",4),r.Tb(9,"span"),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(12,"div",5),r.Tb(13,"div",6),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(t){return e.maximize(t)}),r.gc(16,"translate"),r.Ob(17,"i",9),r.Sb(),r.Tb(18,"button",10),r.dc("click",function(t){return e.closeModal(t)}),r.gc(19,"translate"),r.Ob(20,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"h4",12),r.Gc(22),r.Sb(),r.Sb(),r.Ec(23,Ct,12,10,"ng-template",null,13,r.Fc),r.Tb(25,"div",14),r.Tb(26,"div",15),r.Tb(27,"div",16),r.Tb(28,"form",17,18),r.dc("ngSubmit",function(){return e.onSubmit()}),r.Tb(30,"div",19),r.Tb(31,"label",20),r.Gc(32),r.gc(33,"translate"),r.Sb(),r.Ob(34,"input",21),r.Tb(35,"div",22),r.Gc(36),r.Sb(),r.Sb(),r.Tb(37,"div",19),r.Tb(38,"label",23),r.Gc(39),r.gc(40,"translate"),r.Sb(),r.Tb(41,"div",24),r.Ob(42,"input",25),r.Tb(43,"div",26),r.Tb(44,"button",27),r.dc("click",function(){return e.generateName(e.model)}),r.gc(45,"translate"),r.Ob(46,"i",28),r.Sb(),r.Sb(),r.Sb(),r.Tb(47,"div",22),r.Gc(48),r.Sb(),r.Sb(),r.Tb(49,"div",29),r.Tb(50,"label",30),r.Gc(51),r.gc(52,"translate"),r.Sb(),r.Ob(53,"textarea",31),r.Sb(),r.Tb(54,"div",32),r.Tb(55,"div",33),r.Tb(56,"div",34),r.Tb(57,"label",35),r.Gc(58),r.gc(59,"translate"),r.Sb(),r.Tb(60,"div",24),r.Tb(61,"select",36),r.dc("ngModelChange",function(t){return e.model.collection=t}),r.Ec(62,Et,2,2,"option",37),r.Sb(),r.Tb(63,"div",26),r.Tb(64,"button",38),r.dc("click",function(i){r.yc(t);const o=r.xc(75);return e.addCollectionToggle(o,i)}),r.gc(65,"translate"),r.Ob(66,"i",39),r.Sb(),r.Sb(),r.Tb(67,"div",40,41),r.Tb(69,"button",38),r.dc("click",function(){r.yc(t);const i=r.xc(68);return e.deleteCollection(i)}),r.gc(70,"translate"),r.Ob(71,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Tb(72,"div",42,43),r.Ob(74,"input",44,45),r.Ec(76,Bt,2,1,"div",46),r.Tb(77,"div",47),r.Tb(78,"button",48),r.dc("click",function(t){return e.addCollection(t)}),r.Gc(79),r.gc(80,"translate"),r.Sb(),r.Gc(81," \xa0 "),r.Tb(82,"button",48),r.dc("click",function(){return r.yc(t),r.xc(73).style.display="none",e.formErrors.newCollection=""}),r.Gc(83),r.gc(84,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(85,"div",29),r.Tb(86,"div",49),r.Ob(87,"input",50),r.Tb(88,"label",51),r.Gc(89),r.gc(90,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(91,"div",29),r.Tb(92,"div",52),r.Tb(93,"div",49),r.Ob(94,"input",53),r.Tb(95,"label",51),r.Gc(96),r.gc(97,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(98,"div",54),r.Tb(99,"label",55),r.Gc(100),r.gc(101,"translate"),r.Sb(),r.Tb(102,"label",55),r.Gc(103),r.gc(104,"translate"),r.Sb(),r.Tb(105,"div",56),r.Tb(106,"div",57),r.Tb(107,"div",32),r.Tb(108,"div",58),r.Tb(109,"label",59),r.Gc(110),r.gc(111,"translate"),r.Sb(),r.Sb(),r.Tb(112,"div",60),r.Ob(113,"input",61),r.Tb(114,"div",22),r.Gc(115),r.Sb(),r.Sb(),r.Sb(),r.Tb(116,"div",32),r.Tb(117,"div",58),r.Tb(118,"label",59),r.Gc(119),r.gc(120,"translate"),r.Sb(),r.Sb(),r.Tb(121,"div",60),r.Tb(122,"div",24),r.Ob(123,"input",62),r.Tb(124,"div",26),r.Tb(125,"button",38),r.dc("click",function(t){return e.generateName(e.fieldModel,t,e.secondForm)}),r.gc(126,"translate"),r.Ob(127,"i",28),r.Sb(),r.Sb(),r.Sb(),r.Tb(128,"div",22),r.Gc(129),r.Sb(),r.Sb(),r.Sb(),r.Tb(130,"div",63),r.Tb(131,"div",58),r.Tb(132,"label",59),r.Gc(133),r.gc(134,"translate"),r.Sb(),r.Sb(),r.Tb(135,"div",60),r.Ob(136,"textarea",64),r.Sb(),r.Sb(),r.Tb(137,"div",32),r.Tb(138,"div",58),r.Tb(139,"label",59),r.Gc(140),r.gc(141,"translate"),r.Sb(),r.Sb(),r.Tb(142,"div",60),r.Tb(143,"div",24),r.Tb(144,"select",65),r.dc("change",function(){return e.selectFieldTypeProperties("input")}),r.Ob(145,"option",66),r.Ec(146,Ot,2,2,"option",37),r.Sb(),r.Tb(147,"div",26),r.Tb(148,"button",38),r.dc("click",function(){r.yc(t);const i=r.xc(154);return e.displayToggle(i)}),r.gc(149,"translate"),r.Ob(150,"i",67),r.Sb(),r.Sb(),r.Sb(),r.Tb(151,"div",22),r.Gc(152),r.Sb(),r.Sb(),r.Sb(),r.Tb(153,"div",68,69),r.Tb(155,"div"),r.Tb(156,"div",70),r.Gc(157),r.gc(158,"translate"),r.Sb(),r.Ec(159,wt,6,8,"div",71),r.Sb(),r.Tb(160,"div",47),r.Tb(161,"button",48),r.dc("click",function(){return r.yc(t),r.xc(154).style.display="none"}),r.Gc(162),r.gc(163,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(164,"div",32),r.Tb(165,"div",58),r.Tb(166,"label",59),r.Gc(167),r.gc(168,"translate"),r.Sb(),r.Sb(),r.Tb(169,"div",60),r.Tb(170,"div",24),r.Tb(171,"select",72),r.dc("change",function(){return e.selectFieldTypeProperties("output")}),r.Ob(172,"option",66),r.Ec(173,Nt,2,2,"option",37),r.Sb(),r.Tb(174,"div",26),r.Tb(175,"button",38),r.dc("click",function(){r.yc(t);const i=r.xc(181);return e.displayToggle(i)}),r.gc(176,"translate"),r.Ob(177,"i",67),r.Sb(),r.Sb(),r.Sb(),r.Tb(178,"div",22),r.Gc(179),r.Sb(),r.Sb(),r.Sb(),r.Tb(180,"div",68,73),r.Tb(182,"div",70),r.Gc(183),r.gc(184,"translate"),r.Sb(),r.Ec(185,kt,6,8,"div",71),r.Tb(186,"div",47),r.Tb(187,"button",48),r.dc("click",function(){return r.yc(t),r.xc(181).style.display="none"}),r.Gc(188),r.gc(189,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(190,"div",63),r.Tb(191,"div",58),r.Tb(192,"label",74),r.Gc(193),r.gc(194,"translate"),r.Sb(),r.Sb(),r.Tb(195,"div",60),r.Tb(196,"div",75),r.Tb(197,"div",76),r.Tb(198,"select",77),r.Ob(199,"option",66),r.Ec(200,Mt,2,2,"option",37),r.Sb(),r.Tb(201,"div",26),r.Tb(202,"button",38),r.dc("click",function(){r.yc(t);const i=r.xc(211),o=r.xc(213);return e.displayToggle(i),o.value="",o.focus()}),r.gc(203,"translate"),r.Ob(204,"i",39),r.Sb(),r.Sb(),r.Tb(205,"div",26),r.Tb(206,"button",38),r.dc("click",function(){return e.deleteGroup()}),r.gc(207,"translate"),r.Ob(208,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Ec(209,Lt,2,1,"div",78),r.Tb(210,"div",42,79),r.Ob(212,"input",80,81),r.Ec(214,At,2,1,"div",46),r.Tb(215,"div",47),r.Tb(216,"button",48),r.dc("click",function(t){return e.addGroup(t)}),r.Gc(217),r.gc(218,"translate"),r.Sb(),r.Gc(219," \xa0 "),r.Tb(220,"button",48),r.dc("click",function(){return r.yc(t),r.xc(211).style.display="none",e.secondFormErrors.fld_newGroup=""}),r.Gc(221),r.gc(222,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(223,"div",82),r.Tb(224,"div",83),r.Tb(225,"div",84),r.Ob(226,"input",85),r.Tb(227,"label",51),r.Gc(228),r.gc(229,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(230,"div",82),r.Tb(231,"div",83),r.Tb(232,"div",84),r.Ob(233,"input",86),r.Tb(234,"label",51),r.Gc(235),r.gc(236,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(237,"div",82),r.Tb(238,"div",83),r.Tb(239,"div",84),r.Ob(240,"input",87),r.Tb(241,"label",51),r.Gc(242),r.gc(243,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(244,"div",82),r.Tb(245,"div",83),r.Tb(246,"div",84),r.Ob(247,"input",88),r.Tb(248,"label",51),r.Gc(249),r.gc(250,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(251,"div",82),r.Tb(252,"div",83),r.Tb(253,"div",84),r.Ob(254,"input",89),r.Tb(255,"label",51),r.Gc(256),r.gc(257,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(258,"div",90),r.Tb(259,"button",91),r.dc("click",function(){return e.errorFieldMessage=""}),r.Tb(260,"span",92),r.Gc(261,"\xd7"),r.Sb(),r.Sb(),r.Gc(262),r.Sb(),r.Tb(263,"div",93),r.Tb(264,"button",94),r.dc("click",function(t){return e.submitField(t)}),r.Ob(265,"i",39),r.Gc(266),r.gc(267,"translate"),r.Sb(),r.Tb(268,"button",95),r.dc("click",function(t){return e.submitField(t)}),r.Ob(269,"i",96),r.Gc(270),r.gc(271,"translate"),r.Sb(),r.Gc(272," \xa0 "),r.Tb(273,"button",97),r.dc("click",function(t){return e.editFieldCancel(t)}),r.Gc(274),r.gc(275,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(276,"ngb-accordion",98,99),r.Tb(278,"ngb-panel",100),r.gc(279,"translate"),r.Ec(280,Dt,48,37,"ng-template",101),r.Sb(),r.Sb(),r.Ec(281,Rt,5,1,"div",102),r.Sb(),r.Tb(282,"div",103),r.Tb(283,"div",104),r.Tb(284,"button",105),r.dc("click",function(t){return e.save(!0,t)}),r.Tb(285,"span"),r.Gc(286),r.gc(287,"translate"),r.Sb(),r.Sb(),r.Tb(288,"div",106),r.Ob(289,"button",107),r.Tb(290,"div",108),r.Tb(291,"button",109),r.dc("click",function(t){return e.save(!1,t)}),r.Gc(292),r.gc(293,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(294,"button",110),r.dc("click",function(t){return e.closeModal(t)}),r.Tb(295,"span"),r.Gc(296),r.gc(297,"translate"),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=r.xc(24);r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(6,128,"CLOSE")),r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(11,130,"MINIMIZE")),r.Bb(5),r.mc("title",r.hc(16,132,"EXPAND")),r.Bb(3),r.mc("title",r.hc(19,134,"CLOSE")),r.Bb(4),r.Hc(e.modalTitle),r.Bb(5),r.mc("formGroup",e.form),r.Bb(1),r.mc("formGroup",e.form)("ngClass",r.rc(220,_t,e.submitted)),r.Bb(4),r.Ic(" ",r.hc(33,136,"TITLE")," "),r.Bb(2),r.mc("ngClass",r.rc(222,xt,e.form.controls.title.touched&&!e.form.controls.title.valid)),r.Bb(2),r.Ic(" ",e.formErrors.title," "),r.Bb(3),r.Ic(" ",r.hc(40,138,"SYSTEM_NAME")," "),r.Bb(2),r.mc("ngClass",r.rc(224,xt,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(1),r.mc("ngClass",r.rc(226,xt,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(45,140,"GENERATE")),r.Bb(4),r.Ic(" ",e.formErrors.name," "),r.Bb(3),r.Ic(" ",r.hc(52,142,"DESCRIPTION")," "),r.Bb(7),r.Hc(r.hc(59,144,"COLLECTION")),r.Bb(2),r.mc("ngClass",r.rc(228,xt,e.form.controls.collection.touched&&!e.form.controls.collection.valid)),r.Bb(1),r.mc("ngModel",e.model.collection)("ngClass",r.rc(230,xt,e.form.controls.collection.touched&&!e.form.controls.collection.valid)),r.Bb(1),r.mc("ngForOf",e.collections),r.Bb(2),r.nc("ngbTooltip",r.hc(65,146,"ADD_COLLECTION")),r.Bb(3),r.mc("ngbPopover",t),r.Bb(2),r.nc("ngbTooltip",r.hc(70,148,"DELETE")),r.Bb(5),r.mc("ngClass",r.rc(232,xt,e.form.controls.newCollection.touched&&!e.form.controls.newCollection.valid)),r.Bb(2),r.mc("ngIf",e.formErrors.newCollection),r.Bb(3),r.Ic(" ",r.hc(80,150,"ADD")," "),r.Bb(4),r.Ic(" ",r.hc(84,152,"CANCEL")," "),r.Bb(4),r.oc("id","fieldIsCreateByUsersAllowed",e.uniqueId,""),r.Bb(1),r.oc("for","fieldIsCreateByUsersAllowed",e.uniqueId,""),r.Bb(1),r.Ic(" ",r.hc(90,154,"CREATE_BY_USERS_ALLOWED")," "),r.Bb(5),r.oc("id","fieldIsActive",e.uniqueId,""),r.Bb(1),r.oc("for","fieldIsActive",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(97,156,"ACTIVE")),r.Bb(2),r.mc("formGroup",e.secondForm),r.Bb(1),r.mc("hidden","add_field"!=e.action),r.Bb(1),r.Ic(" ",r.hc(101,158,"ADD_FIELD")," "),r.Bb(2),r.mc("hidden","edit_field"!=e.action),r.Bb(1),r.Ic(" ",r.hc(104,160,"EDIT_FIELD")," "),r.Bb(6),r.oc("for","field_fieldTitle",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(111,162,"TITLE")),r.Bb(3),r.oc("id","field_fieldTitle",e.uniqueId,""),r.mc("ngClass",r.rc(234,xt,e.secondForm.controls.title.touched&&!e.secondForm.controls.title.valid)),r.Bb(2),r.Hc(e.secondFormErrors.title),r.Bb(3),r.oc("for","field_fieldName",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(120,164,"SYSTEM_NAME")),r.Bb(3),r.mc("ngClass",r.rc(236,xt,e.secondForm.controls.name.touched&&!e.secondForm.controls.name.valid)),r.Bb(1),r.oc("id","field_fieldName",e.uniqueId,""),r.mc("ngClass",r.rc(238,xt,e.secondForm.controls.name.touched&&!e.secondForm.controls.name.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(126,166,"GENERATE")),r.Bb(4),r.Hc(e.secondFormErrors.name),r.Bb(3),r.oc("for","field_fieldDescription",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(134,168,"DESCRIPTION")),r.Bb(3),r.oc("id","field_fieldDescription",e.uniqueId,""),r.mc("ngClass",r.rc(240,xt,e.secondForm.controls.description.touched&&!e.secondForm.controls.description.valid)),r.Bb(3),r.oc("for","field_fieldInputType",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(141,170,"INPUT_TYPE")),r.Bb(3),r.mc("ngClass",r.rc(242,xt,e.secondForm.controls.inputType.touched&&!e.secondForm.controls.inputType.valid)),r.Bb(1),r.Fb("is-invalid",e.secondFormErrors.fld_inputType),r.oc("id","field_fieldInputType",e.uniqueId,""),r.mc("ngbTooltip",e.getFieldTypeProperty(e.fieldModel.inputType,"description")),r.Bb(2),r.mc("ngForOf",e.fieldTypes),r.Bb(2),r.nc("ngbTooltip",r.hc(149,172,"OPTIONS")),r.Bb(4),r.Hc(e.secondFormErrors.inputType),r.Bb(1),r.mc("hidden",!e.fieldModel.inputType),r.Bb(3),r.mc("hidden",e.fieldTypeProperties.input.length>0),r.Bb(1),r.Ic(" ",r.hc(158,174,"THERE_NO_PARAMETERS")," "),r.Bb(2),r.mc("ngForOf",e.fieldTypeProperties.input),r.Bb(3),r.Ic(" ",r.hc(163,176,"CLOSE")," "),r.Bb(4),r.oc("for","field_fieldOutputType",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(168,178,"OUTPUT_TYPE")),r.Bb(3),r.mc("ngClass",r.rc(244,xt,e.secondForm.controls.outputType.touched&&!e.secondForm.controls.outputType.valid)),r.Bb(1),r.oc("id","field_fieldOutputType",e.uniqueId,""),r.mc("ngbTooltip",e.getFieldTypeProperty(e.fieldModel.outputType,"description"))("ngClass",r.rc(246,xt,e.secondForm.controls.outputType.touched&&!e.secondForm.controls.outputType.valid)),r.Bb(2),r.mc("ngForOf",e.fieldTypes),r.Bb(2),r.nc("ngbTooltip",r.hc(176,180,"OPTIONS")),r.Bb(4),r.Hc(e.secondFormErrors.outputType),r.Bb(1),r.mc("hidden",!e.fieldModel.outputType),r.Bb(2),r.mc("hidden",e.fieldTypeProperties.output.length>0),r.Bb(1),r.Ic(" ",r.hc(184,182,"THERE_NO_PARAMETERS")," "),r.Bb(2),r.mc("ngForOf",e.fieldTypeProperties.output),r.Bb(3),r.Ic(" ",r.hc(189,184,"CLOSE")," "),r.Bb(5),r.Hc(r.hc(194,186,"GROUP")),r.Bb(4),r.mc("ngClass",r.rc(248,xt,e.secondForm.controls.group.touched&&!e.secondForm.controls.group.valid)),r.Bb(1),r.mc("ngClass",r.rc(250,xt,e.secondForm.controls.group.touched&&!e.secondForm.controls.group.valid)),r.Bb(2),r.mc("ngForOf",e.model.groups),r.Bb(2),r.nc("ngbTooltip",r.hc(203,188,"ADD_GROUP")),r.Bb(4),r.nc("ngbTooltip",r.hc(207,190,"DELETE_GROUP")),r.Bb(3),r.mc("ngIf",e.secondFormErrors.group),r.Bb(3),r.mc("ngClass",r.rc(252,xt,e.secondForm.controls.newGroup.touched&&!e.secondForm.controls.newGroup.valid)),r.Bb(2),r.mc("ngIf",e.secondFormErrors.newGroup),r.Bb(3),r.Ic(" ",r.hc(218,192,"ADD")," "),r.Bb(4),r.Ic(" ",r.hc(222,194,"CANCEL")," "),r.Bb(5),r.oc("id","fieldRequired",e.uniqueId,""),r.Bb(1),r.oc("for","fieldRequired",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(229,196,"REQUIRED")),r.Bb(5),r.oc("id","fieldShowInTable",e.uniqueId,""),r.Bb(1),r.oc("for","fieldShowInTable",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(236,198,"SHOW_IN_TABLE")),r.Bb(5),r.oc("id","fieldShowOnPage",e.uniqueId,""),r.Bb(1),r.oc("for","fieldShowOnPage",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(243,200,"SHOW_ON_PAGE")),r.Bb(5),r.oc("id","fieldShowInList",e.uniqueId,""),r.Bb(1),r.oc("for","fieldShowInList",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(250,202,"SHOW_IN_LIST")),r.Bb(5),r.oc("id","fieldIsFilter",e.uniqueId,""),r.Bb(1),r.oc("for","fieldIsFilter",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(257,204,"SHOW_IN_FILTER")),r.Bb(2),r.mc("hidden",!e.errorFieldMessage),r.Bb(4),r.Ic(" ",e.errorFieldMessage," "),r.Bb(2),r.mc("hidden","add_field"!=e.action),r.Bb(2),r.Ic(" ",r.hc(267,206,"ADD_FIELD")," "),r.Bb(2),r.mc("hidden","edit_field"!=e.action),r.Bb(2),r.Ic(" ",r.hc(271,208,"SAVE_FIELD")," "),r.Bb(4),r.Ic(" ",r.hc(275,210,"CANCEL")," "),r.Bb(2),r.mc("closeOthers",!0),r.Bb(2),r.mc("title",r.hc(279,212,"FIELDS")),r.Bb(3),r.mc("ngIf",e.errorMessage),r.Bb(3),r.mc("disabled",e.submitted),r.Bb(2),r.Hc(r.hc(287,214,"SAVE_AND_CLOSE")),r.Bb(3),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(293,216,"SAVE")),r.Bb(4),r.Hc(r.hc(297,218,"CLOSE"))}},directives:[h.o,h.h,h.w,o.n,h.b,h.n,h.g,O.v,h.u,o.o,O.r,o.p,h.a,h.q,h.x,O.a,O.p,O.q,O.d,O.g,O.f,O.e,h.p,gt.a,ft.a],pipes:[c.c],encapsulation:2}),t})(),Ht=(()=>{class t extends m.a{constructor(t,e,i,o){super(t,e,i,o),this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=o,this.title="\u0422\u0438\u043f\u044b \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430",this.queryOptions=new D.a("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"collection",sortName:"collection",title:"COLLECTION",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}getModalContent(){return qt}getModalElementId(t){return["modal","content_type",t||0].join("-")}setModalInputs(t,e=!1,i=""){super.setModalInputs(t,e,i),this.modalRef.componentInstance.modalTitle=t&&!e?`${this.getLangString("CONTENT_TYPE")} #${t}`:this.getLangString("ADD_CONTENT_TYPE")}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(S.a),r.Nb(O.b),r.Nb(O.h),r.Nb(c.d))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-shk-content-types"]],features:[r.yb],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"a",2),r.Ob(3,"i",3),r.Gc(4," \xa0 "),r.Tb(5,"span"),r.Gc(6),r.gc(7,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(8,"div",4),r.Tb(9,"div",5),r.Tb(10,"button",6),r.Tb(11,"span"),r.Gc(12),r.gc(13,"translate"),r.Sb(),r.Sb(),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(){return e.blockSelected()}),r.Gc(16),r.gc(17,"translate"),r.Sb(),r.Tb(18,"button",8),r.dc("click",function(){return e.deleteSelected()}),r.Gc(19),r.gc(20,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"button",9),r.dc("click",function(){return e.modalOpen()}),r.Ob(22,"i",10),r.Gc(23," \xa0 "),r.Tb(24,"span"),r.Gc(25),r.gc(26,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Ob(27,"div",11),r.Sb(),r.Tb(28,"app-table",12,13),r.dc("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)}),r.Sb()),2&t&&(r.Bb(2),r.mc("routerLink",r.qc(23,Pt)),r.Bb(4),r.Hc(r.hc(7,13,"CATALOG")),r.Bb(6),r.Hc(r.hc(13,15,"BATCH_ACTIONS")),r.Bb(4),r.Hc(r.hc(17,17,"DISABLE_ENABLE")),r.Bb(3),r.Hc(r.hc(20,19,"DELETE")),r.Bb(6),r.Hc(r.hc(26,21,"ADD")),r.Bb(3),r.mc("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("isCloneAllowed",!0)("loading",e.loading))},directives:[s.e,O.d,O.g,O.f,at.a],pipes:[c.c],encapsulation:2}),t})();class Ut{constructor(t,e,i,o,n,s,r){this.id=t,this.name=e,this.title=i,this.description=o,this.isActive=n,this.inputProperties=s,this.outputProperties=r}}function jt(t,e){if(1&t&&(r.Tb(0,"div",51),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.title," ")}}function $t(t,e){if(1&t&&(r.Tb(0,"div",51),r.Gc(1),r.Sb()),2&t){const t=r.fc();r.Bb(1),r.Ic(" ",t.formErrors.name," ")}}const Vt=function(t){return{"is-invalid":t}};function zt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"tr",60),r.Tb(1,"td"),r.Ob(2,"input",61),r.Sb(),r.Tb(3,"td",62),r.Ob(4,"input",63),r.Sb(),r.Tb(5,"td",62),r.Ob(6,"input",64),r.Sb(),r.Tb(7,"td",62),r.Tb(8,"button",65),r.dc("click",function(i){r.yc(t);const o=e.index;return r.fc(3).arrayFieldDelete("inputProperties",o,i)}),r.gc(9,"translate"),r.Ob(10,"i",11),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=e.$implicit;r.mc("formGroupName",e.index+""),r.Bb(2),r.mc("ngClass",r.rc(7,Vt,t.controls.name.touched&&!t.controls.name.valid)),r.Bb(2),r.mc("ngClass",r.rc(9,Vt,t.controls.title.touched&&!t.controls.title.valid)),r.Bb(2),r.mc("ngClass",r.rc(11,Vt,t.controls.default_value.touched&&!t.controls.default_value.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(9,5,"DELETE"))}}function Yt(t,e){if(1&t&&(r.Tb(0,"tbody"),r.Ec(1,zt,11,13,"tr",59),r.Sb()),2&t){const t=r.fc(2);r.Bb(1),r.mc("ngForOf",t.arrayFields.inputProperties.controls)}}function Wt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",52),r.Tb(1,"table",53),r.Tb(2,"thead"),r.Tb(3,"tr"),r.Tb(4,"th"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Tb(7,"th"),r.Gc(8),r.gc(9,"translate"),r.Sb(),r.Tb(10,"th"),r.Gc(11),r.gc(12,"translate"),r.Sb(),r.Ob(13,"th"),r.Sb(),r.Sb(),r.Ec(14,Yt,2,1,"tbody",54),r.Tb(15,"tfoot"),r.Tb(16,"tr",55),r.Tb(17,"td",56),r.Tb(18,"button",57),r.dc("click",function(e){return r.yc(t),r.fc().arrayFieldAdd("inputProperties",e)}),r.Ob(19,"i",58),r.Gc(20," \xa0 "),r.Tb(21,"span"),r.Gc(22),r.gc(23,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=r.fc();r.Bb(5),r.Ic(" ",r.hc(6,5,"SYSTEM_NAME")," "),r.Bb(3),r.Ic(" ",r.hc(9,7,"TITLE")," "),r.Bb(3),r.Ic(" ",r.hc(12,9,"DEFAULT_VALUE")," "),r.Bb(3),r.mc("ngIf",t.arrayFields.inputProperties),r.Bb(8),r.Hc(r.hc(23,11,"ADD"))}}function Xt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"tr",60),r.Tb(1,"td"),r.Ob(2,"input",61),r.Sb(),r.Tb(3,"td",62),r.Ob(4,"input",63),r.Sb(),r.Tb(5,"td",62),r.Ob(6,"input",64),r.Sb(),r.Tb(7,"td",62),r.Tb(8,"button",65),r.dc("click",function(i){r.yc(t);const o=e.index;return r.fc(3).arrayFieldDelete("outputProperties",o,i)}),r.gc(9,"translate"),r.Ob(10,"i",11),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=e.$implicit;r.mc("formGroupName",e.index+""),r.Bb(2),r.mc("ngClass",r.rc(7,Vt,t.controls.name.touched&&!t.controls.name.valid)),r.Bb(2),r.mc("ngClass",r.rc(9,Vt,t.controls.title.touched&&!t.controls.title.valid)),r.Bb(2),r.mc("ngClass",r.rc(11,Vt,t.controls.default_value.touched&&!t.controls.default_value.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(9,5,"DELETE"))}}function Jt(t,e){if(1&t&&(r.Tb(0,"tbody"),r.Ec(1,Xt,11,13,"tr",59),r.Sb()),2&t){const t=r.fc(2);r.Bb(1),r.mc("ngForOf",t.arrayFields.outputProperties.controls)}}function Qt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",66),r.Tb(1,"table",53),r.Tb(2,"thead"),r.Tb(3,"tr"),r.Tb(4,"th"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Tb(7,"th"),r.Gc(8),r.gc(9,"translate"),r.Sb(),r.Tb(10,"th"),r.Gc(11),r.gc(12,"translate"),r.Sb(),r.Ob(13,"th"),r.Sb(),r.Sb(),r.Ec(14,Jt,2,1,"tbody",54),r.Tb(15,"tfoot"),r.Tb(16,"tr",55),r.Tb(17,"td",56),r.Tb(18,"button",57),r.dc("click",function(e){return r.yc(t),r.fc().arrayFieldAdd("outputProperties",e)}),r.Ob(19,"i",58),r.Gc(20," \xa0 "),r.Tb(21,"span"),r.Gc(22),r.gc(23,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb()}if(2&t){const t=r.fc();r.Bb(5),r.Ic(" ",r.hc(6,5,"SYSTEM_NAME")," "),r.Bb(3),r.Ic(" ",r.hc(9,7,"TITLE")," "),r.Bb(3),r.Ic(" ",r.hc(12,9,"DEFAULT_VALUE")," "),r.Bb(3),r.mc("ngIf",t.arrayFields.outputProperties),r.Bb(8),r.Hc(r.hc(23,11,"ADD"))}}function Kt(t,e){if(1&t){const t=r.Ub();r.Tb(0,"div",67),r.Tb(1,"button",68),r.dc("click",function(){return r.yc(t),r.fc().errorMessage=""}),r.Tb(2,"span",69),r.Gc(3,"\xd7"),r.Sb(),r.Sb(),r.Gc(4),r.Sb()}if(2&t){const t=r.fc();r.Bb(4),r.Ic(" ",t.errorMessage," ")}}const Zt=function(t){return{"no-events":t}},te=function(){return["/catalog"]};let ee=(()=>{class t extends x.a{constructor(t,e,i,o,n,s){super(t,e,i,o,n,s),this.fb=t,this.activeModal=e,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.model=new Ut(0,"","","",!0,[],[]),this.formFields=[{name:"title",validators:[h.v.required]},{name:"name",validators:[h.v.required,h.v.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"isActive",validators:[]},{name:"inputProperties",validators:[],children:[{name:"name",validators:[h.v.required]},{name:"title",validators:[h.v.required]},{name:"default_value",validators:[]}]},{name:"outputProperties",validators:[],children:[{name:"name",validators:[h.v.required]},{name:"title",validators:[h.v.required]},{name:"default_value",validators:[]}]}]}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(h.e),r.Nb(O.b),r.Nb(c.d),r.Nb(f.a),r.Nb(pt),r.Nb(r.l))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-field-type-modal-content"]],features:[r.yb],decls:84,vars:68,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","mr-1"],[1,"icon-minimize","mr-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ml-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","mr-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-md-6"],[1,"form-group","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","formControlName","title","id","fieldTitle",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"form-group","row"],[1,"col-12"],[1,"card","card-body","p-2","pl-3"],[1,"custom-control","custom-checkbox","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"],[1,"form-group"],["for","fieldDescription",1,"label-filled"],["rows","5","name","description","formControlName","description","id","fieldDescription",1,"form-control"],["activeIds","accordion-input-options",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-input-options",3,"title"],["ngbPanelContent",""],["id","accordion-output-options",3,"title"],["class","alert alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],[1,"btn-group","mr-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],["formArrayName","inputProperties"],[1,"table","table-bordered","table-divided","mb-0"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],[1,"text-center"],["type","text","formControlName","title",1,"form-control",3,"ngClass"],["type","text","formControlName","default_value",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["formArrayName","outputProperties"],[1,"alert","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"button",2),r.dc("click",function(t){return e.closeModal(t)}),r.Ob(3,"i",3),r.Tb(4,"span"),r.Gc(5),r.gc(6,"translate"),r.Sb(),r.Sb(),r.Tb(7,"button",2),r.dc("click",function(t){return e.minimize(t)}),r.Ob(8,"i",4),r.Tb(9,"span"),r.Gc(10),r.gc(11,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(12,"div",5),r.Tb(13,"div",6),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(t){return e.maximize(t)}),r.gc(16,"translate"),r.Ob(17,"i",9),r.Sb(),r.Tb(18,"button",10),r.dc("click",function(t){return e.closeModal(t)}),r.gc(19,"translate"),r.Ob(20,"i",11),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"h4",12),r.Gc(22),r.Sb(),r.Sb(),r.Tb(23,"form",13,14),r.dc("ngSubmit",function(){return e.onSubmit()}),r.Tb(25,"div",15),r.Tb(26,"div",16),r.Tb(27,"div",17),r.Tb(28,"div",18),r.Tb(29,"label",19),r.Gc(30),r.gc(31,"translate"),r.Sb(),r.Ob(32,"input",20),r.Ec(33,jt,2,1,"div",21),r.Sb(),r.Tb(34,"div",18),r.Tb(35,"label",22),r.Gc(36),r.gc(37,"translate"),r.Sb(),r.Tb(38,"div",23),r.Ob(39,"input",24),r.Tb(40,"div",25),r.Tb(41,"button",26),r.dc("click",function(){return e.generateName(e.model)}),r.gc(42,"translate"),r.Ob(43,"i",27),r.Sb(),r.Sb(),r.Sb(),r.Ec(44,$t,2,1,"div",21),r.Sb(),r.Tb(45,"div",28),r.Tb(46,"div",29),r.Tb(47,"div",30),r.Tb(48,"div",31),r.Ob(49,"input",32),r.Tb(50,"label",33),r.Gc(51),r.gc(52,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(53,"div",17),r.Tb(54,"div",34),r.Tb(55,"label",35),r.Gc(56),r.gc(57,"translate"),r.Sb(),r.Ob(58,"textarea",36),r.Sb(),r.Sb(),r.Sb(),r.Tb(59,"ngb-accordion",37,38),r.Tb(61,"ngb-panel",39),r.gc(62,"translate"),r.Ec(63,Wt,24,13,"ng-template",40),r.Sb(),r.Tb(64,"ngb-panel",41),r.gc(65,"translate"),r.Ec(66,Qt,24,13,"ng-template",40),r.Sb(),r.Sb(),r.Ec(67,Kt,5,1,"div",42),r.Sb(),r.Tb(68,"div",43),r.Tb(69,"div",44),r.Tb(70,"button",45),r.dc("click",function(t){return e.save(!0,t)}),r.Tb(71,"span"),r.Gc(72),r.gc(73,"translate"),r.Sb(),r.Sb(),r.Tb(74,"div",46),r.Ob(75,"button",47),r.Tb(76,"div",48),r.Tb(77,"button",49),r.dc("click",function(t){return e.save(!1,t)}),r.Gc(78),r.gc(79,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(80,"button",50),r.dc("click",function(t){return e.closeModal(t)}),r.Tb(81,"span"),r.Gc(82),r.gc(83,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Sb()),2&t&&(r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(6,32,"CLOSE")),r.Bb(2),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(11,34,"MINIMIZE")),r.Bb(5),r.mc("title",r.hc(16,36,"EXPAND")),r.Bb(3),r.mc("title",r.hc(19,38,"CLOSE")),r.Bb(4),r.Hc(e.modalTitle),r.Bb(1),r.mc("formGroup",e.form)("ngClass",r.rc(60,Zt,e.submitted)),r.Bb(2),r.Fb("loading",e.loading),r.Bb(5),r.Hc(r.hc(31,40,"TITLE")),r.Bb(2),r.mc("ngClass",r.rc(62,Vt,e.form.controls.title.touched&&!e.form.controls.title.valid)),r.Bb(1),r.mc("ngIf",e.formErrors.title),r.Bb(3),r.Hc(r.hc(37,42,"SYSTEM_NAME")),r.Bb(2),r.mc("ngClass",r.rc(64,Vt,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(1),r.mc("ngClass",r.rc(66,Vt,e.form.controls.name.touched&&!e.form.controls.name.valid)),r.Bb(2),r.nc("ngbTooltip",r.hc(42,44,"GENERATE")),r.Bb(3),r.mc("ngIf",e.formErrors.name),r.Bb(5),r.oc("id","fieldIsActive",e.uniqueId,""),r.Bb(1),r.oc("for","fieldIsActive",e.uniqueId,""),r.Bb(1),r.Hc(r.hc(52,46,"ACTIVE")),r.Bb(5),r.Hc(r.hc(57,48,"DESCRIPTION")),r.Bb(3),r.mc("closeOthers",!1),r.Bb(2),r.mc("title",r.hc(62,50,"INPUT_OPTIONS")),r.Bb(3),r.mc("title",r.hc(65,52,"OUTPUT_OPTIONS")),r.Bb(3),r.mc("ngIf",e.errorMessage),r.Bb(3),r.mc("disabled",e.submitted),r.Bb(2),r.Hc(r.hc(73,54,"SAVE_AND_CLOSE")),r.Bb(3),r.mc("disabled",e.submitted),r.Bb(3),r.Hc(r.hc(79,56,"SAVE")),r.Bb(4),r.Hc(r.hc(83,58,"CLOSE")))},directives:[h.w,h.o,h.h,o.n,h.b,h.n,h.g,o.p,O.v,h.a,O.a,O.p,O.q,O.d,O.g,O.f,O.e,h.d,o.o,h.i],pipes:[c.c],encapsulation:2}),t})();const ie=[{path:"",component:d,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:bt},{path:"content_types",component:Ht},{path:"field_types",component:(()=>{class t extends m.a{constructor(t,e,i,o){super(t,e,i,o),this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=o,this.title="Field types",this.queryOptions=new D.a("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}setModalInputs(t,e=!1,i=""){super.setModalInputs(t,e,i),this.modalRef.componentInstance.modalTitle=t&&!e?`${this.getLangString("FIELD_TYPE")} #${t}`:this.getLangString("ADD_FIELD_TYPE")}getModalElementId(t){return["modal","field_type",t||0].join("-")}getModalContent(){return ee}}return t.\u0275fac=function(e){return new(e||t)(r.Nb(pt),r.Nb(O.b),r.Nb(O.h),r.Nb(c.d))},t.\u0275cmp=r.Hb({type:t,selectors:[["app-shk-field-types"]],features:[r.yb],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-left"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-right"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ml-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(t,e){1&t&&(r.Tb(0,"div",0),r.Tb(1,"div",1),r.Tb(2,"a",2),r.Ob(3,"i",3),r.Gc(4," \xa0 "),r.Tb(5,"span"),r.Gc(6),r.gc(7,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(8,"div",4),r.Tb(9,"div",5),r.Tb(10,"button",6),r.Tb(11,"span"),r.Gc(12),r.gc(13,"translate"),r.Sb(),r.Sb(),r.Tb(14,"div",7),r.Tb(15,"button",8),r.dc("click",function(){return e.blockSelected()}),r.Gc(16),r.gc(17,"translate"),r.Sb(),r.Tb(18,"button",8),r.dc("click",function(){return e.deleteSelected()}),r.Gc(19),r.gc(20,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Tb(21,"button",9),r.dc("click",function(){return e.modalOpen()}),r.Ob(22,"i",10),r.Gc(23," \xa0 "),r.Tb(24,"span"),r.Gc(25),r.gc(26,"translate"),r.Sb(),r.Sb(),r.Sb(),r.Ob(27,"div",11),r.Sb(),r.Tb(28,"app-table",12,13),r.dc("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)}),r.Sb()),2&t&&(r.Bb(2),r.mc("routerLink",r.qc(23,te)),r.Bb(4),r.Hc(r.hc(7,13,"CATALOG")),r.Bb(6),r.Hc(r.hc(13,15,"BATCH_ACTIONS")),r.Bb(4),r.Hc(r.hc(17,17,"DISABLE_ENABLE")),r.Bb(3),r.Hc(r.hc(20,19,"DELETE")),r.Bb(6),r.Hc(r.hc(26,21,"ADD")),r.Bb(3),r.mc("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("isCloneAllowed",!0)("loading",e.loading))},directives:[s.e,O.d,O.g,O.f,at.a],pipes:[c.c],encapsulation:2}),t})()}]}];let oe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.Lb({type:t}),t.\u0275inj=r.Kb({imports:[[s.f.forChild(ie)],s.f]}),t})(),ne=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.Lb({type:t}),t.\u0275inj=r.Kb({providers:[I,pt,ht,C],imports:[[o.c,n.a,oe]]}),t})()},BWxc:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var o=i("JIr8"),n=i("7AsP"),s=i("8Y7J"),r=i("IheW");let c=(()=>{class t extends n.a{constructor(t){super(t),this.setRequestUrl("/admin/content_types")}getItemByName(t){const e=this.getRequestUrl()+`/by_name/${t}`;return this.http.get(e).pipe(Object(o.a)(this.handleError()))}getItemByCategory(t){const e=this.getRequestUrl()+`/by_category/${t}`;return this.http.get(e).pipe(Object(o.a)(this.handleError()))}}return t.\u0275fac=function(e){return new(e||t)(s.ac(r.a))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},bbPC:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var o=i("s7LF"),n=i("XNiG"),s=i("1G5W"),r=i("qbpQ"),c=i("7AsP"),l=i("pvw1"),a=i("8Y7J"),d=i("G0yt"),b=i("TSSN");let u=(()=>{class t{constructor(t,e,i,o,s,r,c){this.fb=t,this.dataService=e,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=s,this.translateService=r,this.elRef=c,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new n.a,s.placement="bottom",s.container="body",s.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang][t]||t}getModelData(){return this.loading=!0,new Promise((t,e)=>{this.dataService.getItem(this.itemId).pipe(Object(s.a)(this.destroyed$)).subscribe({next:e=>{this.isItemCopy&&(e.id=null,e[this.getSystemFieldName()]=""),this.model=e,this.loading=!1,t(e)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,e(t)}})})}buildForm(){const t=this.buildControls(this.formFields);this.form=this.fb.group(t),this.form.valueChanges.pipe(Object(s.a)(this.destroyed$)).subscribe({next:t=>this.onValueChanged("form","",t)})}buildControls(t,e="model",i=""){const n={};for(const s in t){if(!t.hasOwnProperty(s))continue;const r=t[s],c=r.dataKey?this[e][r.dataKey]:this[e];c[s]||(c[s]=r.value),n[s]=new o.f({value:c[s]||"",disabled:r.disabled||!1},r.validators),this.formErrors[i+s]="",this.translateValidationMessages(i,s,r)}return n}translateValidationMessages(t,e,i){const n={};i.fieldLabel&&(Object.keys(i.messages).forEach(t=>{"required"!==t&&this.translateService.get(String(i.messages[t])).subscribe(e=>{n[t]=e})}),i.validators.indexOf(o.v.required)>-1&&this.translateService.get(i.fieldLabel).subscribe(t=>{this.translateService.get("FIELD_REQUIRED",{name:t}).subscribe(t=>{n.required=t})}),this.validationMessages[t+e]=n)}getControl(t){return this.form.controls.name}onValueChanged(t,e="",i){if(!this[t])return;const o=this[t].value;for(const n in o){if(!o.hasOwnProperty(n))continue;this.formErrors[e+n]="";const i=this[t].get(n);if(i&&(i.dirty||this[e+"submitted"])&&!i.valid)for(const t in i.errors)this.formErrors[e+n]+=this.validationMessages[e+n][t]?this.validationMessages[e+n][t]+" ":this.getLangString("ERROR")+" "}}displayToggle(t,e){t.style.display=(e=e||"none"===t.style.display)?"block":"none"}toggleAccordion(t,e,i){t.activeIds.indexOf(e)>-1&&i||t.toggle(e)}generateName(t){t.name=this.systemNameService.generateName(t.title||"")}closeModal(t){t&&t.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(t){t&&t.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(t){t&&t.preventDefault(),window.document.body.classList.remove("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.remove("d-block"),e.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(t){t&&t.preventDefault(),window.document.body.classList.add("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.add("d-block"),e.classList.remove("modal-minimized"),i.classList.remove("d-none")}getFormData(){const t={};return Object.keys(this.model).forEach(e=>{t[e]=this.files[e]?Array.isArray(this.model[e])?[l.a.getFileData(this.files[e])]:l.a.getFileData(this.files[e]):this.model[e]}),t}fileChange(t,e,i=!1){const o=t.target.files;o.length>0&&(this.model[e]=i?[l.a.getFileData(o[0])]:l.a.getFileData(o[0]),this.files[e]=o[0],this.form.controls[e].setValue(this.files[e].name))}fileClear(t,e){this.model[t]=null,this.form.controls[t].reset(null),e.files=null,e.value="",delete this.files[t]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(t=>{this.model[t]=this.localePreviousValues[t]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(t=>{this.localePreviousValues[t]=this.model[t]||"",this.model[t]=this.model.translations[t]&&this.model.translations[t][this.localeCurrent]||""})}saveTranslations(t){t&&t.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.model[t]?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.model[t]):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(t){}saveFiles(t){if(0===Object.keys(this.files).length)return void this.closeModal();const e=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&e.append(i,this.files[i],this.files[i].name);e.append("itemId",String(t)),this.appendFormData(e),this.dataService.postFormData(e).pipe(Object(s.a)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(t=!1,e){if(e&&e.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe(Object(s.a)(this.destroyed$)).subscribe({next:e=>{Object.keys(this.files).length>0?this.saveFiles(e._id||e.id):(t?this.closeModal():e&&e.id&&(this.model=e,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(t){return t.value?/\S+@\S+\.\S+/.test(t.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(a.Nb(o.e),a.Nb(c.a),a.Nb(r.a),a.Nb(d.b),a.Nb(d.w),a.Nb(b.d),a.Nb(a.l))},t.\u0275cmp=a.Hb({type:t,selectors:[["ng-component"]],inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})()},ot8b:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var o=i("s7LF"),n=i("XNiG"),s=i("1G5W"),r=i("7AsP"),c=i("qbpQ"),l=i("8Y7J"),a=i("G0yt"),d=i("TSSN");const b=["formEl"];let u=(()=>{class t{constructor(t,e,i,o,s,r){this.fb=t,this.activeModal=e,this.translateService=i,this.systemNameService=o,this.dataService=s,this.elRef=r,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new n.a}set formErrors(t){for(const e in t)if(t.hasOwnProperty(e)){const t=this.getControl(this.form,null,e);t&&t.setErrors({incorrect:!0})}this._formFieldsErrors=t}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang][t]||t}getModelData(){return this.loading=!0,new Promise((t,e)=>{this.dataService.getItem(this.itemId).pipe(Object(s.a)(this.destroyed$)).subscribe({next:e=>{if(this.isItemCopy){e.id=null;const t=this.getSystemFieldName();t&&(e[t]="")}Object.assign(this.model,e),this.loading=!1,t(e)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,e(t)}})})}buildForm(t="form",e=null,i=null,o="model"){e||(e=this.formFields),this[t]=this.fb.group(this.buildControls(null,e,o)),this[t].valueChanges.pipe(Object(s.a)(this.destroyed$)).subscribe(()=>this.onValueChanged(t,i))}buildControls(t=null,e=[],i="model"){const o={};return e.forEach(e=>{const n=t?this.getControl(t,e):null;let s=null;if(i&&this[i]?(this[i].options||(this[i].options={}),s=0===e.name.indexOf("options_")?this[i].options[e.name.substr(8)]||null:this[i][e.name]||null):s=null,n)if(e.disabled&&n.disable(),e.children){const t=s,i=n;i.clear(),t.forEach((t,o)=>{const n=this.getFormFieldByName(e.name),s=this.buildControls(null,n.children,null);i.push(this.fb.group(s))}),i.patchValue(t)}else n.setValue(s);else e.children?(o[e.name]=this.fb.array([]),this.createArrayFieldsProperty(e.name)):o[e.name]=this.fb.control({value:s,disabled:e.disabled||!1},e.validators)}),o}onValueChanged(t="form",e=null){this[t]&&(e||(e=this.formErrors),this[t].valid&&(this.errorMessage=""),Object.keys(this[t].value).forEach(i=>{e[i]="";const o=this.getControl(this[t],null,i);if(o&&!o.valid&&o.errors){let t="";Object.keys(o.errors).forEach(e=>{t+=(t?" ":"")+this.getLangString("INVALID_"+e.toUpperCase())}),e[i]=t}}))}getFormFieldByName(t){const e=this.formFields.filter(e=>e.name===t);return e.length>0?e[0]:null}createArrayFieldsProperty(t){Object.defineProperty(this.arrayFields,t,{get:()=>this.form?this.form.get(t):null})}getControl(t,e,i){return t?t.get(i||e.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(t){Object.keys(t.controls).forEach(e=>{t.controls[e].markAsTouched(),t.controls[e]instanceof o.c&&Array.from(this.form.controls[e].controls).forEach(t=>{this.formGroupMarkTouched(t)})})}getSaveRequest(t){return t.id||"root"===t.name?this.dataService.update(t):this.dataService.create(t)}getFormData(){const t=this.form.value;return t.id=this.model.id||0,void 0!==this.model.translations&&(t.translations=this.model.translations||null),t}arrayFieldDelete(t,e,i){i&&i.preventDefault(),this.arrayFields[t].removeAt(e)}arrayFieldAdd(t,e){e&&e.preventDefault();const i=this.getFormFieldByName(t);if(!i)return;const o=this.buildControls(null,i.children,null);this.arrayFields[t].push(this.fb.group(o))}generateName(t,e,i=null){e&&e.preventDefault(),i||(i=this.form);const o=this.getControl(i,null,"title").value||"";t.name=this.systemNameService.generateName(o),this.getControl(i,null,"name").setValue(t.name)}closeModal(t){t&&t.preventDefault(),this.close(this.closeReason)}close(t,e){e&&e.preventDefault(),"submit"===t?this.activeModal.close(t):this.activeModal.dismiss(t)}minimize(t){t&&t.preventDefault(),window.document.body.classList.remove("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.remove("d-block"),e.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(t){t&&t.preventDefault(),window.document.body.classList.add("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.add("d-block"),e.classList.remove("modal-minimized"),i.classList.remove("d-none")}save(t=!1,e){e&&e.preventDefault(),this.onSubmit(t)}saveFiles(t){if(0===Object.keys(this.files).length)return void this.close("submit");const e=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&e.append(i,this.files[i],this.files[i].name);e.append("itemId",String(t)),this.dataService.postFormData(e).pipe(Object(s.a)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(t=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const e=this.getFormData();this.getSaveRequest(e).pipe(Object(s.a)(this.destroyed$)).subscribe({next:e=>{Object.keys(this.files).length>0?this.saveFiles(e._id||e.id):t&&this.close("submit"),e&&e.id&&(this.model.id=e.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:t=>{t.error&&(this.errorMessage=t.error),t.errors&&(this.formErrors=t.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(t=>{this.model[t]=this.localePreviousValues[t],this.getControl(this.form,null,t).setValue(this.localePreviousValues[t])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(t=>{this.localePreviousValues[t]=this.getControl(this.form,null,t).value,this.model.translations[t]?(this.model[t]=this.model.translations[t][this.localeCurrent]||"",this.getControl(this.form,null,t).setValue(this.model[t])):(this.model[t]="",this.getControl(this.form,null,t).setValue(""))})}saveTranslations(t){t&&t.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.getControl(this.form,null,t)&&this.getControl(this.form,null,t).value?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.getControl(this.form,null,t).value):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(t){return t.value?/\S+@\S+\.\S+/.test(t.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}displayToggle(t,e,i){i&&i.preventDefault(),t.style.display=(e=e||"none"===t.style.display)?"block":"none"}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(o.e),l.Nb(a.b),l.Nb(d.d),l.Nb(c.a),l.Nb(r.a),l.Nb(l.l))},t.\u0275cmp=l.Hb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&l.Kc(b,1),2&t){let t;l.wc(t=l.ec())&&(e.formEl=t.first)}},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})()}}]);